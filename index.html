<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/Blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/Blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/Blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/Blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/Blog/css/main.css">


<link rel="stylesheet" href="/Blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"gitee.com","root":"/Blog/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="èš‚èšçš„åšå®¢">
<meta property="og:url" content="https://gitee.com/iversoncurry/Blog.git/index.html">
<meta property="og:site_name" content="èš‚èšçš„åšå®¢">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="èš‚èš">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://gitee.com/iversoncurry/Blog.git/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>èš‚èšçš„åšå®¢</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/Blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">èš‚èšçš„åšå®¢</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/Blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/Blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">å‰ç«¯è·¯ç”±å®ç°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 15:55:55 / Modified: 18:00:39" itemprop="dateCreated datePublished" datetime="2020-04-26T15:55:55+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>è·¯ç”±çš„æ¦‚å¿µæ¥æºäºæœåŠ¡ç«¯ï¼Œåœ¨æœåŠ¡ç«¯ä¸­è·¯ç”±æè¿°çš„æ˜¯URLä¸å¤„ç†å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚<br>åœ¨Webå‰ç«¯å•é¡µåº”ç”¨ä¸­ï¼Œè·¯ç”±æè¿°çš„æ˜¯URLä¸UIä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œè¿™ç§æ˜ å°„æ˜¯å•å‘çš„ï¼Œå³URLå˜åŒ–å¼•èµ·UIæ›´æ–°ï¼ˆ<strong>æ— éœ€åˆ·æ–°é¡µé¢</strong>ï¼‰</p>
<h2 id="å®ç°å‰ç«¯è·¯ç”±çš„åŸºæœ¬åŸç†"><a href="#å®ç°å‰ç«¯è·¯ç”±çš„åŸºæœ¬åŸç†" class="headerlink" title="å®ç°å‰ç«¯è·¯ç”±çš„åŸºæœ¬åŸç†"></a>å®ç°å‰ç«¯è·¯ç”±çš„åŸºæœ¬åŸç†</h2><p>è¦å®ç°å‰ç«¯è·¯ç”±ï¼Œéœ€è¦è§£å†³ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜<br>1.æ”¹å˜URLä¸å¼•èµ·é¡µé¢åˆ·æ–°<br>2.æ£€æµ‹URLå˜åŒ–</p>
<p>åˆ©ç”¨hashæˆ–historyå¯ä»¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜</p>
<h3 id="hashå®ç°"><a href="#hashå®ç°" class="headerlink" title="hashå®ç°"></a>hashå®ç°</h3><p>1.hashæ˜¯URLä¸­hash (#)åŠåé¢çš„é‚£éƒ¨åˆ†ï¼Œå¸¸ç”¨ä½œé”šç‚¹åœ¨é¡µé¢å†…è¿›è¡Œå¯¼èˆªï¼Œæ”¹å˜URLä¸­çš„hashéƒ¨åˆ†ä¸ä¼šå¼•èµ·é¡µé¢åˆ·æ–°<br>2.é€šè¿‡hashchangeäº‹ä»¶ç›‘å¬URLçš„å˜åŒ–ã€‚<br>æµè§ˆå™¨å‰è¿›æˆ–åé€€æ”¹å˜URLã€é€šè¿‡æ ‡ç­¾æ”¹å˜URLã€é€šè¿‡window.locationæ”¹å˜URLï¼Œè¿™å‡ ç§æƒ…å†µéƒ½ä¼šè§¦å‘hashchangeäº‹ä»¶</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å®šä¹‰è·¯ç”± --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/home"</span>&gt;</span>home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/about"</span>&gt;</span>about<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ¸²æŸ“è·¯ç”±å¯¹åº”çš„ UI --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"routeView"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// é¡µé¢åŠ è½½å®Œä¸ä¼šè§¦å‘ hashchangeï¼Œè¿™é‡Œä¸»åŠ¨è§¦å‘ä¸€æ¬¡ hashchange äº‹ä»¶</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, onLoad)</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// ç›‘å¬è·¯ç”±å˜åŒ–</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.addEventListener(<span class="string">'hashchange'</span>, onHashChange)</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// è·¯ç”±è§†å›¾</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> routerView = <span class="literal">null</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">onLoad</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">    routerView = <span class="built_in">document</span>.querySelector(<span class="string">'#routeView'</span>)</span></span><br><span class="line">    onHashChange()</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="historyå®ç°"><a href="#historyå®ç°" class="headerlink" title="historyå®ç°"></a>historyå®ç°</h3><p>1.historyæä¾›äº†pushStateå’ŒreplaceStateä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æ”¹å˜URLçš„pathéƒ¨åˆ†ä¸ä¼šå¼•èµ·é¡µé¢åˆ·æ–°<br>2.historyæä¾›popstateäº‹ä»¶ã€‚ä½†é€šè¿‡é€šè¿‡pushState/replaceStateæˆ–æ ‡ç­¾æ”¹å˜ URL ä¸ä¼šè§¦å‘ popstate äº‹ä»¶ã€‚ä½†å¯ä»¥æ‹¦æˆªpushState/replaceStateçš„è°ƒç”¨å’Œæ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶æ¥æ£€æµ‹ URL å˜åŒ–ï¼Œæ‰€ä»¥ç›‘å¬ URL å˜åŒ–å¯ä»¥å®ç°ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">'/home'</span>&gt;</span>home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">'/about'</span>&gt;</span>about<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"routeView"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// é¡µé¢åŠ è½½å®Œä¸ä¼šè§¦å‘ hashchangeï¼Œè¿™é‡Œä¸»åŠ¨è§¦å‘ä¸€æ¬¡ hashchange äº‹ä»¶</span></span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, onLoad)</span></span><br><span class="line"><span class="actionscript"><span class="comment">// ç›‘å¬è·¯ç”±å˜åŒ–</span></span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.addEventListener(<span class="string">'popstate'</span>, onPopState)</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript"><span class="comment">// è·¯ç”±è§†å›¾</span></span></span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> routerView = <span class="literal">null</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">onLoad</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">  routerView = <span class="built_in">document</span>.querySelector(<span class="string">'#routeView'</span>)</span></span><br><span class="line">  onPopState()</span><br><span class="line"></span><br><span class="line"><span class="actionscript"> href=<span class="string">""</span>&gt;  <span class="comment">// æ‹¦æˆª &lt;a&gt; æ ‡ç­¾ç‚¹å‡»äº‹ä»¶é»˜è®¤è¡Œä¸ºï¼Œ ç‚¹å‡»æ—¶ä½¿ç”¨ pushState ä¿®æ”¹ URLå¹¶æ›´æ–°æ‰‹åŠ¨ UIï¼Œä»è€Œå®ç°ç‚¹å‡»é“¾æ¥æ›´æ–° URL å’Œ UI çš„æ•ˆæœã€‚</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> linkList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'a[href]'</span>)</span></span><br><span class="line"><span class="javascript">  linkList.forEach(<span class="function"><span class="params">el</span> =&gt;</span> el.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line">    e.preventDefault()</span><br><span class="line"><span class="actionscript">    history.pushState(<span class="literal">null</span>, <span class="string">''</span>, el.getAttribute(<span class="string">'href'</span>))</span></span><br><span class="line">    onPopState()</span><br><span class="line">  &#125;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript"><span class="comment">// è·¯ç”±å˜åŒ–æ—¶ï¼Œæ ¹æ®è·¯ç”±æ¸²æŸ“å¯¹åº” UI</span></span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">onPopState</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">  <span class="keyword">switch</span> (location.pathname) &#123;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">case</span> <span class="string">'/home'</span>:</span></span><br><span class="line"><span class="actionscript">      routerView.innerHTML = <span class="string">'Home'</span></span></span><br><span class="line"><span class="actionscript">      <span class="keyword">return</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">case</span> <span class="string">'/about'</span>:</span></span><br><span class="line"><span class="actionscript">      routerView.innerHTML = <span class="string">'About'</span></span></span><br><span class="line"><span class="actionscript">      <span class="keyword">return</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">default</span>:</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">return</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B/" class="post-title-link" itemprop="url">å¼•ç”¨ç±»å‹ä¹‹æ•°ç»„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 11:26:13 / Modified: 11:29:19" itemprop="dateCreated datePublished" datetime="2020-04-26T11:26:13+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>é™¤Objectä¹‹å¤–ï¼ŒArrayç±»å‹æ˜¯ECMAScriptä¸­æœ€å¸¸ç”¨çš„ç±»å‹ï¼Œä¸å…¶ä»–è¯­è¨€ä¸åŒï¼Œæ•°ç»„ä¸­å¯ä»¥ä¿å­˜ä»»ä½•ç±»å‹çš„æ•°æ®ï¼›åŒæ—¶æ•°ç»„å¤§å°å¯ä»¥éšæ„è°ƒæ•´ï¼Œä¸åŒäºjavaï¼Œå½“æ•°ç»„é•¿åº¦ç¡®å®šæ—¶ä¸èƒ½å†è¿›è¡Œæ”¹å˜ï¼›Array å­˜å‚¨çš„å¯¹è±¡èƒ½åŠ¨æ€å¢å¤šå’Œå‡å°‘ï¼Œå¹¶ä¸”å¯ä»¥å­˜å‚¨ä»»ä½•JavaScriptå€¼ã€‚</p>
<h2 id="åˆ›å»ºæ•°ç»„"><a href="#åˆ›å»ºæ•°ç»„" class="headerlink" title="åˆ›å»ºæ•°ç»„"></a>åˆ›å»ºæ•°ç»„</h2><p>1.åˆ©ç”¨Arrayæ„é€ å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> colors = <span class="keyword">new</span> <span class="built_in">Array</span>(args)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­argså¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯ä»¥ä¸ºä¸€ä¸ªæ•°å€¼æˆ–æ˜¯å­—ç¬¦ä¸²ï¼Œå½“ä¸ºæ•°å€¼æ—¶ï¼Œç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸ºè¯¥æ•°å€¼çš„æ•°ç»„ï¼Œå½“ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œç”Ÿæˆä¸€ä¸ªå«æœ‰è¯¥å­—ç¬¦ä¸²çš„æ•°ç»„ï¼›å…¶ä¸­ï¼Œnewå¯ä»¥çœç•¥<br>2.åˆ©ç”¨æ•°ç»„å­—é¢é‡è¡¨ç¤ºæ³•è¿›è¡Œåˆ›å»º</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> colors = [<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>]</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æ•°ç»„ä¸­æœ€åä¸€é¡¹ä¸è¦ä¸ºé€—å·ï¼Œå¦‚ä¸ºé€—å·å°†äº§ç”Ÿä¸€ä¸ªé•¿åº¦ä¸å®šçš„æ•°ç»„</p>
<h2 id="æ•°ç»„ç´¢å¼•"><a href="#æ•°ç»„ç´¢å¼•" class="headerlink" title="æ•°ç»„ç´¢å¼•"></a>æ•°ç»„ç´¢å¼•</h2><p>åœ¨è¯»å–å’Œè®¾ç½®æ•°ç»„çš„å€¼æ—¶ï¼Œåˆ©ç”¨æ–¹æ‹¬å·å¹¶æä¾›ç›¸åº”çš„æ•°å­—ç´¢å¼•ï¼Œæ•°å­—ç´¢å¼•æ˜¯ä»0å¼€å§‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> colors = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">0</span>])</span><br><span class="line">colors[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡lengthå±æ€§å¯ä»¥è·å–æ•°ç»„é•¿åº¦</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> colors = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">23</span>]</span><br><span class="line"><span class="built_in">console</span>.log(colors.length)</span><br></pre></td></tr></table></figure>
<p>å¯¹æ•°ç»„çš„lengthè¿›è¡Œè®¾ç½®æ—¶ï¼Œä¼šæ”¹å˜æ•°ç»„é¡¹æ•°ï¼Œå½“è®¾ç½®çš„lengthå¤§äºæ•°ç»„å®é™…é•¿åº¦æ—¶ï¼Œè¶…è¿‡çš„æ•°ç»„ä½ç½®ä¸ºundefinedï¼Œå½“è®¾ç½®çš„lengthå°äºæ•°ç»„å®é™…é•¿åº¦æ—¶ï¼Œå¤šä½™çš„æ•°ç»„ä¼šè¢«ç§»é™¤</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> colors = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">23</span>]</span><br><span class="line">colors.length = <span class="number">4</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">3</span>])</span><br><span class="line">colors.length = <span class="number">2</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<p>ç”±æ­¤å¯ä»¥åˆ©ç”¨lengthå±æ€§å®ç°æ•°ç»„çš„æ ˆæ–¹æ³•ï¼ˆæ„æƒ³ï¼Œè¿˜æ²¡å†™ğŸ˜ï¼‰</p>
<h2 id="æ£€æµ‹æ•°ç»„"><a href="#æ£€æµ‹æ•°ç»„" class="headerlink" title="æ£€æµ‹æ•°ç»„"></a>æ£€æµ‹æ•°ç»„</h2><p>å¯¹äºåŒä¸€ä¸ªç½‘é¡µæˆ–è€…ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸè€Œè¨€ï¼Œåˆ©ç”¨instanceofæ“ä½œç¬¦å¯ä»¥å®ç°æ•°ç»„çš„æ£€æµ‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(value <span class="keyword">instanceof</span> <span class="built_in">Array</span>)</span><br></pre></td></tr></table></figure>
<p>ä½†å¦‚æœç½‘é¡µä¸­åŒ…å«å¤šä¸ªæ¡†æ¶ï¼Œå¯¼è‡´å­˜åœ¨ä¸¤ä¸ªåŠä»¥ä¸Šä¸åŒå…¨å±€æ‰§è¡Œç¯å¢ƒï¼Œä»è€Œå¯¼è‡´å¤šä¸ªä¸åŒç‰ˆæœ¬çš„Arrayæ„é€ å‡½æ•°ï¼Œinstanceofæ–¹æ³•å°†å¤±æ•ˆï¼Œæ­¤æ—¶å¯ä»¥åˆ©ç”¨Array.isArray()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯æœ€ç»ˆç¡®å®šä¸€ä¸ªå€¼æ˜¯å¦æ˜¯æ•°ç»„ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(value))</span><br></pre></td></tr></table></figure>

<h2 id="è½¬æ¢æ–¹æ³•"><a href="#è½¬æ¢æ–¹æ³•" class="headerlink" title="è½¬æ¢æ–¹æ³•"></a>è½¬æ¢æ–¹æ³•</h2><p>æ‰€æœ‰å¯¹è±¡éƒ½æœ‰toLocaleString(), toString(), valueOf()æ–¹æ³•ã€‚å…¶ä¸­è°ƒç”¨æ•°ç»„çš„toString()ä¼šè¿”å›æœ‰æ•°ç»„ä¸­æ¯ä¸ªå€¼çš„å­—ç¬¦ä¸²å½¢å¼æ‹¼æ¥è€Œæˆçš„ä¸€ä¸ªä»¥é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ˆè°ƒç”¨æ•°ç»„æ¯ä¸€é¡¹çš„toString()æ–¹æ³•ï¼›è€Œè°ƒç”¨valueOf()ï¼Œè¿”å›çš„æ˜¯æ•°ç»„ï¼›toLocaleString()æ–¹æ³•è°ƒç”¨æ¯ä¸€é¡¹çš„toLocaleString()æ–¹æ³•ï¼Œå¯¹äºalertæ–¹æ³•ï¼Œå½“å…¶å‚æ•°ä¸ºæ•°ç»„æ—¶ï¼Œä¼šå…ˆè°ƒç”¨æ•°ç»„çš„toString()æ–¹æ³•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(color)</span><br><span class="line"><span class="built_in">console</span>.log(color.toString())</span><br><span class="line"><span class="built_in">console</span>.log(color.valueOf())</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è°ƒç”¨æ•°ç»„çš„join()æ–¹æ³•ï¼Œä¼ å…¥åˆ†éš”ç¬¦å‚æ•°ï¼Œæ›´æ”¹åˆ†éš”ç¬¦</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="built_in">console</span>.log(color.join(<span class="string">"||"</span>))</span><br></pre></td></tr></table></figure>

<h2 id="æ ˆæ–¹æ³•"><a href="#æ ˆæ–¹æ³•" class="headerlink" title="æ ˆæ–¹æ³•"></a>æ ˆæ–¹æ³•</h2><p>æ•°ç»„çš„push()æ–¹æ³•å¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡çš„å‚æ•°ï¼ŒæŠŠå®ƒä»¬é€ä¸ªæ·»åŠ åˆ°æ•°ç»„æœ«å°¾ï¼Œå¹¶è¿”å›ä¿®æ”¹æ•°ç»„é•¿åº¦ï¼›pop()æ–¹æ³•ä»æ•°ç»„æœ«å°¾ç§»é™¤æœ€åä¸€é¡¹ï¼Œå‡å°‘æ•°ç»„çš„lengthï¼Œç„¶åè¿”å›ç§»é™¤çš„é¡¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">var</span> count = color.push(<span class="string">'yellow'</span>, <span class="string">'black'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(count)</span><br><span class="line">myColor = color.pop()</span><br><span class="line"><span class="built_in">console</span>.log(myColor)</span><br></pre></td></tr></table></figure>

<h2 id="é˜Ÿåˆ—æ–¹æ³•"><a href="#é˜Ÿåˆ—æ–¹æ³•" class="headerlink" title="é˜Ÿåˆ—æ–¹æ³•"></a>é˜Ÿåˆ—æ–¹æ³•</h2><p>ä¸æ ˆæ–¹æ³•ç›¸æ¯”ï¼Œé˜Ÿåˆ—æ–¹æ³•å°†pop()æ–¹æ³•å˜ä¸ºshift()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç§»é™¤æ•°ç»„ç¬¬ä¸€é¡¹å¹¶è¿”å›è¯¥é¡¹ï¼Œpush()æ–¹æ³•ä¸æ ˆæ–¹æ³•ç›¸åŒã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line">myColor = color.shift()</span><br><span class="line"><span class="built_in">console</span>.log(myColor)</span><br></pre></td></tr></table></figure>

<h2 id="é‡æ’åºæ–¹æ³•"><a href="#é‡æ’åºæ–¹æ³•" class="headerlink" title="é‡æ’åºæ–¹æ³•"></a>é‡æ’åºæ–¹æ³•</h2><p>æ•°ç»„æœ‰ä¸¤ä¸ªå¯ä»¥ç›´æ¥ç”¨æ¥é‡æ’åºçš„æ–¹æ³•ï¼Œreverse()å’Œsort()æ–¹æ³•ã€‚<br>reverse()æ–¹æ³•å°†æ•°ç»„è¿›è¡Œå€’æ’</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> values = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">values.reverse()</span><br><span class="line"><span class="built_in">console</span>.log(values)</span><br></pre></td></tr></table></figure>
<p>sort()æ–¹æ³•é»˜è®¤æŒ‰å‡åºæ’åˆ—æ•°ç»„ï¼Œä¸ºå®ç°æ’åºï¼Œsort()æ–¹æ³•ä¼šè°ƒç”¨æ¯ä¸ªæ•°ç»„é¡¹çš„toString()æ–¹æ³•ï¼Œç„¶åæ¯”è¾ƒå­—ç¬¦ä¸²ï¼Œå³ä½¿æ•°ç»„é‡Œæ¯ä¸€é¡¹éƒ½æ˜¯æ•°å€¼ï¼Œsort()æ–¹æ³•æ¯”è¾ƒçš„ä¹Ÿæ˜¯å­—ç¬¦ä¸²ã€‚ä½†æœ‰äº›æƒ…å†µä¸‹ï¼Œé€šè¿‡å­—ç¬¦ä¸²æ¯”è¾ƒä¼šå‡ºç°é”™è¯¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> values = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">15</span>]</span><br><span class="line">values.sort()</span><br><span class="line"><span class="built_in">console</span>.log(values) <span class="comment">//0,1,10,15,5</span></span><br></pre></td></tr></table></figure>
<p>å¯é€šè¿‡ç»™sort()å‡½æ•°ä¼ é€’ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼ˆå‡åºï¼‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compare</span>(<span class="params">value1, value2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (value &lt; value) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value1 &gt; value2) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> values = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">15</span>]</span><br><span class="line">values.sort(compare)</span><br><span class="line"><span class="built_in">console</span>.log(values) <span class="comment">//0,1,5,10,15</span></span><br></pre></td></tr></table></figure>
<p>å½“æ•°ç»„å…ƒç´ ä¸ºæ•°å€¼ç±»å‹æˆ–å…¶valueOfæ–¹æ³•ä¼šè¿”å›æ•°å€¼ç±»å‹å¯¹è±¡æ—¶æ¯”è¾ƒå‡½æ•°å¯ç®€åŒ–ä¸ºï¼ˆå‡åºï¼‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compare</span>(<span class="params">value1, value2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value2 - value1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šreverse()å’Œsort()æ–¹æ³•éƒ½æ˜¯å¯¹åŸå§‹æ•°ç»„è¿›è¡Œä¿®æ”¹</p>
<h2 id="æ“ä½œæ–¹æ³•"><a href="#æ“ä½œæ–¹æ³•" class="headerlink" title="æ“ä½œæ–¹æ³•"></a>æ“ä½œæ–¹æ³•</h2><p>concat()æ–¹æ³•å¯ä»¥åŸºäºå½“å‰æ•°ç»„ä¸­çš„æ‰€æœ‰é¡¹åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå…ˆåˆ›å»ºå½“å‰æ•°ç»„çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œç„¶åå°†æ¥æ”¶åˆ°çš„å‚æ•°æ·»åŠ åˆ°è¿™ä¸ªå‰¯æœ¬çš„æœ«å°¾ï¼Œæœ€åè¿”å›æ–°æ„å»ºçš„æ•°ç»„ã€‚å½“concat()æ–¹æ³•ä¸ä¼ å…¥å‚æ•°æ—¶ï¼Œåªæ˜¯å¯¹åŸæ•°ç»„è¿›è¡Œå¤åˆ¶å¹¶è¿”å›å‰¯æœ¬ï¼›å½“ä¼ å…¥å‚æ•°ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªæ•°ç»„è¯¥æ–¹æ³•å°†æ¯ä¸ªæ•°ç»„çš„æ¯ä¸€é¡¹éƒ½æ·»åŠ åˆ°ç»“æœæ•°ç»„ä¸­ï¼›å¦‚æœä¼ å…¥çš„å‚æ•°ä¸æ˜¯æ•°ç»„ï¼Œåˆ™å€¼å°†ä¼šè¢«ç®€å•æ·»åŠ åˆ°ç»“æœæ•°ç»„çš„æœ«å°¾ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">var</span> color2 = colors.concat(<span class="string">'yellow'</span>, [<span class="string">'black'</span>, <span class="string">'brown'</span>])</span><br><span class="line"><span class="built_in">console</span>.log(color)</span><br><span class="line"><span class="built_in">console</span>.log(color2)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„concat()æ–¹æ³•ä¸æ”¹å˜åŸå§‹æ•°ç»„ã€‚<br>slice()æ–¹æ³•èƒ½å¤ŸåŸºäºå½“å‰æ•°ç»„ä¸­çš„ä¸€æˆ–å¤šä¸ªé¡¹åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚slice()æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªæˆ–ä¸¤ä¸ªå‚æ•°ï¼Œå³è¦è¿”å›é¡¹çš„èµ·å§‹å’Œç»“æŸä½ç½®ï¼›è‹¥slice()æ–¹æ³•åªä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œåˆ™è¿”å›ä»è¯¥å‚æ•°æŒ‡å®šä½ç½®çœ‹æ˜¯åˆ°å½“å‰æ•°ç»„æœ«å°¾çš„æ‰€æœ‰é¡¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>, <span class="string">'yellow'</span>, <span class="string">'black'</span>, <span class="string">'brown'</span>]</span><br><span class="line"><span class="keyword">var</span> color2 = colors.slice(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">var</span> color3 = colors.slice(<span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">console</span>.log(color)</span><br><span class="line"><span class="built_in">console</span>.log(color2)</span><br><span class="line"><span class="built_in">console</span>.log(color3)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„slice()æ–¹æ³•ä¸æ”¹å˜åŸå§‹æ•°ç»„ã€‚<br>splice()æ–¹æ³•ä¸»è¦ç”¨é€”æ—¶å‘æ•°ç»„ä¸­éƒ¨æ’å…¥é¡¹ï¼š<br>1.åˆ é™¤ï¼šå¯ä»¥åˆ é™¤ä»»æ„æ•°é‡çš„çš„é¡¹ï¼Œéœ€æŒ‡å®š2ä¸ªå‚æ•°ï¼šè¦åˆ é™¤çš„ç¬¬ä¸€é¡¹çš„ä½ç½®å’Œè¦åˆ é™¤çš„é¡¹æ•°ï¼›<br>2.æ’å…¥ï¼šå¯ä»¥å‘æŒ‡å®šä½ç½®æ’å…¥ä»»æ„æ•°é‡çš„é¡¹ï¼Œéœ€æä¾›3ä¸ªå‚æ•°ï¼šèµ·å§‹ä½ç½®ã€0ï¼ˆè¦åˆ é™¤çš„é¡¹ï¼‰å’Œè¦æ’å…¥çš„é¡¹ã€‚æœ€åä¸€ä¸ªå‚æ•°å¯ä»¥ä¸ºä»»æ„å¤šé¡¹<br>3.æ›¿æ¢ï¼šå¯ä»¥é¡¹æŒ‡å®šä½ç½®æ’å…¥ä»»æ„æ•°é‡çš„é¡¹ï¼Œä¸”åŒæ—¶åˆ é™¤ä»»æ„æ•°é‡çš„é¡¹ï¼Œéœ€æŒ‡å®š3ä¸ªå‚æ•°ï¼šå…¶å®ä½ç½®ã€è¦åˆ é™¤çš„é¡¹æ•°å’Œè¦æ’å…¥çš„ä»»æ„æ•°é‡çš„é¡¹ã€‚æ’å…¥çš„é¡¹æ•°ä¸å¿…ä¸åˆ é™¤çš„é¡¹æ•°ç›¸ç­‰ã€‚<br>splice()æ–¹æ³•å§‹ç»ˆè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„ä¸­åŒ…å«ä»åŸå§‹æ•°ç»„ä¸­åˆ é™¤çš„é¡¹ï¼ˆå¦‚æœæ²¡æœ‰åˆ é™¤ä»»ä½•é¡¹ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">var</span> removed = color.splice(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">console</span>.log(color)</span><br><span class="line"><span class="built_in">console</span>.log(removed)</span><br><span class="line"></span><br><span class="line">removed = color.splice(<span class="number">1</span>,<span class="number">0</span>,<span class="string">'yellow'</span>,<span class="string">'orange'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(color)</span><br><span class="line"><span class="built_in">console</span>.log(removed)</span><br><span class="line"></span><br><span class="line">removed = color.splice(<span class="number">1</span>,<span class="number">1</span>,<span class="string">'red'</span>, <span class="string">'purple'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(color)</span><br><span class="line"><span class="built_in">console</span>.log(removed)</span><br></pre></td></tr></table></figure>
<p>splice()æ–¹æ³•æ”¹å˜åŸæ•°ç»„</p>
<h2 id="ä½ç½®æ–¹æ³•"><a href="#ä½ç½®æ–¹æ³•" class="headerlink" title="ä½ç½®æ–¹æ³•"></a>ä½ç½®æ–¹æ³•</h2><p>æ•°ç»„å®ä¾‹æœ‰ä¸¤ä¸ªä½ç½®æ–¹æ³•ï¼šindexOf()å’ŒlastIndexOf()ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œè¦æŸ¥æ‰¾çš„é¡¹å’Œè¡¨ç¤ºæŸ¥æ‰¾èµ·ç‚¹ä½ç½®çš„ç´¢å¼•ï¼ˆå¯é€‰ï¼‰ã€‚å…¶ä¸­ï¼ŒindexOf()æ–¹æ³•ä»èµ·ç‚¹ä½ç½®ä»å‰å‘åæŸ¥æ‰¾ï¼ŒlastIndexOf()æ–¹æ³•ä»èµ·å§‹ç‚¹ä»åå‘å‰æŸ¥æ‰¾ï¼Œä¸¤ä¸ªæ–¹æ³•è¿”å›è¦æŸ¥æ‰¾é¡¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚å¦‚æœè¦æŸ¥æ‰¾é¡¹ä¸åœ¨æ•°ç»„ä¸­åˆ™è¿”å›-1.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> number = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="built_in">console</span>.log(number.indexOf(<span class="number">4</span>,<span class="number">4</span>))</span><br><span class="line"><span class="built_in">console</span>.log(number.lastIndexOf(<span class="number">4</span>,<span class="number">4</span>))</span><br></pre></td></tr></table></figure>

<h2 id="è¿­ä»£æ–¹æ³•"><a href="#è¿­ä»£æ–¹æ³•" class="headerlink" title="è¿­ä»£æ–¹æ³•"></a>è¿­ä»£æ–¹æ³•</h2><p>ECMAScript5ä¸ºæ•°ç»„å®šä¹‰äº†5ä¸ªè¿­ä»£æ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šè¦åœ¨æ¯ä¸€é¡¹ä¸Šè¿è¡Œçš„å‡½æ•°å’Œè¿è¡Œè¯¥å‡½æ•°çš„ä½œç”¨åŸŸå¯¹è±¡â€”-å½±å“thisçš„å€¼ã€‚ä¼ å…¥è¿™äº›æ–¹æ³•çš„å‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šæ•°ç»„é¡¹çš„å€¼ã€è¯¥é¡¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®å’Œæ•°ç»„å¯¹è±¡æœ¬èº«ã€‚<br>1.every(): å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œå¦‚æœè¯¥å‡½æ•°å¯¹æ¯ä¸€é¡¹éƒ½è¿”å›trueåˆ™è¿”å›trueï¼›(å½“æ‰¾åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„é¡¹æ—¶åœæ­¢è¿­ä»£)(ä¸æ”¹å˜åŸæ•°ç»„)<br>2.filter(): å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›è¯¥å‡½æ•°ä¼šè¿”å›trueçš„é¡¹ç»„æˆçš„æ•°ç»„ï¼›(ä¸æ”¹å˜åŸæ•°ç»„)<br>3.forEach(): å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ã€‚è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼›æœ¬è´¨ä¸Šä¸forå¾ªç¯è¿­ä»£æ•°ç»„ä¸€æ ·ã€‚ (ä¸æ”¹å˜åŸæ•°ç»„)<br>4.map(): å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›æ¯æ¬¡å‡½æ•°è°ƒç”¨ç»“æœç»„æˆçš„æ•°ç»„ï¼›(ä¸æ”¹å˜åŸæ•°ç»„)<br>5.some(): å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œå¦‚æœè¯¥å‡½æ•°å¯¹ä»»ä¸€é¡¹è¿”å›trueï¼Œåˆ™è¿”å›trueã€‚(å½“æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„é¡¹æ—¶åœæ­¢è¿­ä»£) (ä¸æ”¹å˜åŸæ•°ç»„)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> number = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">var</span> everyResult = number.every(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, array</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (item &gt; <span class="number">2</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> someResult = number.some(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, array</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (item &gt; <span class="number">2</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> filterResult = number.filter(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, array</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (item &gt; <span class="number">2</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> mapResult = number.map(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, array</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> item*<span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line">number.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, array</span>) </span>&#123;</span><br><span class="line">	number[index] = item*<span class="number">3</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="ç¼©å°æ–¹æ³•"><a href="#ç¼©å°æ–¹æ³•" class="headerlink" title="ç¼©å°æ–¹æ³•"></a>ç¼©å°æ–¹æ³•</h2><p>reduce()å’ŒreduceRight()æ–¹æ³•ä¸ºä¸¤ä¸ªç¼©å°æ•°ç»„æ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šè¿­ä»£æ•°ç»„çš„æ‰€æœ‰é¡¹ï¼Œå…¶ä¸­reduce()æ–¹æ³•ä»æ•°ç»„çš„ç¬¬ä¸€é¡¹å¼€å§‹ï¼Œé€ä¸ªéå†åˆ°æœ€åï¼›è€ŒreduceRight()åˆ™ä»æ•°ç»„çš„æœ€åä¸€é¡¹å¼€å§‹ï¼Œå‘å‰éå†åˆ°ç¬¬ä¸€é¡¹ã€‚è¿™è¿ä¸ªæ–¹æ³•éƒ½æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªåœ¨æ¯ä¸€é¡¹ä¸Šè°ƒç”¨çš„å‡½æ•°å’Œä½œä¸ºç¼©å°åŸºç¡€çš„åˆå§‹å€¼ï¼ˆå¯é€‰ï¼‰ã€‚ä¸²ç»™reduce()å’ŒreduceRight()å‡½æ•°æ¥æ”¶4ä¸ªå‚æ•°ï¼šå‰ä¸€ä¸ªå€¼ï¼Œå½“å‰å€¼ï¼Œæƒ³çš„ç´¢å¼•å’Œæ•°ç»„å¯¹è±¡ï¼Œå‡½æ•°è¿”å›çš„ä»»ä½•å€¼éƒ½ä¼šä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è‡ªåŠ¨ä¼ ç»™ä¸‹ä¸€é¡¹ï¼Œç¬¬ä¸€æ¬¡è¿­ä»£å‘ç”Ÿåœ¨æ•°ç»„çš„ç¬¬äºŒé¡¹ä¸Šï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå‚æ•°æ—¶æ•°ç»„çš„ç¬¬ä¸€é¡¹ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æ•°ç»„çš„ç¬¬äºŒé¡¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> values = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> sum = values.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev, cur, index, array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> prev + cur</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(sum)</span><br></pre></td></tr></table></figure>
<p>reduceRight()æ–¹æ³•ç›¸è¾ƒreduce()æ–¹æ³•åŒºåˆ«åœ¨äºæ‰§è¡Œçš„æ–¹å‘ä¸åŒã€‚</p>
<h2 id="ES6å¢å¼ºçš„æ•°ç»„åŠŸèƒ½"><a href="#ES6å¢å¼ºçš„æ•°ç»„åŠŸèƒ½" class="headerlink" title="ES6å¢å¼ºçš„æ•°ç»„åŠŸèƒ½"></a>ES6å¢å¼ºçš„æ•°ç»„åŠŸèƒ½</h2><h3 id="Array-of-æ–¹æ³•"><a href="#Array-of-æ–¹æ³•" class="headerlink" title="Array.of()æ–¹æ³•"></a>Array.of()æ–¹æ³•</h3><p>JSè¯­è¨€ä¸­å­˜åœ¨ä¸€ä¸ªæ€ªå¼‚ç‚¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> item = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(item.length) <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>])     <span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">1</span>])     <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line">item = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"2"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(item.length) <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">item = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(item.length) <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>])     <span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">1</span>])     <span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">item = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1</span>,<span class="string">"2"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(item.length) <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>])     <span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">1</span>])     <span class="comment">//"2"</span></span><br></pre></td></tr></table></figure>

<p>ES6ä¸­å¼•ç”¨Array.of()æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯¥æ–¹æ³•ç±»ä¼¼ Array æ„é€ å™¨ï¼Œä½†åœ¨ä½¿ç”¨å¤šä¸ªæ•°å€¼å‚æ•°çš„æ—¶å€™ä¸ä¼šå¯¼è‡´ç‰¹æ®Šç»“æœã€‚Array.of()æ–¹æ³•æ€»ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å‡ºå…¥å‚æ•°çš„æ•°ç»„ï¼Œä¸ç®¡å‚æ•°çš„æ•°é‡å’Œç±»å‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> item = <span class="built_in">Array</span>.of(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(item.length)      <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>])          <span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">1</span>])          <span class="comment">//2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> item = <span class="built_in">Array</span>.of(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(item.length)      <span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>])          <span class="comment">//2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> item = <span class="built_in">Array</span>.of(<span class="string">"2"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(item.length)      <span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(item[<span class="number">0</span>])          <span class="comment">//"2"</span></span><br></pre></td></tr></table></figure>

<h3 id="Array-from-æ–¹æ³•"><a href="#Array-from-æ–¹æ³•" class="headerlink" title="Array.from()æ–¹æ³•"></a>Array.from()æ–¹æ³•</h3><p>è¯¥æ–¹æ³•å°†ç±»æ•°ç»„å¯¹è±¡è½¬åŒ–ä¸ºæ•°ç»„å¯¹è±¡,åŒæ—¶ï¼Œå¯ä»¥å‘fromä¼ å…¥ä¸€ä¸ªæ˜ å°„å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">translate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>, (value) =&gt; value + <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> number = translate(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">console</span>.log(number)                  <span class="comment">//2,3,4</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜ å°„å‡½æ•°éœ€è¦åœ¨å¯¹è±¡ä¸Šå·¥ä½œï¼Œå¯ä»¥æ‰‹åŠ¨ä¼ é€’ç¬¬ä¸‰ä¸ªå‚æ•°ç»™Array.from()æ–¹æ³•ï¼Œä»è€Œ<strong>æŒ‡å®šæ˜ å°„å‡½æ•°å†…éƒ¨</strong>çš„thiså€¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> diff = <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> helper = &#123;</span><br><span class="line">    diff: <span class="number">1</span>,</span><br><span class="line">    add(value) &#123;</span><br><span class="line">    	<span class="built_in">console</span>.log(<span class="keyword">this</span>.diff)</span><br><span class="line">        <span class="keyword">return</span> value + <span class="keyword">this</span>.diff</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">translate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.diff = <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>, helper.add, helper) <span class="comment">//1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>, helper.add)         <span class="comment">//2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> numbers = translate(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">console</span>.log(numbers)       <span class="comment">//1     2,3,4   2    4,5,6</span></span><br></pre></td></tr></table></figure>
<p>Array.from()æ–¹æ³•ä¸ä»…å¯ä»¥ç”¨äºç±»æ•°ç»„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç”¨äºè¿­ä»£å¯¹è±¡ï¼Œè¿™æ„å‘³ç€è¯¥æ–¹æ³•å¯ä»¥å°†ä»»æ„åŒ…å«Symbol.iteratorå±æ€§çš„å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = &#123;</span><br><span class="line">    *[<span class="built_in">Symbol</span>.iterator] () &#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">yield</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> numbers2 = <span class="built_in">Array</span>.from(numbers, (value)=&gt;value+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">console</span>.log(numbers2)</span><br></pre></td></tr></table></figure>
<h3 id="æ•°ç»„ä¸Šçš„æ–°æ–¹æ³•"><a href="#æ•°ç»„ä¸Šçš„æ–°æ–¹æ³•" class="headerlink" title="æ•°ç»„ä¸Šçš„æ–°æ–¹æ³•"></a>æ•°ç»„ä¸Šçš„æ–°æ–¹æ³•</h3><p>find()ä¸findIndex()æ–¹æ³•ã€‚ES5ä¸­å¢åŠ äº†indexOf()å’ŒlastIndexOf()æ–¹æ³•ï¼Œä»è€Œå…è®¸å¼€å‘è€…åœ¨æ•°ç»„ä¸­æŸ¥æ‰¾ç‰¹å®šå€¼ï¼Œä½†ä»å­˜åœ¨é™åˆ¶ã€‚<br>find()å’ŒfindIndex()æ–¹æ³•å‡æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªå›è°ƒå‡½æ•°ã€ä¸€ä¸ªå¯é€‰å€¼ç”¨äºæŒ‡å®šå›è°ƒå‡½æ•°å†…éƒ¨çš„thisã€‚è¯¥å›è°ƒå‡½æ•°å¯æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šæ•°ç»„çš„æŸä¸ªå…ƒç´ ã€è¯¥å…ƒç´ å¯¹åº”çš„ç´¢å¼•ä½ç½®ä»¥åŠè¯¥æ•°ç»„è‡ªèº«ï¼Œè¿™ä¸map()å’ŒforEach()æ–¹æ³•çš„å›è°ƒå‡½æ•°æ‰€ç”¨çš„å‚æ•°ä¸€è‡´ã€‚<strong>è¯¥å›è°ƒå‡½æ•°åº”å½“åœ¨ç»™å®šçš„å…ƒç´ æ»¡è¶³ä½ å®šä¹‰çš„æ¡ä»¶æ—¶è¿”å›true</strong>ï¼Œè€Œfind()å’ŒfindIndex()æ–¹æ³•å‡ä¼šåœ¨å›è°ƒå‡½æ•°ç¬¬ä¸€æ¬¡è¿”å›trueæ—¶åœæ­¢æŸ¥æ‰¾ã€‚find()ä¼šè¿”å›åŒ¹é…çš„å€¼ï¼ŒfindIndex()ä¼šè¿”å›åŒ¹é…ä½ç½®çš„ç´¢å¼•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line"><span class="built_in">console</span>.log(numbers.find(<span class="function"><span class="params">n</span>=&gt;</span> n &gt; <span class="number">30</span>))</span><br><span class="line"><span class="built_in">console</span>.log(numbers.findIndex(<span class="function"><span class="params">n</span>=&gt;</span> n &gt; <span class="number">30</span>))</span><br></pre></td></tr></table></figure>
<p><strong>find()ä¸findIndex()æ–¹æ³•åœ¨æŸ¥æ‰¾æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ•°ç»„å…ƒç´ æ—¶éå¸¸æœ‰ç”¨ã€‚ä½†è‹¥æƒ³æŸ¥æ‰¾ç‰¹å®šå€¼ï¼Œåˆ™ä½¿ç”¨ indexOf() ä¸ lastIndexOf() æ–¹æ³•ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</strong><br>fill()æ–¹æ³•èƒ½ä½¿ç”¨ç‰¹å®šå€¼å¡«å……æ•°ç»„ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå½“åªä½¿ç”¨ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•ä¼šç”¨è¯¥å‚æ•°çš„å€¼å¡«å……æ•´ä¸ªæ•°ç»„ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">numbers.fill(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">console</span>.log(numbers.toString())   <span class="comment">//1,1,1,1</span></span><br></pre></td></tr></table></figure>
<p>å½“åªæ”¹å˜éƒ¨åˆ†å€¼æ—¶ï¼Œå¯è®¾ç½®èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®çš„å‚æ•°ï¼ˆä¸åŒ…æ‹¬ç»“æŸä½ç½®ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">numbers.fill(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(numbers.toString())   <span class="comment">//1,2,1,1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">numbers.fill(<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">console</span>.log(numbers.toString())   <span class="comment">//1,1,1,4</span></span><br></pre></td></tr></table></figure>
<p>copyWithin()æ–¹æ³•å’Œfill()æ–¹æ³•ç±»ä¼¼ï¼Œå¯ä»¥ä¸€æ¬¡æ€§ä¿®æ”¹æ•°ç»„çš„å¤šä¸ªå…ƒç´ ã€‚copyWithin()æ–¹æ³•å…è®¸åœ¨æ•°ç»„å†…éƒ¨å¤åˆ¶è‡ªèº«å…ƒç´ ï¼Œä¸ºæ­¤ä½ éœ€è¦ä¼ æ¯’ä¸¤ä¸ªå‚æ•°ç»™copyWithin()æ–¹æ³•ï¼šä»ä»€ä¹ˆä½ç½®å¼€å§‹å¡«å……ï¼Œè¢«ç”¨æ¥å¤åˆ¶çš„æ•°æ®çš„èµ·å§‹ä½ç½®ç´¢å¼•ä»¥åŠç»ˆæ­¢ä½ç½®ç´¢å¼•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">numbers.copyWithin()(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line"><span class="built_in">console</span>.log(numbers.toString())  <span class="comment">//1,2,1,2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">numbers.copyWithin(<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">console</span>.log(numbers.toString())</span><br></pre></td></tr></table></figure>
<h2 id="ç±»å‹åŒ–æ•°ç»„"><a href="#ç±»å‹åŒ–æ•°ç»„" class="headerlink" title="ç±»å‹åŒ–æ•°ç»„"></a>ç±»å‹åŒ–æ•°ç»„</h2><p>ç±»å‹åŒ–æ•°ç»„æ˜¯æœ‰ç‰¹æ®Šç”¨é€”çš„æ•°ç»„ï¼Œè¢«è®¾è®¡ç”¨æ¥å¤„ç†æ•°å€¼ç±»å‹æ•°æ®ï¼ˆè€Œä¸åƒåç§°æš—ç¤ºçš„é‚£æ ·ï¼Œèƒ½å¤„ç†æ‰€æœ‰ç±»å‹ï¼‰ã€‚å¼•å…¥ç±»å‹åŒ–æ•°ç»„çªç ´äº†æ ¼å¼é™åˆ¶å¹¶å¸¦æ¥äº†æ›´å¥½çš„<br>æ•°å­¦è¿ç®—æ€§èƒ½ï¼Œå…¶è®¾è®¡æ¦‚å¿µæ˜¯ï¼šå•ä¸ªæ•°å€¼å¯ä»¥è¢«è§†ä¸ºç”±â€œä½â€æ„æˆçš„æ•°ç»„ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å…¶ä½¿ç”¨ä¸JS æ•°ç»„ç°æœ‰æ–¹æ³•ç±»ä¼¼çš„æ–¹æ³•ã€‚</p>
<h3 id="æ•°å€¼æ•°æ®ç±»å‹"><a href="#æ•°å€¼æ•°æ®ç±»å‹" class="headerlink" title="æ•°å€¼æ•°æ®ç±»å‹"></a>æ•°å€¼æ•°æ®ç±»å‹</h3><p>JS æ•°å€¼ä½¿ç”¨ IEEE 754 æ ‡å‡†æ ¼å¼å­˜å‚¨ï¼Œä½¿ç”¨64ä½æ¥å­˜å‚¨ä¸€ä¸ªæ•°å€¼çš„æµ®ç‚¹æ•°è¡¨ç¤ºå½¢å¼ï¼Œè¯¥æ ¼å¼åœ¨JSä¸­è¢«åŒæ—¶ç”¨æ¥è¡¨ç¤ºæ•´æ•°ä¸æµ®ç‚¹æ•°ï¼›å½“å€¼æ”¹å˜æ—¶ï¼Œå¯èƒ½ä¼šé¢‘ç¹å‘ç”Ÿæ•´æ•°ä¸æµ®ç‚¹æ•°ä¹‹é—´çš„æ ¼å¼è½¬æ¢ã€‚è€Œç±»å‹åŒ–æ•°ç»„åˆ™å…è®¸å­˜å‚¨å¹¶æ“ä½œå…«ç§ä¸åŒçš„æ•°å€¼ç±»å‹ï¼š</p>
<ol>
<li>8 ä½æœ‰ç¬¦å·æ•´æ•°ï¼ˆint8ï¼‰</li>
<li>8 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆuint8ï¼‰</li>
<li>16 ä½æœ‰ç¬¦å·æ•´æ•°ï¼ˆint16ï¼‰</li>
<li>16 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆuint16ï¼‰</li>
<li>32 ä½æœ‰ç¬¦å·æ•´æ•°ï¼ˆint32ï¼‰</li>
<li>32 ä½æ— ç¬¦å·æ•´æ•°ï¼ˆuint32ï¼‰</li>
<li>32 ä½æµ®ç‚¹æ•°ï¼ˆfloat32ï¼‰</li>
<li>64 ä½æµ®ç‚¹æ•°ï¼ˆfloat64ï¼‰<br>æ‰€æœ‰ä¸ç±»å‹åŒ–æ•°ç»„ç›¸å…³çš„æ“ä½œå’Œå¯¹è±¡éƒ½å›´ç»•ç€è¿™å…«ç§æ•°æ®ç±»å‹ã€‚ä¸ºäº†ä½¿ç”¨å®ƒä»¬ï¼Œä½ é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªæ•°ç»„ç¼“å†²åŒºç”¨äºå­˜å‚¨æ•°æ®ã€‚<h3 id="æ•°ç»„ç¼“å†²åŒº"><a href="#æ•°ç»„ç¼“å†²åŒº" class="headerlink" title="æ•°ç»„ç¼“å†²åŒº"></a>æ•°ç»„ç¼“å†²åŒº</h3>æ•°ç»„ç¼“å†²åŒºï¼ˆarray bufferï¼‰æ˜¯å†…å­˜ä¸­åŒ…å«ä¸€å®šæ•°é‡å­—èŠ‚çš„åŒºåŸŸï¼Œè€Œæ‰€æœ‰çš„ç±»å‹åŒ–æ•°ç»„éƒ½åŸºäºæ•°ç»„ç¼“å†²åŒºã€‚ä½¿ç”¨ArrayBufferæ„é€ å™¨æ¥åˆ›å»ºä¸€ä¸ªæ•°ç»„ç¼“å†²åŒºï¼›è°ƒç”¨ArrayBufferæ„é€ å™¨æ—¶ï¼Œåªéœ€è¦ä¼ å…¥å•ä¸ªæ•°å€¼ç”¨äºæŒ‡å®šç¼“å†²åŒºåŒ…å«çš„å­—èŠ‚æ•°ã€‚å¯ä»¥é€šè¿‡byteLengthå±æ€§æ¥è·å–ç¼“å†²åŒºçš„å­—èŠ‚æ•°ã€‚<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">console</span>.log(buffer.byteLength)</span><br></pre></td></tr></table></figure>
å¯ä»¥ä½¿ç”¨slice()æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ã€åŒ…å«å·²æœ‰ç¼“å†²åŒºéƒ¨åˆ†çš„å†…å®¹æ•°ç»„ç¼“å†²åŒºï¼Œå’Œæ•°ç»„çš„slice()æ–¹æ³•ç±»ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨èµ·å§‹ä½ç½®ä¸ç»“æŸä½ç½®å‚æ•°ï¼Œè¿”å›ç”±åŸç¼“å†²åŒºå…ƒç´ ç»„æˆçš„ä¸€ä¸ªæ–°çš„ArrayBufferå®ä¾‹ã€‚<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> buffer2 = buffer.slice(<span class="number">4</span>,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">console</span>.log((buffer2.byteLength))</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨è§†å›¾æ“ä½œæ•°ç»„ç¼“å†²åŒº"><a href="#ä½¿ç”¨è§†å›¾æ“ä½œæ•°ç»„ç¼“å†²åŒº" class="headerlink" title="ä½¿ç”¨è§†å›¾æ“ä½œæ•°ç»„ç¼“å†²åŒº"></a>ä½¿ç”¨è§†å›¾æ“ä½œæ•°ç»„ç¼“å†²åŒº</h2>æ•°ç»„ç¼“å†²åŒºä»£è¡¨äº†ä¸€å—å†…å­˜åŒºåŸŸï¼Œè€Œè§†å›¾ï¼ˆviewsï¼‰åˆ™æ˜¯æ“ä½œè¿™å—åŒºåŸŸçš„æ¥å£ã€‚è§†å›¾å·¥ä½œåœ¨æ•°ç»„ç¼“å†²åŒºæˆ–å…¶å­é›†ä¸Šï¼Œå¯ä»¥è¯»å†™æŸç§æ•°å€¼æ•°æ®ç±»å‹çš„æ•°æ®ã€‚DataViewç±»å‹æ—¶æ•°ç»„ç¼“å†²åŒºçš„é€šç”¨è§†å›¾ï¼Œå…è®¸å¯¹å‰è¿°æ‰€æœ‰8ä¸­æ•°å€¼æ•°æ®ç±»å‹è¿›è¡Œæ“ä½œã€‚åŒæ—¶å¯ä»¥å¯¹æ•°æ®ç¼“å†²åŒºçš„éƒ¨åˆ†ä¸Šåˆ›å»ºè§†å›¾ï¼Œéœ€è¦æä¾›å­—èŠ‚åç§»é‡ä»¥åŠè¦åŒ…å«çš„å­—èŠ‚æ•°ã€‚<strong>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥åœ¨åŒä¸€ä¸ªæ•°ç»„ç¼“å†²åŒºä¸Šåˆ›å»ºå¤šä¸ªä¸åŒçš„è§†å›¾ï¼Œè¿™æ ·æœ‰åŠ©äºå°†å•å—å†…å­˜åŒºåŸŸä¾›ç»™æ•´ä¸ªåº”ç”¨ä½¿ç”¨ï¼Œè€Œä¸å¿…æ¯æ¬¡åœ¨æœ‰éœ€è¦æ—¶æ‰åŠ¨æ€åˆ†é…å†…å­˜ã€‚</strong><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> buffer2 = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer, <span class="number">5</span>,<span class="number">2</span>) <span class="comment">//åŒ…å«ä½ç½®5å’Œä½ç½®6çš„å­—èŠ‚</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>è·å–è§†å›¾ä¿¡æ¯<br>å¯ä»¥é€šè¿‡æŸ¥è¯¢ä¸€ä¸‹åªè¯»å±æ€§æ¥è·å–è§†å›¾çš„ä¿¡æ¯ï¼š<br>buffer: æ¦‚è¿°å›¾æ‰€ç»‘å®šçš„æ•°ç»„ç¼“å†²åŒºï¼›<br>byteOffsetï¼šä¼ ç»™DataViewæ„é€ å™¨çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœå½“æ—¶æä¾›äº†çš„è¯ï¼ˆé»˜è®¤ä¸º0ï¼‰ï¼›<br>byte Lengthï¼šä¼ ç»™DataViewæ„é€ å™¨çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå¦‚æœå½“æ—¶æä¾›çš„è¯ï¼ˆé»˜è®¤ä¸ºè¯¥ç¼“å†²åŒºçš„byteLengthå±æ€§ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> view1 = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer)</span><br><span class="line"><span class="keyword">let</span> view2 = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer, <span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(view1.buffer === buffer)            <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(view2.buffer === buffer)            <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(view1.byteOffset)</span><br><span class="line"><span class="built_in">console</span>.log(view2.byteOffset)</span><br><span class="line"><span class="built_in">console</span>.log(view1.byteLength)</span><br><span class="line"><span class="built_in">console</span>.log(view2.byteLength)</span><br></pre></td></tr></table></figure>

<p>è¯»å–å’Œå†™å…¥æ•°æ®<br>å¯¹åº”JSæ‰€æœ‰8ç§æ•°å€¼æ•°æ®ç±»å‹ï¼ŒDataViewè§†å›¾çš„åŸå‹åˆ«æä¾›äº†åœ¨æ•°ç»„ç¼“å†²åŒºä¸Šå†™å…¥æ•°æ®çš„ä¸€ä¸ªæ–¹æ³•ä»¥åŠè¯»å–æ•°æ®çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¯´æœ‰æ–¹æ³•åéƒ½ä»¥â€œsetâ€æˆ–â€œgetâ€å¼€å§‹ï¼Œæ°”å€™è·Ÿéšè¿™å¯¹åº”æ•°æ®ç±»å‹çš„ç¼©å†™,ä¾‹å¦‚æ“ä½œint8æˆ–unit8ç±»å‹çš„è¯»å–/å†™å…¥æ–¹æ³•ï¼š<br>â€œgetâ€æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šå¼€å§‹è¿›è¡Œè¯»å–çš„å­—èŠ‚åç§»é‡ã€ä»¥åŠä¸€ä¸ªå¯é€‰çš„å¸ƒå°”å€¼ï¼Œåè€…ç”¨äºæŒ‡å®šè¯»å–çš„å€¼æ˜¯å¦é‡‡ç”¨ä½å­—èŠ‚ä¼˜å…ˆæ–¹å¼ï¼ˆæ³¨ï¼šé»˜è®¤å€¼ä¸º false ï¼‰ã€‚â€œsetâ€æ–¹æ³•åˆ™æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šå¼€å§‹è¿›è¡Œå†™å…¥çš„å­—èŠ‚åç§»é‡ã€éœ€è¦å†™å…¥çš„æ•°æ®å€¼ã€ä»¥åŠä¸€ä¸ªå¯é€‰çš„å¸ƒå°”å€¼ç”¨äºæŒ‡å®šæ˜¯å¦é‡‡ç”¨ä½å­—èŠ‚ä¼˜å…ˆæ–¹å¼å­˜å‚¨æ•°æ®ã€‚<br>**<br>getInt8(byteOffset,littleEndian): ä»byteOffsetå¤„å¼€å§‹è¯»å–ä¸€ä¸ªint8å€¼ï¼›<br>setInt8(byteOffset, value, littleEndian): ä»byteOffsetå¤„å¼€å§‹å†™å…¥ä¸€ä¸ªint8å€¼ï¼›<br>**<br><strong>è¯‘æ³¨ï¼šä½å­—èŠ‚ä¼˜å…ˆï¼ˆLittle-endianï¼‰ä¹Ÿè¢«ç¿»è¯‘ä½œâ€œå°ç«¯å­—èŠ‚åºâ€ï¼ŒæŒ‡çš„æ˜¯åœ¨å­˜å‚¨æ•°æ®çš„å¤šä¸ªå†…å­˜å­—èŠ‚ä¸­ï¼Œç¬¬ä¸€ä¸ªå†…å­˜å­—èŠ‚å­˜å‚¨ç€æ•°æ®çš„æœ€ä½å­—èŠ‚æ•°æ®ï¼Œè€Œæœ€åä¸€ä¸ªå†…å­˜å­—èŠ‚å­˜å‚¨ç€æœ€é«˜å­—èŠ‚æ•°æ®ã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">2</span>),</span><br><span class="line">view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer);</span><br><span class="line">view.setInt8(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">view.setInt8(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(view.getInt8(<span class="number">0</span>)); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(view.getInt8(<span class="number">1</span>)); <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>

<p>è§†å›¾å…è®¸ä½ ä½¿ç”¨ä»»æ„æ ¼å¼å¯¹ä»»æ„ä½ç½®è¿›è¡Œè¯»å†™ï¼Œè€Œæ— é¡»è€ƒè™‘è¿™äº›æ•°æ®æ­¤å‰æ˜¯ä½¿ç”¨ä»€ä¹ˆæ ¼å¼å­˜å‚¨çš„</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer)</span><br><span class="line">view.setInt8(<span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">view.setInt8(<span class="number">1</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="built_in">console</span>.log(view.getInt16(<span class="number">0</span>))</span><br><span class="line"><span class="built_in">console</span>.log(view.getInt8(<span class="number">0</span>))</span><br><span class="line"><span class="built_in">console</span>.log(view.getInt8(<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>åœ¨æ··ç”¨ä¸åŒçš„æ•°æ®ç±»å‹æ—¶ï¼Œä½¿ç”¨DataViewå¯¹è±¡æ˜¯ä¸€ç§å®Œç¾æ–¹å¼ï¼Œä¸è¿‡ï¼Œè‹¥å°½äº«ä½¿ç”¨ç‰¹å®šçš„ä¸€ç§æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆç‰¹å®šç±»å‹è¯•å›¾ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<p>ç±»å‹åŒ–æ•°ç»„å³ä¸ºè§†å›¾</p>
<p>å¼€å§‹æ—¶ï¼Œè¯¥æ•°ç»„ç¼“å†²åŒº 16 ä¸ªä½å‡ä¸º 0 ï¼›ä½¿ç”¨ setInt8() å‘ç¬¬ä¸€ä¸ªå­—èŠ‚å†™å…¥ 5 ä¹‹åï¼Œè¯¥å­—èŠ‚çš„å†…å®¹å°±å‡ºç°äº†ä¸€å¯¹ 1 ï¼ˆå› ä¸º 5 å¯ä»¥å†™ä¸º 8 ä½äºŒè¿›åˆ¶æ•° 00000101 ï¼‰ï¼›å‘ç¬¬äºŒä¸ªå­—èŠ‚å†™å…¥-1 ä¼šä½¿å¾—è¯¥å­—èŠ‚çš„æ‰€æœ‰ä½éƒ½å˜æˆ 1 ï¼ˆå³ -1 çš„äºŒè¿›åˆ¶è¡¥ç å½¢å¼ï¼‰ã€‚æ¥ä¸‹æ¥ä½¿ç”¨ getInt16() å°±èƒ½å°†å‰é¢å†™å…¥çš„ 16 ä½æ•°æ®ä»¥å•ä¸ª 16 ä½æ•´æ•°çš„æ–¹å¼è¯»å–å‡ºæ¥ï¼Œå…¶åè¿›åˆ¶å€¼å°±æ˜¯1535ã€‚<br>ES6 çš„ç±»å‹åŒ–æ•°ç»„å®é™…ä¸Šä¹Ÿæ˜¯é’ˆå¯¹æ•°ç»„ç¼“å†²åŒºçš„ç‰¹å®šç±»å‹è§†å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›æ•°ç»„å¯¹è±¡æ¥å¤„ç†ç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œè€Œä¸å¿…ä½¿ç”¨é€šç”¨çš„ DataView å¯¹è±¡ã€‚ä¸€å…±å­˜åœ¨å…«ç§ç‰¹å®šç±»å‹è§†å›¾ï¼Œå¯¹åº”ç€å…«ç§æ•°å€¼æ•°æ®ç±»å‹ï¼Œä¸ºå¤„ç† uint8 å€¼æä¾›äº†é¢å¤–çš„é€‰æ‹©ã€‚</p>
<p>æ„é€ å™¨åç§°                          å…ƒç´ å¤§å°<br>Int8Array                               1<br>Uint8Array                              1<br>Uint8ClampedArray                       1<br>Int16Array                              2<br>Uint16Array                             2<br>Int32Array                              4<br>Uint32Array                             4<br>Float32Array                            4<br>Float64Array                            8<br><strong>ç±»å‹åŒ–æ•°ç»„çš„æ„é€ å™¨å¯ä»¥æ¥å—å¤šç§ç±»å‹çš„å‚æ•°</strong>ï¼Œå› æ­¤å­˜åœ¨å‡ ç§åˆ›å»ºç±»å‹åŒ–æ•°ç»„çš„æ–¹å¼ã€‚<br>ç¬¬ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ä¸åˆ›å»º DataView æ—¶ç›¸åŒçš„å‚æ•°ï¼Œå³ï¼šä¸€ä¸ªæ•°ç»„ç¼“å†²åŒºã€ä¸€ä¸ªå¯é€‰çš„å­—èŠ‚åç§»é‡ã€ä»¥åŠä¸€ä¸ªå¯é€‰çš„å­—èŠ‚æ•°é‡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> view1 = <span class="keyword">new</span> <span class="built_in">Int8Array</span>(buffer)</span><br><span class="line"><span class="keyword">let</span> view2 = <span class="keyword">new</span> <span class="built_in">Int8Array</span>(buffer, <span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(view1.buffer === buffer)                    <span class="comment">//true               </span></span><br><span class="line"><span class="built_in">console</span>.log(view2.buffer === buffer)                    <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(view1.byteOffset)                           <span class="comment">//0</span></span><br><span class="line"><span class="built_in">console</span>.log(view2.byteOffset)                           <span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(view1.byteLength)                           <span class="comment">//10</span></span><br><span class="line"><span class="built_in">console</span>.log(view2.byteLength)                           <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä¼ é€’å•ä¸ªæ•°å€¼ç»™ç±»å‹åŒ–æ•°ç»„çš„æ„é€ å™¨ï¼Œ<strong>æ­¤æ•°å€¼è¡¨ç¤ºè¯¥æ•°ç»„åŒ…å«çš„å…ƒç´ æ•°é‡ï¼ˆè€Œä¸æ˜¯åˆ†é…çš„å­—èŠ‚æ•°ï¼‰</strong>ã€‚æ„é€ å™¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç¼“å†²åŒºï¼Œåˆ†é…æ­£ç¡®çš„å­—èŠ‚æ•°ä»¥ä¾¿å®¹çº³æŒ‡å®šæ•°é‡çš„æ•°ç»„å…ƒç´ ã€‚å¯ä»¥é€šè¿‡lengthå±æ€§æ¥è·å–è¿™ä¸ªå…ƒç´ æ•°é‡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> floats = <span class="keyword">new</span> <span class="built_in">Float32Array</span>(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ints.byteLength)</span><br><span class="line"><span class="built_in">console</span>.log(ints.length)</span><br><span class="line"><span class="built_in">console</span>.log(floats.byteLength)</span><br><span class="line"><span class="built_in">console</span>.log(floats.length)</span><br></pre></td></tr></table></figure>
<p><strong>å¦‚æœè°ƒç”¨ç±»å‹åŒ–æ•°ç»„æ„é€ å™¨æ—¶æ²¡æœ‰ä¼ å…¥å‚æ•°ï¼Œæ„é€ å™¨ä¼šè®¤ä¸ºä¼ å…¥äº† 0 ï¼Œè¿™ç§æ–¹å¼åˆ›å»ºçš„ç±»å‹åŒ–æ•°ç»„ä¸ä¼šè¢«åˆ†é…ä»»ä½•å­˜å‚¨ç©ºé—´ï¼Œå› æ­¤ä¹Ÿå°±ä¸èƒ½è¢«ç”¨äºä¿å­˜æ•°æ®ã€‚</strong><br>ç¬¬ä¸‰ç§æ–¹å¼æ˜¯å‘æ„é€ å™¨ä¼ é€’å•ä¸ªå¯¹è±¡å‚æ•°<br><strong>ç±»å‹åŒ–æ•°ç»„</strong>ï¼šæ•°ç»„æ‰€æœ‰å…ƒç´ éƒ½ä¼šè¢«å¤åˆ¶åˆ°æ–°çš„ç±»å‹åŒ–æ•°ç»„ä¸­ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä¼ é€’ä¸€ä¸ª int8ç±»å‹çš„æ•°ç»„ç»™ Int16Array æ„é€ å™¨ï¼Œè¿™äº› int8 çš„å€¼ä¼šè¢«å¤åˆ¶åˆ° int16 æ•°ç»„ä¸­ã€‚æ–°çš„ç±»å‹åŒ–æ•°ç»„ä¸åŸå…ˆçš„ç±»å‹åŒ–æ•°ç»„ä¼šä½¿ç”¨ä¸åŒçš„æ•°ç»„ç¼“å†²åŒºã€‚<br><strong>å¯è¿­ä»£å¯¹è±¡</strong>ï¼šè¯¥å¯¹è±¡çš„è¿­ä»£å™¨ä¼šè¢«è°ƒç”¨ä»¥ä¾¿å°†æ•°æ®æ’å…¥åˆ°ç±»å‹åŒ–æ•°ç»„ä¸­ã€‚å¦‚æœå…¶ä¸­åŒ…å«äº†ä¸åŒ¹é…è§†å›¾ç±»å‹çš„å€¼ï¼Œé‚£ä¹ˆæ„é€ å™¨å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚<br><strong>æ•°ç»„</strong>ï¼šè¯¥æ•°ç»„çš„å…ƒç´ ä¼šè¢«æ’å…¥åˆ°æ–°çš„ç±»å‹åŒ–æ•°ç»„ä¸­ã€‚å¦‚æœå…¶ä¸­åŒ…å«äº†ä¸åŒ¹é…è§†å›¾ç±»å‹çš„å€¼ï¼Œé‚£ä¹ˆæ„é€ å™¨å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚<br><strong>ç±»æ•°ç»„å¯¹è±¡</strong>ï¼šä¸ä¼ å…¥æ•°ç»„çš„è¡¨ç°ä¸€è‡´ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints1 = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]),</span><br><span class="line">ints2 = <span class="keyword">new</span> <span class="built_in">Int32Array</span>(ints1);</span><br><span class="line"><span class="built_in">console</span>.log(ints1.buffer === ints2.buffer); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(ints1.byteLength); <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">console</span>.log(ints1.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(ints1[<span class="number">0</span>]); <span class="comment">// 25</span></span><br><span class="line"><span class="built_in">console</span>.log(ints1[<span class="number">1</span>]); <span class="comment">// 50</span></span><br><span class="line"><span class="built_in">console</span>.log(ints2.byteLength); <span class="comment">// 8</span></span><br><span class="line"><span class="built_in">console</span>.log(ints2.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(ints2[<span class="number">0</span>]); <span class="comment">// 25</span></span><br><span class="line"><span class="built_in">console</span>.log(ints2[<span class="number">1</span>]); <span class="comment">// 50</span></span><br></pre></td></tr></table></figure>
<h3 id="ç±»å‹åŒ–æ•°ç»„ä¸å¸¸è§„æ•°ç»„çš„ç›¸ä¼¼ç‚¹"><a href="#ç±»å‹åŒ–æ•°ç»„ä¸å¸¸è§„æ•°ç»„çš„ç›¸ä¼¼ç‚¹" class="headerlink" title="ç±»å‹åŒ–æ•°ç»„ä¸å¸¸è§„æ•°ç»„çš„ç›¸ä¼¼ç‚¹"></a>ç±»å‹åŒ–æ•°ç»„ä¸å¸¸è§„æ•°ç»„çš„ç›¸ä¼¼ç‚¹</h3><p>ç±»å‹åŒ–æ•°ç»„ä¸å¸¸è§„æ•°ç»„æœ‰å¥½å‡ ä¸ªç›¸ä¼¼ç‚¹ï¼Œç±»å‹åŒ–æ•°ç»„åœ¨å¾ˆå¤šåœºæ™¯ä¸­éƒ½å¯ä»¥åƒå¸¸è§„æ•°ç»„é‚£æ ·è¢«ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨lengthå±æ€§æ¥è·å–ç±»å‹åŒ–æ•°ç»„åŒ…å«çš„å…ƒç´ æ•°é‡ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ•°å€¼ç±»å‹çš„ç´¢å¼•å€¼æ¥ç›´æ¥è®¿é—®ç±»å‹åŒ–æ•°ç»„çš„å…ƒç´ ã€‚<br><strong>ä¸å¸¸è§„æ•°ç»„ä¸åŒçš„æ˜¯ï¼Œä½ ä¸èƒ½ä½¿ç”¨ length å±æ€§æ¥æ”¹å˜ç±»å‹åŒ–æ•°ç»„çš„å¤§å°ã€‚è¯¥å±æ€§æ˜¯ä¸å¯å†™çš„ï¼Œåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹å†™å…¥æ“ä½œä¼šè¢«å¿½ç•¥ï¼Œè€Œä¸¥æ ¼æ¨¡å¼ä¸‹åˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚</strong><br>ç±»å‹åŒ–æ•°ç»„ä¹Ÿæ‹¥æœ‰å¤§é‡ä¸å¸¸è§„æ•°ç»„ç­‰æ•ˆçš„æ–¹æ³•ï¼Œä½ å¯ä»¥å¯¹ç±»å‹åŒ–æ•°ç»„ä½¿ç”¨ä¸‹åˆ—è¿™äº›æ–¹æ³•ï¼š<br>copyWithin()ã€entries()ã€fill()ã€filter()ã€find()ã€findIndex()ã€forEach()ã€indexOf()ã€join()ã€keys()ã€lastIndexOf()ã€map()ã€reduce()ã€reduceRight()ã€reverse()ã€slice()ã€some()ã€sort()ã€values()<br><strong>æ³¨æ„</strong>è™½ç„¶è¿™äº›æ–¹æ³•çš„è¡¨ç°ä¸æ•°ç»„åŸå‹ä¸Šçš„å¯¹åº”æ–¹æ³•ç›¸ä¼¼ï¼Œä½†å®ƒä»¬å¹¶ä¸å®Œå…¨ç›¸åŒã€‚ç±»å‹åŒ–æ•°ç»„çš„æ–¹æ³•ä¼šè¿›è¡Œé¢å¤–çš„ç±»å‹æ£€æŸ¥ä»¥ç¡®ä¿å®‰å…¨ï¼Œå¹¶ä¸”è¿”å›å€¼ä¼šæ˜¯æŸç§ç±»å‹åŒ–æ•°ç»„ï¼Œè€Œä¸æ˜¯å¸¸è§„æ•°ç»„ï¼ˆå½’ç»“äº Symbol.species å±æ€§ï¼‰ã€‚è¿™é‡Œæœ‰ä¸ªä¾‹å­ç”¨äºæ¼”ç¤ºå…¶ä¸­çš„åŒºåˆ«ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]),</span><br><span class="line">mapped = ints.map(<span class="function"><span class="params">v</span> =&gt;</span> v * <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(mapped.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(mapped[<span class="number">0</span>]); <span class="comment">// 50</span></span><br><span class="line"><span class="built_in">console</span>.log(mapped[<span class="number">1</span>]); <span class="comment">// 100</span></span><br><span class="line"><span class="built_in">console</span>.log(mapped <span class="keyword">instanceof</span> <span class="built_in">Int16Array</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>**ç›¸åŒçš„è¿­ä»£å™¨<br>ä¸å¸¸è§„æ•°ç»„ç›¸åŒï¼Œç±»å‹åŒ–æ•°ç»„ä¹Ÿæ‹¥æœ‰ä¸‰ä¸ªè¿­ä»£å™¨ï¼Œå®ƒä»¬æ˜¯ entries() æ–¹æ³•ã€ keys() æ–¹æ³•ä¸values() æ–¹æ³•ã€‚è¿™å°±æ„å‘³ç€ä½ å¯ä»¥å¯¹ç±»å‹åŒ–æ•°ç»„ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œæˆ–è€…å¯¹å…¶ä½¿ç”¨for-of å¾ªç¯ï¼Œå°±åƒå¯¹å¾…å¸¸è§„æ•°ç»„</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]),</span><br><span class="line">intsArray = [...ints];</span><br><span class="line"><span class="built_in">console</span>.log(intsArray <span class="keyword">instanceof</span> <span class="built_in">Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(intsArray[<span class="number">0</span>]); <span class="comment">// 25</span></span><br><span class="line"><span class="built_in">console</span>.log(intsArray[<span class="number">1</span>]); <span class="comment">// 50</span></span><br></pre></td></tr></table></figure>
<p>of()å’Œfrom()æ–¹æ³•<br>æ‰€æœ‰çš„ç±»å‹åŒ–æ•°ç»„éƒ½åŒ…å«é™æ€çš„ of() ä¸ from() æ–¹æ³•ï¼Œä½œç”¨ç±»ä¼¼äº Array.of() ä¸Array.from() æ–¹æ³•ã€‚å…¶ä¸­çš„åŒºåˆ«æ˜¯ç±»å‹åŒ–æ•°ç»„çš„ç‰ˆæœ¬ä¼šè¿”å›ç±»å‹åŒ–æ•°ç»„ï¼Œè€Œä¸è¿”å›å¸¸è§„æ•°ç»„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="built_in">Int16Array</span>.of(<span class="number">25</span>, <span class="number">50</span>),</span><br><span class="line">floats = <span class="built_in">Float32Array</span>.from([<span class="number">1.5</span>, <span class="number">2.5</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(ints <span class="keyword">instanceof</span> <span class="built_in">Int16Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(floats <span class="keyword">instanceof</span> <span class="built_in">Float32Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(ints.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(ints[<span class="number">0</span>]); <span class="comment">// 25</span></span><br><span class="line"><span class="built_in">console</span>.log(ints[<span class="number">1</span>]); <span class="comment">// 50</span></span><br><span class="line"><span class="built_in">console</span>.log(floats.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(floats[<span class="number">0</span>]); <span class="comment">// 1.5</span></span><br><span class="line"><span class="built_in">console</span>.log(floats[<span class="number">1</span>]); <span class="comment">// 2.5</span></span><br></pre></td></tr></table></figure>
<p>ç±»å‹åŒ–æ•°ç»„ä¸å¸¸è§„æ•°ç»„çš„åŒºåˆ«</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(ints <span class="keyword">instanceof</span> <span class="built_in">Array</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(ints)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p><strong>è¡Œä¸ºå·®å¼‚<br>**å¸¸è§„æ•°ç»„å¯ä»¥è¢«ä¼¸å±•æˆ–æ˜¯æ”¶ç¼©ï¼Œç„¶è€Œç±»å‹åŒ–æ•°ç»„å´ä¼šå§‹ç»ˆä¿æŒè‡ªèº«å¤§å°ä¸å˜ã€‚ä½ å¯ä»¥å¯¹å¸¸è§„æ•°ç»„ä¸€ä¸ªä¸å­˜åœ¨çš„ç´¢å¼•ä½ç½®è¿›è¡Œèµ‹å€¼ï¼Œä½†åœ¨ç±»å‹åŒ–æ•°ç»„ä¸Šè¿™ä¹ˆåšåˆ™ä¼šè¢«å¿½ç•¥ã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(ints.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(ints[<span class="number">0</span>]); <span class="comment">// 25</span></span><br><span class="line"><span class="built_in">console</span>.log(ints[<span class="number">1</span>]); <span class="comment">// 50</span></span><br><span class="line">ints[<span class="number">2</span>] = <span class="number">5</span>;</span><br><span class="line"><span class="built_in">console</span>.log(ints.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(ints[<span class="number">2</span>]); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>ç±»å‹åŒ–æ•°ç»„ä¹Ÿä¼šå¯¹æ•°æ®ç±»å‹è¿›è¡Œæ£€æŸ¥ä»¥ä¿è¯åªä½¿ç”¨æœ‰æ•ˆçš„å€¼ï¼Œå½“æ— æ•ˆçš„å€¼è¢«ä¼ å…¥æ—¶ï¼Œå°†ä¼šè¢«æ›¿æ¢ä¸º0</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="string">"hi"</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(ints.length); <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(ints[<span class="number">0</span>]); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<p>æ‰€æœ‰åœ¨ç±»å‹åŒ–æ•°ç»„ä¸Šä¿®æ”¹é¡¹ç›®å€¼çš„æ–¹æ³•éƒ½ä¼šå—åˆ°ç›¸åŒçš„é™åˆ¶ï¼Œä¾‹å¦‚å½“ map() æ–¹æ³•ä½¿ç”¨çš„æ˜ å°„å‡½æ•°è¿”å›ä¸€ä¸ªæ— æ•ˆå€¼çš„æ—¶å€™ï¼Œç±»å‹åŒ–æ•°ç»„ä¼šä½¿ç”¨ 0 æ¥ä»£æ›¿è¿”å›å€¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>]),</span><br><span class="line">mapped = ints.map(<span class="function"><span class="params">v</span> =&gt;</span> <span class="string">"hi"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(mapped.length); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(mapped[<span class="number">0</span>]); <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(mapped[<span class="number">1</span>]); <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(mapped <span class="keyword">instanceof</span> <span class="built_in">Int16Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(mapped <span class="keyword">instanceof</span> <span class="built_in">Array</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>å°½ç®¡ç±»å‹åŒ–æ•°ç»„æ‹¥æœ‰å¸¸è§„æ•°ç»„çš„å¾ˆå¤šåŒåæ–¹æ³•ï¼Œä½†ä»ç„¶ç¼ºå°‘äº†å‡ ä¸ªæ•°ç»„æ–¹æ³•ï¼ŒåŒ…æ‹¬ä¸‹åˆ—è¿™äº›ï¼š<br>concat()ã€pop()ã€push()ã€shift()ã€splice()ã€unshift()<br>é™¤äº† concat() æ–¹æ³•ä¹‹å¤–ï¼Œè¯¥åˆ—è¡¨ä¸­çš„å…¶ä½™æ–¹æ³•éƒ½ä¼šæ”¹å˜æ•°ç»„çš„å¤§å°ï¼Œè€Œç”±äºç±»å‹åŒ–æ•°ç»„çš„å¤§å°ä¸å¯å˜ï¼Œå› æ­¤è¿™äº›æ–¹æ³•éƒ½ä¸èƒ½ä½œç”¨äºç±»å‹åŒ–æ•°ç»„ã€‚ concat() æ–¹æ³•ä¸å¯ç”¨çš„åŸå› åˆ™æ˜¯ï¼šè¿æ¥ä¸¤ä¸ªç±»å‹åŒ–æ•°ç»„çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ï¼ˆç‰¹åˆ«æ˜¯å½“å®ƒä»¬å¤„ç†çš„æ•°æ®ç±»å‹ä¸åŒæ—¶ï¼‰ï¼Œè¿™ç§ä¸ç¡®å®šæƒ…å†µåŸæœ¬å°±ä¸åº”å½“ä½¿ç”¨ç±»å‹åŒ–æ•°ç»„ã€‚</p>
<p>**é™„åŠ çš„æ–¹æ³•<br>ç±»å‹åŒ–æ•°ç»„è¿˜æœ‰ä¸¤ä¸ªå¸¸è§„æ•°ç»„æ‰€ä¸å…·å¤‡çš„æ–¹æ³•ï¼š set() æ–¹æ³•ä¸ subarray() æ–¹æ³•ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•ä½œç”¨ç›¸åï¼š set() æ–¹æ³•ä»å¦ä¸€ä¸ªæ•°ç»„ä¸­å¤åˆ¶å…ƒç´ åˆ°å½“å‰çš„ç±»å‹åŒ–æ•°ç»„ï¼Œè€Œsubarray() æ–¹æ³•åˆ™æ˜¯å°†å½“å‰ç±»å‹åŒ–æ•°ç»„çš„ä¸€éƒ¨åˆ†æå–ä¸ºæ–°çš„ç±»å‹åŒ–æ•°ç»„ã€‚<br>set() æ–¹æ³•æ¥å—ä¸€ä¸ªæ•°ç»„å‚æ•°ï¼ˆæ— è®ºæ˜¯ç±»å‹åŒ–çš„è¿˜æ˜¯å¸¸è§„çš„ï¼‰ã€ä»¥åŠä¸€ä¸ªå¯é€‰çš„åç§»é‡å‚æ•°ï¼Œåè€…æŒ‡ç¤ºäº†ä»ä»€ä¹ˆä½ç½®å¼€å§‹æ’å…¥æ•°æ®ï¼ˆé»˜è®¤å€¼ä¸º 0 ï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>(<span class="number">4</span>);</span><br><span class="line">ints.set([<span class="number">25</span>, <span class="number">50</span>]);</span><br><span class="line">ints.set([<span class="number">75</span>, <span class="number">100</span>], <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(ints.toString()); <span class="comment">// 25,50,75,100</span></span><br></pre></td></tr></table></figure>
<p>subarray() æ–¹æ³•æ¥å—ä¸€ä¸ªå¯é€‰çš„å¼€å§‹ä½ç½®ç´¢å¼•å‚æ•°ã€ä»¥åŠä¸€ä¸ªå¯é€‰çš„ç»“æŸä½ç½®ç´¢å¼•å‚æ•°ï¼ˆåƒslice() æ–¹æ³•ä¸€æ ·ï¼Œç»“æŸä½ç½®çš„å…ƒç´ ä¸ä¼šè¢«åŒ…å«åœ¨ç»“æœä¸­ï¼‰ï¼Œå¹¶ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ç±»å‹åŒ–æ•°ç»„ã€‚ä½ å¯ä»¥åŒæ—¶çœç•¥è¿™ä¸¤ä¸ªå‚æ•°ï¼Œä»è€Œåˆ›å»ºåŸç±»å‹åŒ–æ•°ç»„çš„ä¸€ä¸ªå¤åˆ¶å“ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ints = <span class="keyword">new</span> <span class="built_in">Int16Array</span>([<span class="number">25</span>, <span class="number">50</span>, <span class="number">75</span>, <span class="number">100</span>]),</span><br><span class="line">subints1 = ints.subarray(),</span><br><span class="line">subints2 = ints.subarray(<span class="number">2</span>),</span><br><span class="line">subints3 = ints.subarray(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(subints1.toString()); <span class="comment">// 25,50,75,100</span></span><br><span class="line"><span class="built_in">console</span>.log(subints2.toString()); <span class="comment">// 75,100</span></span><br><span class="line"><span class="built_in">console</span>.log(subints3.toString()); <span class="comment">// 50,75</span></span><br></pre></td></tr></table></figure>



<p><img src="https://ningning-1259809020.cos.ap-chengdu.myqcloud.com/%E5%8E%9F%E5%9E%8B%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E4%B8%8E%E5%AE%9E%E4%BE%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB.png" alt="attr"></p>
<p>ä¸Šå›¾ä¸­å±•ç¤ºäº†Personæ„é€ å‡½æ•°ã€Personçš„åŸå‹å±æ€§ä»¥åŠPersonç°æœ‰çš„ä¸¤ä¸ªå®ä¾‹ä¹‹é—´çš„å…³ç³»ï¼Œç”±äºæ‰€æœ‰å®ç°ä¸­éƒ½æ— æ³•è®¿é—®åˆ°[[Prototype]]ï¼Œå› æ­¤å¯ä»¥é€šè¿‡isPrototypeOf()ç¡®å®šå¯¹è±¡å¯¹è±¡é—´æ˜¯å¦å­˜åœ¨è¿™ç§å…³ç³»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 11:26:13 / Modified: 11:28:26" itemprop="dateCreated datePublished" datetime="2020-04-26T11:26:13+08:00">2020-04-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">JavaScripté«˜çº§ç¨‹åºè®¾è®¡</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>å¼•ç”¨ç±»å‹çš„å€¼ï¼ˆå¯¹è±¡ï¼‰æ˜¯å¼•ç”¨ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ã€‚</strong>åœ¨ECMAScriptä¸­ï¼Œå¼•ç”¨ç±»å‹æ˜¯ä¸€ç§ä¹¦ç»“æ„ï¼Œç”¨äºå°†æ•°æ®å’ŒåŠŸèƒ½ç»„ç»‡åœ¨ä¸€èµ·ã€‚å°½ç®¡ECMAScriptä»æŠ€æœ¯ä¸Šè®²æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä½†ä»–ä¸å…·å¤‡ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€æ‰€æ”¯æŒçš„ç±»å’Œæ¥å£ç­‰åŸºæœ¬ç»“æ„ã€‚å¼•ç”¨ç±»å‹æœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä¸ºå¯¹è±¡å®šä¹‰ï¼Œå› ä¸ºå®ƒä»¬æè¿°çš„æ˜¯ä¸€ç±»å¯¹è±¡æ‰€å…·æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚<br>å¯¹è±¡æ˜¯æŸä¸ªç‰¹å®šå¼•ç”¨ç±»å‹çš„å®ä¾‹ã€‚æ–°å¯¹è±¡æ˜¯ä½¿ç”¨newæ“ä½œç¬¦åè·Ÿä¸€ä¸ªæ„é€ å‡½æ•°æ¥åˆ›å»ºçš„ï¼Œæ„é€ å‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåªä¸è¿‡è¯¥å‡½æ•°æ˜¯å‡ºäºåˆ›å»ºæ–°å¯¹è±¡çš„ç›®çš„è€Œå®šä¹‰çš„ã€‚</p>
<h2 id="Objectç±»å‹"><a href="#Objectç±»å‹" class="headerlink" title="Objectç±»å‹"></a>Objectç±»å‹</h2><p>è™½ç„¶Objectçš„å®ä¾‹ä¸å…·å¤‡å¤šå°‘åŠŸèƒ½ï¼Œä½†å¯¹äºåœ¨åº”ç”¨ç¨‹åºä¸­å­˜å‚¨å’Œä¼ è¾“æ•°æ®è€Œè¨€ï¼Œå®ƒä»¬ç¡®å®æ˜¯éå¸¸ç†æƒ³çš„é€‰æ‹©ã€‚<br>åˆ›å»ºObjectå®ä¾‹çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯ä½¿ç”¨newæ“ä½œç¬¦åè·ŸObjectæ„é€ å‡½æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">person.name = <span class="string">"Nicholas"</span></span><br><span class="line">person.age = <span class="number">19</span></span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨<strong>å¯¹è±¡å­—é¢é‡</strong>è¡¨ç¤ºæ³•ï¼Œå¯¹è±¡iå­—é¢é‡æ˜¯å¯¹è±¡å®šä¹‰çš„ä¸€ç§ç®€å†™å½¢å¼ï¼Œç›®çš„åœ¨äºç®€åŒ–åˆ›å»ºåŒ…å«å¤§é‡å±æ€§çš„å¯¹è±¡çš„è¿‡ç¨‹ã€‚å…¶ä¸­ï¼Œå±æ€§åä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">"Nicholas"</span>,</span><br><span class="line">    age: <span class="number">19</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = &#123;&#125;</span><br><span class="line">person.name = <span class="string">"Nicholas"</span>,</span><br><span class="line">person.age = <span class="number">19</span></span><br></pre></td></tr></table></figure>
<p>å¯¹è±¡çš„å±æ€§å¯ä»¥é€šè¿‡ç‚¹è¡¨ç¤ºæ³•å’Œæ–¹æ‹¬å·æ³•è¿›è¡Œè®¿é—®ï¼Œä»åŠŸèƒ½ä¸Šçœ‹ä¸¤è€…æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œä½†æ–¹æ‹¬å·è¯­æ³•çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å¯ä»¥é€šè¿‡å˜é‡æ¥è®¿é—®å±æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">person = &#123;</span><br><span class="line">    name: <span class="string">'daming'</span>,</span><br><span class="line">    age: <span class="number">13</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> personName = <span class="string">'name'</span></span><br><span class="line"><span class="built_in">console</span>.log(person.name)</span><br><span class="line"><span class="built_in">console</span>.log(person[personName])</span><br></pre></td></tr></table></figure>
<h2 id="ç†è§£å¯¹è±¡"><a href="#ç†è§£å¯¹è±¡" class="headerlink" title="ç†è§£å¯¹è±¡"></a>ç†è§£å¯¹è±¡</h2><p>ECMA-262åœ¨å®šä¹‰åªæœ‰å†…éƒ¨æ‰èƒ½ç”¨çš„ç‰¹æ€§(attribute)æ—¶ï¼Œæè¿°äº†å±æ€§(property)çš„å„ç§ç‰¹å¾ã€‚è¿™äº›ç‰¹æ€§æ˜¯ä¸ºäº†å®ç°JavaScriptå¼•æ“ç”¨çš„ï¼Œå› æ­¤åœ¨JavaScriptä¸­ä¸èƒ½ç›´æ¥è®¿é—®å®ƒä»¬ã€‚ä¸ºäº†è¡¨ç¤ºç‰¹æ€§æ˜¯å†…éƒ¨å€¼ï¼Œè¯¥è§„èŒƒæŠŠä»–ä»¬æ”¾åœ¨äº†ä¸¤å¯¹æ–¹æ‹¬å·ä¸­ï¼Œä¾‹å¦‚[[Enumerable]]ã€‚<br>å¯¹è±¡æœ‰ä¸¤ç§å±æ€§ï¼Œæ•°æ®å±æ€§å’Œè®¿é—®å™¨å±æ€§</p>
<h3 id="æ•°æ®å±æ€§"><a href="#æ•°æ®å±æ€§" class="headerlink" title="æ•°æ®å±æ€§"></a>æ•°æ®å±æ€§</h3><p>æ•°æ®å±æ€§åŒ…å«ä¸€ä¸ªæ•°æ®å€¼çš„ä½ç½®ï¼Œåœ¨è¿™ä¸ªä½ç½®å¯ä»¥è¯»å–å’Œå†™å…¥å€¼ï¼Œæ•°æ®å±æ€§æœ‰4ä¸ªæè¿°å…¶è¡Œä¸ºçš„ç‰¹æ€§ï¼š<br>1.[[Configurable]]:è¡¨ç¤ºèƒ½å¦é€šè¿‡deleteåˆ é™¤å±æ€§ä»è€Œé‡æ–°å®šä¹‰å±æ€§ï¼Œèƒ½å¦ä¿®æ”¹å±æ€§çš„ç‰¹æ€§ï¼Œæˆ–è€…èƒ½å¦æŠŠå±æ€§ä¿®æ”¹ä¸ºè®¿é—®å™¨å±æ€§ã€‚åƒå‰é¢ä¾‹å­ä¸­é‚£æ ·ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œå®ƒä»¬çš„è¿™ä¸ªç‰¹æ€§é»˜è®¤å€¼ä¸ºtrueã€‚<br>2.[[Enumerable]]:è¡¨ç¤ºèƒ½å¦é€šè¿‡for-inå¾ªç¯è¿”å›å±æ€§ã€‚åƒå‰é¢ä¾‹å­ä¸­é‚£æ ·ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œå®ƒä»¬çš„è¿™ä¸ªç‰¹æ€§é»˜è®¤å€¼ä¸ºtrueï¼›<br>3.[[Writable]]:è¡¨ç¤ºèƒ½å¦ä¿®æ”¹å±æ€§çš„å€¼ï¼Œåƒå‰é¢ç¦»éœ‡ä¸­é‚£æ ·ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œå®ƒä»¬çš„è¿™ä¸ªç‰¹æ€§é»˜è®¤ä¸ºtrueï¼›<br>4.[[Value]]:åŒ…å«è¿™ä¸ªå±æ€§çš„æ•°æ®å€¼ã€‚è¯»å–å±æ€§å€¼çš„æ—¶å€™ï¼Œä»è¿™ä¸ªä½ç½®è¯»ï¼›å†™å…¥å±æ€§æ—¶ï¼ŒæŠŠæ–°å€¼ä¿å­˜åœ¨è¿™ä¸ªä½ç½®ã€‚è¿™ä¸ªç‰¹æ€§çš„é»˜è®¤å€¼ä¸ºundefinedã€‚<br>å¯¹äºå‰é¢ä¾‹å­ä¸­é‚£æ ·ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œå®ƒä»¬çš„[[Configurable]]ã€[[Enumerable]]ã€[[Writable]]ç‰¹æ€§éƒ½è¢«è®¾ç½®ä¸ºtrueï¼Œè€Œ[[Value]]ç‰¹æ€§è¢«è®¾ç½®ä¸ºæŒ‡å®šçš„å€¼<br>è¦ä¿®æ”¹å±æ€§é»˜è®¤çš„ç‰¹æ€§ï¼Œå¿…é¡»ä½¿ç”¨Object.defineProperty()æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šå±æ€§æ‰€åœ¨çš„å¯¹è±¡ï¼Œå±æ€§çš„åå­—å’Œä¸€ä¸ªæè¿°ç¬¦å¯¹è±¡ã€‚å…¶ä¸­ï¼Œæè¿°ç¬¦ï¼ˆdescriptorï¼‰å¯¹è±¡çš„å±æ€§å¿…é¡»æ˜¯ï¼šconfigurableï¼Œenumerableï¼Œwritableï¼Œvalueã€‚è®¾ç½®å…¶ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ï¼Œå¯ä»¥ä¿®æ”¹å¯¹åº”çš„ç‰¹æ€§å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(person, <span class="string">"name"</span>, &#123;</span><br><span class="line">    writable: <span class="literal">false</span>,</span><br><span class="line">    value: <span class="string">"Nicholas"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(person.name) <span class="comment">//Nicholas</span></span><br><span class="line">person.name = <span class="string">"daming"</span></span><br><span class="line"><span class="built_in">console</span>.log(person.name) <span class="comment">//Nicholas</span></span><br></pre></td></tr></table></figure>
<p>å½“writableä¸ºfalseæ—¶ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹èµ‹å€¼æ“ä½œå°†æŠ›å‡ºé”™è¯¯ï¼Œåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹å°†è¢«å¿½ç•¥ï¼Œè¿™ä¸ªè§„åˆ™é€‚ç”¨äºâ€configurable: falseâ€æƒ…å†µä¸‹ã€‚åŒæ—¶å½“æŠŠå±æ€§å®šä¹‰ä¸ºä¸å¯é…ç½®çš„ï¼Œå°±<strong>ä¸èƒ½</strong>æŠŠå®ƒåœ¨å˜å›å¯é…ç½®çš„ã€‚æ­¤æ—¶å†è°ƒç”¨Object.defineProperty()æ–¹æ³•ä¿®æ”¹é™¤writableä¹‹å¤–çš„ç‰¹æ€§ï¼Œéƒ½ä¼šå¯¼è‡´é”™è¯¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(person, <span class="string">"name"</span>, &#123;</span><br><span class="line">    configureble: <span class="literal">false</span>,</span><br><span class="line">    value: <span class="string">"Nicholas"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//ä¸€ä¸‹ä»£ç å°†å¯¼è‡´æŠ›å‡ºé”™è¯¯</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(person, <span class="string">"name"</span>, &#123;</span><br><span class="line">    configurable: ture,</span><br><span class="line">    value: <span class="string">"Nicholas"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="è®¿é—®å™¨å±æ€§"><a href="#è®¿é—®å™¨å±æ€§" class="headerlink" title="è®¿é—®å™¨å±æ€§"></a>è®¿é—®å™¨å±æ€§</h3><p><strong>è®¿é—®å™¨å±æ€§ä¸åŒ…å«æ•°æ®å€¼</strong>ï¼Œå®ƒä»¬åŒ…å«ä¸€å¯¹getterå’Œsetterå‡½æ•°ï¼ˆè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¸æ˜¯å¿…é¡»çš„ï¼‰ã€‚åœ¨è¯»å–è®¿é—®å™¨å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨getterå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£è¿”å›æœ‰æ•ˆçš„å€¼ï¼›åœ¨å†™å…¥è®¿é—®å™¨å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨setterå‡½æ•°ï¼Œå¹¶ä¼ å…¥æ–°å€¼ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£å†³å®šå¦‚ä½•å¤„ç†æ•°æ®ã€‚è®¿é—®å™¨å±æ€§æœ‰å¦‚ä¸‹4ä¸ªç‰¹æ€§ï¼š<br>[[Configurable]]: è¡¨ç¤ºèƒ½å¦é€šè¿‡deleteåˆ é™¤ä»è€Œé‡æ–°å®šä¹‰å±æ€§ï¼Œèƒ½å¦ä¿®æ”¹å±æ€§çš„ç‰¹æ€§ï¼Œæˆ–è€…èƒ½å¦æŠŠå±æ€§ä¿®æ”¹ä¸ºæ•°æ®å±æ€§ï¼Œå¯¹äºç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œåˆæ ¼ç‰¹æ€§çš„é»˜è®¤å€¼ä¸ºtrue<br>[[Enumerable]]ï¼šè¡¨ç¤ºèƒ½å¦é€šè¿‡for-inå¾ªç¯è¿”å›å±æ€§ã€‚å¯¹äºç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œè¿™ä¸ªç‰¹æ€§çš„é»˜è®¤å€¼ä¸ºtrueã€‚<br>[[Get]]ï¼šåœ¨è¯»å–å±æ€§æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚é»˜è®¤å€¼ä¸ºundefined<br>[[Set]]ï¼šå†å†™å…¥å±æ€§æ—¶ã€‚é»˜è®¤å€¼ä¸ºundefined<br>è®¿é—®å™¨å±æ€§ä¸èƒ½ç›´æ¥å®šä¹‰ï¼Œå¿…é¡»ä½¿ç”¨Object.defineProperty()æ¥å®šä¹‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> book = &#123;</span><br><span class="line">    _yera: <span class="number">2004</span>,</span><br><span class="line">    edition: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(book, <span class="string">"year"</span>, &#123;</span><br><span class="line">    <span class="keyword">get</span>: function() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._year</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>: function(newValue) &#123;</span><br><span class="line">        <span class="keyword">if</span> (newValue &gt; <span class="number">2004</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>._year = newValue</span><br><span class="line">            <span class="keyword">this</span>.edition += newValue - <span class="number">2004</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">book.year = <span class="number">2005</span>;</span><br><span class="line"><span class="built_in">console</span>.log(book.edition)   <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<p>_yearå‰çš„ä¸‹åˆ’çº¿æ˜¯ä¸€ç§å¸¸ç”¨çš„è®°å·ï¼Œç”¨äºè¡¨ç¤ºåªèƒ½é€šè¿‡å¯¹è±¡æ–¹æ³•è®¿é—®çš„å±æ€§ï¼›è€Œ<strong>è®¿é—®å™¨å±æ€§year</strong>åˆ™åŒ…å«ä¸€ä¸ªgetterå‡½æ•°å’Œä¸€ä¸ªsetterå‡½æ•°ã€‚getterå‡½æ•°è¿”å›_yearçš„å€¼ï¼Œsetterå‡½æ•°é€šè¿‡è®¡ç®—æ¥ç¡®å®šæ­£ç¡®çš„ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠŠyearå±æ€§ä¿®æ”¹ä¸º2005ä¼šå¯¼è‡´â€”â€”yearå˜ä¸º2005ï¼Œè€Œeditionå˜ä¸º2.è¿™æ˜¯ä½¿ç”¨è®¿é—®å™¨å±æ€§çš„å¸¸è§æ–¹å¼ï¼Œå³è®¾ç½®ä¸€ä¸ªå±æ€§çš„å€¼ä¼šå¯¼è‡´å…¶ä»–å±æ€§å‘ç”Ÿå˜åŒ–ã€‚<br>ä¸ä¸€å®šéè¦åŒæ—¶æŒ‡å®šgetterå’Œsetterã€‚åªæŒ‡å®šgetteræ„å‘³ç€å±æ€§æ˜¯ä¸èƒ½å†™ï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹å°è¯•å†™å…¥å±æ€§ä¼šè¢«å¿½ç•¥ï¼›åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå°è¯•å†™å…¥å€¼åˆ¶å®šäº†getterå‡½æ•°çš„å±æ€§ä¼šæŠ›å‡ºé”™è¯¯ã€‚ç±»ä¼¼çš„ï¼Œæ²¡æœ‰æŒ‡å®šgetterå‡½æ•°çš„å±æ€§ä¹Ÿä¸èƒ½è¯»ï¼Œå¦åˆ™åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šè¿”å›undefinedï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p>
<h3 id="å®šä¹‰å¤šä¸ªå±æ€§"><a href="#å®šä¹‰å¤šä¸ªå±æ€§" class="headerlink" title="å®šä¹‰å¤šä¸ªå±æ€§"></a>å®šä¹‰å¤šä¸ªå±æ€§</h3><p>ç”±äºä¸ºå¯¹è±¡å®šä¹‰å¤šä¸ªå±æ€§çš„å¯èƒ½æ€§å¾ˆå¤§ï¼ŒECMAScript 5 åˆå®šä¹‰äº†ä¸€ä¸ªObject.defineProperties()æ–¹æ³•ã€‚åˆ©ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡æè¿°ç¬¦ä¸€æ¬¡å®šä¹‰å¤šä¸ªå±æ€§ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå¯¹è±¡å‚æ•°ï¼šç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯è¦æ·»åŠ å’Œä¿®æ”¹å…¶å±æ€§çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå¯¹è±¡çš„å±æ€§ä¸ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸­è¦æ·»åŠ æˆ–ä¿®æ”¹çš„å±æ€§ä¸€ä¸€å¯¹åº”</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> book = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperties(book, &#123;</span><br><span class="line">    _year:&#123;</span><br><span class="line">        value: <span class="number">2004</span></span><br><span class="line">    &#125;,</span><br><span class="line">    edition: &#123;</span><br><span class="line">        value: <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    year: &#123;</span><br><span class="line">        <span class="keyword">get</span>: function() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._year</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>: function(newValue) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newValue &gt; <span class="number">2004</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>._year = newValue</span><br><span class="line">                <span class="keyword">this</span>.edition += newValue - <span class="number">2004</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="è¯»å–å±æ€§çš„ç‰¹æ€§"><a href="#è¯»å–å±æ€§çš„ç‰¹æ€§" class="headerlink" title="è¯»å–å±æ€§çš„ç‰¹æ€§"></a>è¯»å–å±æ€§çš„ç‰¹æ€§</h3><p>ä½¿ç”¨Object.definePropertyDescriptor()æ–¹æ³•ï¼Œå¯ä»¥å–å¾—ç»™å®šå±æ€§çš„æè¿°ç¬¦ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šå±æ€§æ‰€åœ¨çš„å¯¹è±¡å’Œå°§éƒ½åŒºå…¶æè¿°ç¬¦çš„å±æ€§åç§°ã€‚è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ˜¯è®¿é—®å™¨å±æ€§ï¼Œè¿™ä¸ªæ­Œå¯¹è±¡çš„å±æ€§åˆconfigurable, enumerable, get, setï¼›å¦‚æœæ˜¯æ•°æ®å±æ€§ï¼Œè¿™ä¸ªå¯¹è±¡çš„å±æ€§æœ‰configurable, enumerable, writable, value.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> book = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperities(book, &#123;</span><br><span class="line">    _year: &#123;</span><br><span class="line">        value: <span class="number">2004</span></span><br><span class="line">    &#125;,</span><br><span class="line">    edition: &#123;</span><br><span class="line">        value: <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    year: &#123;</span><br><span class="line">        <span class="keyword">get</span>: function() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._year</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>: function(newValue) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newValue &gt; <span class="number">2004</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>._year = newValue</span><br><span class="line">                <span class="keyword">this</span>.edition += newValue - <span class="number">2004</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(book, <span class="string">"_year"</span>)</span><br><span class="line"><span class="keyword">var</span> descriptor2 = <span class="built_in">Object</span>.getOwnPropertyDescriptor(book, <span class="string">"year"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(descriptor.value)</span><br><span class="line"><span class="built_in">console</span>.log(descriptor.configurable)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> descriptor.get)</span><br><span class="line"><span class="built_in">console</span>.log(descriptor2.value)</span><br><span class="line"><span class="built_in">console</span>.log(descriptor2.enumerable)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> descriptor2.get)</span><br></pre></td></tr></table></figure>
<p>åœ¨JavaScriptä¸­ï¼Œå¯ä»¥é’ˆå¯¹ä»»ä½•å¯¹è±¡ï¼ŒåŒ…æ‹¬DOMå’ŒBOMå¯¹è±¡ï¼Œä½¿ç”¨Object.getOwnPropertyDescriptor()æ–¹æ³•ã€‚</p>
<h2 id="åˆ›å»ºå¯¹è±¡"><a href="#åˆ›å»ºå¯¹è±¡" class="headerlink" title="åˆ›å»ºå¯¹è±¡"></a>åˆ›å»ºå¯¹è±¡</h2><p>è™½ç„¶Objectæ„é€ å‡½æ•°æˆ–å¯¹è±¡å­—é¢é‡éƒ½å¯ä»¥ç”¨æ¥åˆ›å»ºå•ä¸ªå¯¹è±¡ï¼Œä½†è¿™äº›æ–¹å¼æœ‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼šä½¿ç”¨åŒä¸€ä¸ªæ¥å£åˆ›å»ºå¾ˆå¤šå¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„é‡å¤ä»£ç ã€‚</p>
<h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><p>å·¥å‚æ¨¡å¼æ˜¯è½¯ä»¶å·¥ç¨‹é¢†åŸŸä¸€ç§å¹¿ä¸ºäººçŸ¥çš„è®¾è®¡æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æŠ½è±¡äº†åˆ›å»ºå…·ä½“å¯¹è±¡çš„è¿‡ç¨‹ã€‚è€ƒè™‘åˆ°åœ¨ECMAScriptä¸­æ— æ³•åˆ›å»ºç±»ï¼Œå¼€å‘äººå‘˜å°±å‘æ˜äº†ä¸€ç§å‡½æ•°ï¼Œç”¨å‡½æ•°æ¥å°è£…ä»¥ç‰¹å®šæ¥å£åˆ›å»ºå¯¹è±¡çš„ç»†èŠ‚ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    o.name = name</span><br><span class="line">    o.age = age</span><br><span class="line">    o.job = job</span><br><span class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = createPerson(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>)</span><br><span class="line"><span class="keyword">var</span> person2 = createPerson(<span class="string">"Greg"</span>, <span class="number">27</span>, <span class="string">"Doctor"</span>)</span><br></pre></td></tr></table></figure>
<p>å·¥å‚æ¨¡å¼è™½ç„¶è§£å†³äº†åˆ›å»ºå¤šä¸ªç›¸ä¼¼å¯¹è±¡çš„é—®é¢˜ï¼Œä½†å´æ²¡æœ‰è§£å†³å¯¹è±¡è¯†åˆ«é—®é¢˜ï¼ˆå³æ€æ ·çŸ¥é“ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ï¼‰ã€‚</p>
<h3 id="æ„é€ å‡½æ•°æ¨¡å¼"><a href="#æ„é€ å‡½æ•°æ¨¡å¼" class="headerlink" title="æ„é€ å‡½æ•°æ¨¡å¼"></a>æ„é€ å‡½æ•°æ¨¡å¼</h3><p>ECMAScriptä¸­çš„æ„é€ å‡½æ•°å¯ç”¨æ¥åˆ›å»ºç‰¹å®šç±»å‹çš„å¯¹è±¡ã€‚åƒObjectå’ŒArrayè¿™æ ·çš„åŸç”Ÿæ„é€ å‡½æ•°ï¼Œåœ¨è¿è¡Œæ—¶ä¼šè‡ªåŠ¨å‡ºç°åœ¨æ‰§è¡Œç¯å¢ƒä¸­ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œä»è€Œå®šä¹‰è‡ªå®šä¹‰å¯¹è±¡ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">"daming"</span>, <span class="number">13</span>, <span class="string">"SoftWare Engineer"</span>)</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">"xiaoming"</span>, <span class="number">11</span>, <span class="string">"student"</span>)</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„</strong>ï¼šè¦åˆ›å»ºPersonçš„æ–°å®ä¾‹ï¼Œå¿…é¡»ä½¿ç”¨newæ“ä½œç¬¦ï¼Œè¿™ç§æ–¹å¼è°ƒç”¨æ„é€ å‡½æ•°å®é™…ä¸Šä¼šç»å†ä»¥ä¸‹4ä¸ªæ­¥éª¤:<br>1.åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡<br>2.å°†æ„é€ å‡½æ•°çš„ç§Ÿç”¨ä¸èµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤thiså°±åªæƒ³äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰<br>3.æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰<br>4.è¿”å›æ–°å¯¹è±¡</p>
<p>åœ¨å‰é¢çš„ä¾‹å­æœ€åï¼Œperson1å’Œperson2åˆ†åˆ«ä¿å­˜ç€Personçš„ä¸€ä¸ªä¸åŒçš„å®ä¾‹ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªconstructorï¼ˆæ„é€ å‡½æ•°ï¼‰å±æ€§ï¼Œæ”¹å±æ€§æŒ‡å‘Personã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(person1.constructor === Person)    <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.constructor === Person)    <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>å¯¹è±¡çš„constructorå±æ€§æœ€åˆæ—¶ç”¨æ¥è¡¨ç¤ºå¯¹è±¡ç±»å‹çš„ã€‚ä½†æ˜¯ï¼Œæåˆ°æ£€æµ‹å¯¹è±¡ç±»å‹ï¼Œè¿˜æ˜¯instanceofæ›´å¯é ä¸€äº›ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(person1 <span class="keyword">instanceof</span> <span class="built_in">Object</span>)         <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person1 <span class="keyword">instanceof</span> Person)         <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°æ„å‘³ç€å°†æ¥å¯ä»¥å°†å®ƒçš„å®ä¾‹æ ‡è¯†ä¸ºä¸€ç§ç‰¹å®šçš„ç±»å‹ï¼›è€Œç€æ­£äº‹æ„é€ å‡½æ•°æ¨¡å¼èƒœè¿‡å·¥å‚æ¨¡å¼çš„åœ°æ–¹ã€‚<br><strong>ä»¥è¿™ç§æ–¹å¼å®šä¹‰çš„æ„é€ å‡½æ•°æ˜¯å®šä¹‰åœ¨Globalå¯¹è±¡ï¼ˆåœ¨æµè§ˆå™¨ä¸­æ˜¯windowå¯¹è±¡ï¼‰ä¸­çš„ã€‚</strong></p>
<p>**å°†æ„é€ å‡½æ•°å½“ä½œå‡½æ•°<br>æ„é€ å‡½æ•°ä¸å…¶ä»–å‡½æ•°çš„å”¯ä¸€åŒºåˆ«ï¼Œå°±åœ¨äºè°ƒç”¨å®ƒä»¬çš„æ–¹å¼ä¸åŒï¼Œä¸è¿‡æ„é€ å‡½æ•°æ¯•ç«Ÿä¹Ÿæ˜¯å‡½æ•°ï¼Œä¸å­˜åœ¨å®šä¹‰æ„é€ å‡½æ•°çš„ç‰¹æ®Šè¯­æ³•ã€‚ä»»ä½•å‡½æ•°ï¼Œåªè¦é€šè¿‡newæ“ä½œç¬¦è°ƒç”¨ï¼Œé‚£å®ƒå°±å¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°ï¼›è€Œä»»ä½•å‡½æ•°ï¼Œå¦‚æœä¸é€šè¿‡newæ“ä½œç¬¦æ¥è°ƒç”¨ï¼Œé‚£å®ƒè·Ÿæ™®é€šå‡½æ•°ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆä¸¤æ ·ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å½“ä½œæ„é€ å‡½æ•°ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"software engineer"</span>)</span><br><span class="line">person.sayName()       <span class="comment">//"Nicholas"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨</span></span><br><span class="line">Person(<span class="string">"Greg"</span>, <span class="number">27</span>, <span class="string">"Doctor"</span>)</span><br><span class="line"><span class="built_in">window</span>.sayName()                <span class="comment">//"Greg"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨å¦ä¸€ä¸ªå¯¹è±¡çš„ä½œç”¨åŸŸä¸­è°ƒç”¨</span></span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">Person.call(o, <span class="string">"daming"</span>, <span class="number">25</span>, <span class="string">"Nurse"</span>)</span><br><span class="line">o.sayName()              <span class="comment">//"daming"</span></span><br></pre></td></tr></table></figure>

<p>**æ„é€ å‡½æ•°çš„é—®é¢˜<br>æ„é€ å‡½æ•°æ¨¡å¼è™½ç„¶å¥½ç”¨ï¼Œä½†ä¹Ÿå¹¶éæ²¡æœ‰ç¼ºç‚¹ï¼Œä½¿ç”¨æ„é€ å‡½æ•°çš„ä¸»è¦é—®é¢˜ï¼Œå°±æ˜¯æ¯ä¸ªæ–¹æ³•éƒ½è¦åœ¨æ¯ä¸ªå®ä¾‹ä¸Šé‡æ–°åˆ›å»ºä¸€éã€‚å‰é¢çš„ä¾‹å­ä¸­ï¼Œperson1å’Œperson2éƒ½æœ‰ä¸€ä¸ªåä¸ºsayName()çš„æ–¹æ³•ï¼Œä½†é‚£ä¸¤ä¸ªæ–¹æ³•ä¸æ˜¯åŒä¸€ä¸ªFunctionçš„å®ä¾‹ã€‚ECMAScriptä¸­çš„å‡½æ•°æ˜¯å¯¹è±¡ï¼Œå› æ­¤æ²¡å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å®ä¾‹åŒ–äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä»é€»è¾‘è§’åº¦è®²ï¼Œæ­¤æ—¶çš„æ„é€ å‡½æ•°ä¹Ÿå¯ä»¥è¿™æ ·å®šä¹‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"console.log(this.name)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»è¿™ä¸ªè§’åº¦ä¸Šæ¥çœ‹æ„é€ å‡½æ•°ï¼Œæ›´å®¹æ˜“æ˜ç™½æ¯ä¸ªPersonå®ä¾‹éƒ½åŒ…å«ä¸€ä¸ªä¸åŒçš„Functionå®ä¾‹ï¼ˆä»¥æ˜¾ç¤ºnameå±æ€§ï¼‰çš„æœ¬è´¨ã€‚ä»¥è¿™ç§æ–¹å¼åˆ›å»ºå‡½æ•°ï¼Œä¼šå¯¼è‡´ä¸åŒçš„ä½œç”¨åŸŸé“¾å’Œè¡¨ç¤ºç¬¦è§£æï¼Œä½†åˆ›å»ºFunctionæ–°å®ä¾‹çš„æœºåˆ¶ä»ç„¶æ˜¯ç›¸åŒçš„ã€‚å› æ­¤ä¸åŒå®åŠ›ä¸Šçš„åŒåå‡½æ•°æ˜¯ä¸ç›¸ç­‰çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(person1.sayName === person2.sayName)       <span class="comment">//false</span></span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œï¼Œåˆ›å»ºä¸¤ä¸ªå®ŒæˆåŒæ ·ä»»åŠ¡çš„Functionå®ä¾‹çš„ç¡®æ²¡æœ‰å¿…è¦ï¼Œå†µä¸”æœ‰thiså¯¹è±¡åœ¨ï¼Œæ ¹æœ¬ä¸ç”¨åœ¨æ‰§è¡Œä»£ç å‰å°±æŠŠå“ˆæ•°ç»‘å®šåˆ°ç‰¹å®šå¯¹è±¡ä¸Šé¢ã€‚å› æ­¤ï¼Œå¤§å¯åƒä¸‹é¢è¿™æ ·ï¼Œé€šè¿‡å‡½æ•°å®šä¹‰è½¬ç§»åˆ°æ„é€ å‡½æ•°å¤–éƒ¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">this</span>.sayName = sayName</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">"daming"</span>, <span class="number">19</span>, <span class="string">"software engineer"</span>)</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">"xiaoming"</span>, <span class="number">17</span>, <span class="string">"docter"</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠsayName()å‡½æ•°çš„å®šä¹‰è½¬ç§»åˆ°äº†æ„é€ å‡½æ•°å¤–éƒ¨ã€‚è€Œåœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬è®²sayNameå±æ€§è®¾ç½®ç­‰äºå…¨å±€çš„sayNameå‡½æ•°ï¼Œè¿™æ ·ä¸€æ¥ç”±äºsayNameåŒ…å«çš„æ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆï¼Œå› æ­¤person1å’Œperson2å¯¹è±¡å°±å…±äº«äº†åœ¨å…¨å±€ä½œç”¨è‡ƒè‚¿å®šä¹‰çš„åŒä¸€ä¸ªsayName()å‡½æ•°ã€‚è¿™è§£å†³äº†ä¸¤ä¸ªå‡½æ•°åšåŒä¸€ä»¶äº‹çš„é—®é¢˜ï¼Œä½†å‡ºç°äº†æ–°é—®é¢˜ã€‚å…¨å±€ä½œç”¨åŸŸä¸‹çš„å‡½æ•°åªèƒ½è¢«æŸä¸ªå¯¹è±¡è°ƒç”¨ï¼Œæœ‰è¿å…¨å±€ä½œç”¨åŸŸçš„æœ¬æ„ï¼ŒåŒæ—¶å¦‚æœå¯¹è±¡éœ€è¦å®šä¹‰å¾ˆå¤šæ–¹æ³•ï¼Œé‚£ä¹ˆå°±è¦å®šä¹‰å¤šä¸ªå…¨å±€å‡½æ•°ï¼Œè¿™æ ·å°±æ¯«æ— å°è£…æ€§å¯è¨€äº†ã€‚</p>
<h3 id="åŸå‹æ¨¡å¼"><a href="#åŸå‹æ¨¡å¼" class="headerlink" title="åŸå‹æ¨¡å¼"></a>åŸå‹æ¨¡å¼</h3><p>æˆ‘ä»¬åˆ›å»ºçš„æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªprototypeï¼ˆåŸå‹ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡çš„ç”¨é€”æ˜¯åŒ…å«å¯ä»¥ç”±ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚æ¢å¥è¯è¯´ï¼Œä¸å¿…å†æ„é€ å‡½æ•°ä¸­å®šä¹‰å¯¹è±¡å®ä¾‹çš„ä¿¡æ¯ï¼Œè€Œæ˜¯å¯ä»¥å°†è¿™äº›ä¿¡æ¯ç›´æ¥æ·»åŠ åˆ°åŸå‹å¯¹è±¡ä¸­ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    Person.prototype.name = <span class="string">"daming"</span></span><br><span class="line">    Person.prototype.age = <span class="number">19</span></span><br><span class="line">    Person.prototype.job = <span class="string">"software engineer"</span></span><br><span class="line">    Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line">person1.sayName()    <span class="comment">//daming</span></span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line">person2.sayName()    <span class="comment">//daming</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.sayName === person2.sayName)    <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ï¼Œ<strong>ä¸æ„é€ å‡½æ•°ä¸åŒä¹‹å¤„åœ¨äºï¼Œæ–°å¯¹è±¡çš„è¿™äº›å±æ€§å’Œæ–¹æ³•æ˜¯ç”±æ‰€æœ‰å®ä¾‹å…±äº«çš„ã€‚</strong></p>
<p>ç†è§£åŸå‹å¯¹è±¡<br>æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œåªè¦åˆ›å»ºäº†ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå°±å›æ ¹æ®ä¸€ç»„ç‰¹å®šçš„è§„åˆ™ä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªprototypeå±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰åŸå‹å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨è·å¾—ä¸€ä¸ªconstructorï¼ˆæ„é€ å‡½æ•°ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§åŒ…å«ä¸€ä¸ªæŒ‡å‘prototypeå±æ€§æ‰€åœ¨å‡½æ•°çš„æŒ‡é’ˆï¼Œå°±æ‹¿å‰é¢çš„ä¾‹å­æ¥è¯´ï¼ŒPerson.prototype.constructoræŒ‡å‘Personã€‚é€šè¿‡è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä¸ºåŸå‹å¯¹è±¡æ·»åŠ å…¶ä»–å±æ€§å’Œæ–¹æ³•ã€‚<br>åˆ›å»ºäº†è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ä¹‹åï¼Œå…¶åŸå‹å¯¹è±¡é»˜è®¤åªä¼šå–å¾—constructorå±æ€§ï¼Œè‡³äºå…¶ä»–æ–¹æ³•ï¼Œéƒ½æ˜¯ä»Objectç»§æ‰¿è€Œæ¥ã€‚å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ˆå†…éƒ¨å±æ€§ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ŒECMA-262ç¬¬5ç‰ˆä¸­ç®¡è¿™ä¸ªæŒ‡é’ˆå«[[Prototype]]ã€‚<strong>è¦æ˜ç¡®çš„æ˜¯ï¼Œè¿™ä¸ªè¿æ¥å­˜åœ¨äºå®ä¾‹ä¸æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´ï¼Œè€Œä¸æ˜¯å­˜åœ¨äºå®ä¾‹å’Œæ„é€ å‡½æ•°ä¹‹é—´</strong>ã€‚å…·ä½“å…³ç³»å¦‚ä¸‹å›¾</p>
<!-- ![attr](/public/images/å®ä¾‹åŸå‹æ„é€ å‡½æ•°å…³ç³»å›¾.png) -->
<p><img src="%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E6%80%BB%E7%BB%93/a.png" alt="attr"><br>å¦‚ä¸Šä¾‹ä¸­ï¼Œä¸¤ä¸ªå¯¹è±¡éƒ½ä¸åŒ…å«å±æ€§å’Œæ–¹æ³•ï¼Œä½†æˆ‘ä»¬å´å¯ä»¥è°ƒç”¨person1.sayName()ã€‚è¿™æ˜¯é€šè¿‡æŸ¥æ‰¾å¯¹è±¡å±æ€§çš„è¿‡ç¨‹æ¥å®ç°çš„ã€‚<br>è™½ç„¶åœ¨æ‰€æœ‰å®ç°ä¸­éƒ½æ— æ³•è®¿é—®åˆ°[[Prototype]],ä½†å¯ä»¥é€šè¿‡isPrototypeOf()æ–¹æ³•æ¥ç¡®å®šå¯¹è±¡ä¹‹é—´æ˜¯å¦å­˜åœ¨è¿™ç§å…³ç³»ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œå¦‚æœ[[Prototype]]æŒ‡å‘ è°ƒç”¨isPrototypeOf()æ–¹æ³•çš„å¯¹è±¡ï¼ˆPerson.prototype),é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±è¿”å›trueã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(Person.prototype.isPrototypeOf(person1))</span><br><span class="line"><span class="built_in">console</span>.log(Person.prototype.isPrototypeOf(person2))</span><br></pre></td></tr></table></figure>
<p>ECMAScript5ä¸­å¢åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå«Object.getPrototypeOf()ï¼Œåœ¨æ‰€æœ‰æ”¯æŒçš„å®ç°ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›[[Prototype]]çš„å€¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(person1) == Person.prototype)     <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(person1).name)                    <span class="comment">//"daming"</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨Object.getPrototypeOf()å¯ä»¥æ–¹ä¾¿åœ°å–å¾—ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œè€Œåœ¨åˆ©ç”¨åŸå‹å®ç°é›†æˆçš„æƒ…å†µä¸‹æ˜¯éå¸¸é‡è¦çš„ã€‚<br>è™½ç„¶å¯ä»¥é€šè¿‡å¯¹è±¡å®ä¾‹è®¿é—®ä¿å­˜åœ¨åŸå‹ä¸­çš„å€¼ï¼Œä½†å´ä¸èƒ½é€šè¿‡å¯¹è±¡å®ä¾‹é‡å†™åŸå‹ä¸­çš„å€¼ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å®ä¾‹ä¸­æ·»åŠ äº†ä¸€ä¸ªå±æ€§ï¼Œè€Œè¯¥å±æ€§ä¸å®ä¾‹åŸå‹ä¸­çš„ä¸€ä¸ªå±æ€§åŒåï¼Œé‚£å°±åœ¨å®ä¾‹ä¸­åˆ›å»ºè¯¥å±æ€§ï¼Œæ”¹å±æ€§å°†ä¼šå±è”½åŸå‹ä¸­çš„é‚£ä¸ªå±æ€§ã€‚æ·»åŠ è¿™ä¸ªå±æ€§åªä¼šé˜»æ­¢è®¿é—®åŸå‹å¯¹è±¡ä¸­çš„é‚£ä¸ªå±æ€§ï¼Œä½†ä¸ä¼šä¿®æ”¹é‚£ä¸ªå±æ€§ã€‚å³ä½¿å°†è¯¥å±æ€§è®¾ä¸ºnullï¼Œä¹Ÿåªä¼šåœ¨å®ä¾‹ä¸­è®¾ç½®è¿™ä¸ªå±æ€§ï¼Œä¸ä¼šæ¢å¤å…¶æŒ‡å‘åŸå‹çš„è¿æ¥ã€‚ä¸è¿‡deleteæ“ä½œç¬¦å¯ä»¥å®Œå…¨åˆ é™¤å®ä¾‹å±æ€§ï¼Œä»è€Œèƒ½å¤Ÿé‡æ–°è®¿é—®åŸå‹ä¸­çš„å±æ€§ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.name = <span class="string">"Nicholas"</span></span><br><span class="line">Person.prototype.age = <span class="number">19</span></span><br><span class="line">Person.prototype.job = <span class="string">"software engineer"</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line">person1.name = <span class="string">"daming"</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.name)   <span class="comment">//daming</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.name)   <span class="comment">//Nicholas</span></span><br><span class="line">person1.sayName()           <span class="comment">//daming</span></span><br><span class="line">person2.sayName()           <span class="comment">//Nicholas</span></span><br><span class="line"></span><br><span class="line">person1.name = <span class="literal">null</span>         </span><br><span class="line"><span class="built_in">console</span>.log(person1.name)   <span class="comment">//null</span></span><br><span class="line">person1.sayName()           <span class="comment">//null</span></span><br><span class="line"><span class="keyword">delete</span> person1.name</span><br><span class="line"><span class="built_in">console</span>.log(person1.name)   <span class="comment">//Nicholas</span></span><br><span class="line">person1.sayName()           <span class="comment">//Nicholas</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨hasOwnProperty()æ–¹æ³•å¯ä»¥æ£€æµ‹ä¸€ä¸ªå±æ€§æ˜¯å­˜åœ¨åœ¨äºå®ä¾‹ä¸­è¿˜æ˜¯å­˜åœ¨åœ¨äºåŸå‹ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.name = <span class="string">"Nicholas"</span></span><br><span class="line">Person.prototype.age = <span class="number">19</span></span><br><span class="line">Person.prototype.job = <span class="string">"software engineer"</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="built_in">console</span>.log(person1.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//false</span></span><br><span class="line">person1.name = <span class="string">"daming"</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.name)                    <span class="comment">//daming</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.name)                    <span class="comment">//Nicholas</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//false</span></span><br><span class="line"><span class="keyword">delete</span> person1.name                           </span><br><span class="line"><span class="built_in">console</span>.log(person1.name)                    <span class="comment">//Nicholas</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>
<p><strong>åŸå‹ä¸inæ“ä½œç¬¦</strong><br>æœ‰ä¸¤ç§æ–¹å¼ä½¿ç”¨inæ“ä½œç¬¦ï¼šå•ç‹¬ä½¿ç”¨å’Œåœ¨for-inå¾ªç¯ä¸­ä½¿ç”¨ã€‚<br><strong>å•ç‹¬ä½¿ç”¨æ—¶ï¼Œinæ“ä½œç¬¦ä¼šåœ¨é€šè¿‡å¯¹è±¡èƒ½å¤Ÿè®¿é—®ç»™å®šå±æ€§æ—¶è¿”å›trueï¼Œæ— è®ºè¯¥å±æ€§å­˜åœ¨äºå®ä¾‹ä¸­è¿˜æ˜¯åŸå‹ä¸­ã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.name = <span class="string">"Nicholas"</span></span><br><span class="line">Person.prototype.age = <span class="number">29</span></span><br><span class="line">Person.prototype.job = <span class="string">"Software Engineer"</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="built_in">console</span>.log(person1.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"name"</span> <span class="keyword">in</span> person1)               <span class="comment">//true</span></span><br><span class="line">person1.name = <span class="string">"Greg"</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.name)                    <span class="comment">//"Greg" -----æ¥è‡ªå®ä¾‹</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"name"</span> <span class="keyword">in</span> person1)               <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.name)                    <span class="comment">//daming -----æ¥è‡ªåŸå‹</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"name"</span> <span class="keyword">in</span> person2)               <span class="comment">//true</span></span><br><span class="line"><span class="keyword">delete</span> person1.name</span><br><span class="line"><span class="built_in">console</span>.log(person1.name)                    <span class="comment">//daming -----æ¥è‡ªåŸå‹</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.hasOwnProperty(<span class="string">"name"</span>))  <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"name"</span> <span class="keyword">in</span> person1)               <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p><strong>åœ¨ä½¿ç”¨for-inå¾ªç¯æ—¶ï¼Œè¿”å›çš„æ—¶æ‰€æœ‰èƒ½å¤Ÿé€šè¿‡å¯¹è±¡è®¿é—®çš„ï¼Œå¯æšä¸¾çš„ï¼ˆenumeratedï¼‰å±æ€§ï¼Œå…¶ä¸­ï¼Œæ—¢åŒ…æ‹¬å­˜åœ¨äºå®ä¾‹ä¸­çš„å±æ€§ï¼Œä¹ŸåŒ…æ‹¬å­˜åœ¨äºåŸå‹ä¸­çš„å±æ€§ã€‚å±è”½äº†åŸå‹ä¸­ä¸å¯æšä¸¾å±æ€§ï¼ˆå³å°†[[Enumerale]]æ ‡è®°çš„å±æ€§ï¼‰çš„å®ä¾‹ä¹Ÿä¼šåœ¨for-inå¾ªç¯ä¸­è¿”å›ã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.name = <span class="string">"Nicholas"</span></span><br><span class="line">Person.prototype.age = <span class="number">29</span></span><br><span class="line">Person.prototype.job = <span class="string">"Software Engineer"</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">in</span> person1) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;                                    <span class="comment">//name, age, job, sayName</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Person.prototype, <span class="string">"name"</span>, &#123;</span><br><span class="line">	enumerable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">in</span> person1) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;                                   <span class="comment">//age, job, sayName</span></span><br><span class="line">person1.name = <span class="string">"Greg"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">in</span> person1) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;                                   <span class="comment">//name, age, job, sayName</span></span><br></pre></td></tr></table></figure>
<p>è¦å–å¾—å¯¹è±¡ä¸Šæ‰€æœ‰å¯æšä¸¾çš„å®ä¾‹å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ECMAScript5çš„Object.keys()æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚<br><strong>æ³¨æ„Object.keyså’Œfor-inä¹‹é—´çš„å·®åˆ«</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.name = <span class="string">"daming"</span></span><br><span class="line">Person.prototype.age = <span class="number">29</span></span><br><span class="line">Person.prototype.job = <span class="string">"softWare Engineer"</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> keys = <span class="built_in">Object</span>.keys(Person.prototype)</span><br><span class="line"><span class="built_in">console</span>.log(keys)                               <span class="comment">//name, age, job, sayName</span></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person()</span><br><span class="line">p1.name = <span class="string">"Rob"</span></span><br><span class="line">p1.age = <span class="number">31</span></span><br><span class="line"><span class="keyword">var</span> p1keys = <span class="built_in">Object</span>.keys(p1)</span><br><span class="line"><span class="built_in">console</span>.log(p1keys)                            <span class="comment">//name, age</span></span><br></pre></td></tr></table></figure>
<p><strong>å¦‚æœéœ€è¦å¾—åˆ°æ‰€æœ‰å®ä¾‹å±æ€§ï¼Œæ— è®ºå®ƒæ˜¯å¦å¯æšä¸¾ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Object.getOwnPropertyNames()æ–¹æ³•ã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> keys = <span class="built_in">Object</span>.getOwnPropertyNames(Person.prototype)</span><br><span class="line"><span class="built_in">console</span>.log(keys)                                   <span class="comment">//constructor, name, age, job, sayName</span></span><br></pre></td></tr></table></figure>

<p><strong>æ›´ç®€å•çš„åŸå‹è¯­æ³•</strong><br>ç”¨ä¸€ä¸ªåŒ…å«æ‰€æœ‰å±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡å­—é¢é‡æ¥é‡å†™æ•´ä¸ªåŸå‹å¯¹è±¡ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    name: <span class="string">"nicholas"</span>,</span><br><span class="line">    age: <span class="number">29</span>,</span><br><span class="line">    job: <span class="string">"software Engineer"</span>,</span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå°†Person.prototypeè®¾ç½®ä¸ºç­‰äºä¸€ä¸ªä»¥å¯¹è±¡å­—é¢é‡å½¢å¼åˆ›å»ºçš„æ–°å¯¹è±¡ã€‚æœ€ç»ˆç»“æœç›¸åŒï¼Œä½†æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œconstructorå±æ€§ä¸å†æŒ‡å‘Personäº†ã€‚æ¯åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œéƒ½ä¼šåŒæ—¶åˆ›å»ºå®ƒçš„prototypeå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè‡ªåŠ¨è·å¾—constructorå±æ€§ï¼Œè€Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„è¯­æ³•ï¼Œæœ¬è´¨ä¸Šå®Œå…¨é‡å†™äº†é»˜è®¤çš„prototypeå¯¹è±¡ï¼Œå› æ­¤constructorå±æ€§ä¹Ÿå°±å˜æˆäº†æ–°å¯¹è±¡çš„constructorå±æ€§ï¼ˆæŒ‡å‘Objectæ„é€ å‡½æ•°ï¼‰ï¼Œä¸å†æŒ‡å‘Personå‡½æ•°ã€‚æ­¤æ—¶ï¼Œå°½ç®¡instanceofæ“ä½œç¬¦è¿˜èƒ½è¿”å›æ­£ç¡®çš„ç»“æœï¼Œä½†é€šè¿‡constructorå·²ç»æ— æ³•ç¡®å®šå¯¹è±¡çš„ç±»å‹äº†ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friend = <span class="keyword">new</span> Person()</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(friend <span class="keyword">instanceof</span> <span class="built_in">Object</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend <span class="keyword">instanceof</span> Person)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.constructor == Person) <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.constructor ==<span class="built_in">Object</span>)  <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    name: <span class="string">"nicholas"</span>,</span><br><span class="line">    age: <span class="number">29</span>,</span><br><span class="line">    job: <span class="string">"software Engineer"</span>,</span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friend2 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="built_in">console</span>.log(friend2 <span class="keyword">instanceof</span> <span class="built_in">Object</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend2 <span class="keyword">instanceof</span> Person)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend2.constructor == Person) <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(friend2.constructor ==<span class="built_in">Object</span>)  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§å†™æ³•ï¼Œä¼šå¯¼è‡´ä¸åŒçš„è¾“å‡ºç»“æœï¼ŒåŸå› åœ¨äºé‡å†™äº†Person.prototypeå¯¹è±¡åPerson.prototypeå·²å‘ç”Ÿæ”¹å˜ï¼Œ<strong>æ³¨æ„ä¸ä¸Šä¸€ç§çš„åŒºåˆ«è”ç³»</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friend = <span class="keyword">new</span> Person()</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(friend <span class="keyword">instanceof</span> <span class="built_in">Object</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend <span class="keyword">instanceof</span> Person)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.constructor == Person) <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.constructor ==<span class="built_in">Object</span>)  <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    name: <span class="string">"nicholas"</span>,</span><br><span class="line">    age: <span class="number">29</span>,</span><br><span class="line">    job: <span class="string">"software Engineer"</span>,</span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(friend <span class="keyword">instanceof</span> <span class="built_in">Object</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend <span class="keyword">instanceof</span> Person)  <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.constructor == Person) <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.constructor ==<span class="built_in">Object</span>)  <span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœconstructorçš„å€¼çœŸçš„å¾ˆé‡è¦ï¼Œå¯ä»¥åƒåƒä¸‹é¢è¿™æ ·ç‰¹æ„å°†ä»–è®¾ç½®ä¼šé€‚å½“å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Person,</span><br><span class="line">    name: "nicholas",</span><br><span class="line">    age: 29,</span><br><span class="line">    job: "software Engineer",</span><br><span class="line">    sayName: function() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä»¥è¿™ç§æ–¹å¼é‡è®¾constructorå±æ€§ä¼šå¯¼è‡´å®ƒçš„[[Enumerable]]ç‰¹æ€§è¢«è®¾ç½®ä¸ºtrueã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸç”Ÿçš„constructorå±æ€§æ˜¯ä¸å¯æšä¸¾çš„ï¼Œå¼¥è¡¥æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fucntion Person() &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    name: <span class="string">"Nicholas"</span>,</span><br><span class="line">    age: <span class="number">29</span>,</span><br><span class="line">    job: <span class="string">"Software Engineer"</span></span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Person.prototype, <span class="string">"constructor"</span>, &#123;</span><br><span class="line">    enumerable: <span class="literal">false</span>,</span><br><span class="line">    value: Person</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>åŸå‹çš„åŠ¨æ€æ€§</strong><br>ç”±äºåœ¨åŸå‹ä¸­æŸ¥æ‰¾å€¼çš„è¿‡ç¨‹æ˜¯ä¸€æ¬¡æœç´¢ï¼Œå› æ­¤æˆ‘ä»¬å¯¹åŸå‹å¯¹è±¡æ‰€ä½œçš„ä»»ä½•ä¿®æ”¹éƒ½èƒ½å¤Ÿç«‹å³ä»å®ä¾‹ä¸Šåæ˜ å‡ºæ¥ï¼Œå³ä½¿å…ˆåˆ›å»ºäº†å®ä¾‹åä¿®æ”¹åŸå‹ä¹Ÿç…§æ ·å¦‚æ­¤ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> friend = <span class="keyword">new</span> Person()</span><br><span class="line">Person.prototype.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hi'</span>)</span><br><span class="line">&#125;</span><br><span class="line">friend.sayHi()     <span class="comment">//hi</span></span><br></pre></td></tr></table></figure>
<p>å°½ç®¡å¯ä»¥éšæ—¶ä¸ºåŸå‹æ·»åŠ å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”ä¿®æ”¹èƒ½å¤Ÿç«‹å³åœ¨æ‰€æœ‰å¯¹è±¡å®ä¾‹ä¸­åæ˜ å‡ºæ¥ï¼Œä½†å¦‚æœé‡å†™æ•´ä¸ªåŸå‹å¯¹è±¡å°±ä¸ä¸€æ ·äº†ã€‚å…¶åŸå› åœ¨äºï¼Œè°ƒç”¨æ„é€ å‡½æ•°æ—¶ä¼šä¸ºå®åŠ›æ·»åŠ ä¸€ä¸ªæŒ‡å‘æœ€åˆåŸå‹çš„[[Prototype]]æŒ‡é’ˆï¼Œè€ŒæŠŠåŸå‹ä¿®æ”¹ä¸ºå¦ä¸€ä¸ªå¯¹è±¡å°±ç­‰äºåˆ‡æ–­äº†æ„é€ å‡½æ•°ä¸æœ€åˆåŸå‹ä¹‹é—´çš„è”ç³»ã€‚**å®ä¾‹ä¸­çš„æŒ‡é’ˆä»…æŒ‡å‘åŸå‹ï¼Œä¸æŒ‡å‘æ„é€ å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sayAge'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> friend = <span class="keyword">new</span> Person()</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Person,</span><br><span class="line">    name: 'Nicholas',</span><br><span class="line">    age: 19,</span><br><span class="line">    job: 'software enginner',</span><br><span class="line">    sayName: function() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">friend.sayAge()                 <span class="comment">//'sayAge'</span></span><br><span class="line">friend.sayName()                <span class="comment">//error</span></span><br></pre></td></tr></table></figure>
<p><strong>åŸç”Ÿå¯¹è±¡çš„åŸå‹</strong><br>åŸå‹æ¨¡å¼çš„é‡è¦æ€§ä¸ä»…ä½“ç°åœ¨åˆ›å»ºè‡ªå®šä¹‰ç±»å‹æ–¹é¢ï¼Œå°±è¿æ‰€æœ‰åŸç”Ÿçš„å¼•ç”¨ç±»å‹ï¼Œéƒ½æ˜¯é‡‡ç”¨è¿™ç§æ¨¡å¼åˆ›å»ºçš„ã€‚æ‰€æœ‰åŸç”Ÿå¼•ç”¨ç±»å‹ï¼ˆObject, Array, String, ç­‰ç­‰ï¼‰éƒ½åœ¨å…¶æ„é€ å‡½æ•°çš„åŸå‹ä¸Šå®šä¹‰äº†æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨Array.prototypeä¸­å¯ä»¥æ‰¾åˆ°sort()æ–¹æ³•ï¼Œè€Œåœ¨String.prototypeä¸­å¯ä»¥æ‰¾åˆ°substring()æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Array</span>.prototype.sort)                 <span class="comment">//funciton</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">String</span>.prototype.substring)           <span class="comment">//function</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡åŸç”Ÿå¯¹è±¡çš„åŸå‹ï¼Œä¸ä»…å¯ä»¥å–å¾—æ‰€æœ‰é»˜è®¤æ–¹æ³•çš„å¼•ç”¨ï¼Œè€Œä¸”å¯ä»¥å®šä¹‰æ–°æ–¹æ³•ã€‚å¯ä»¥åƒä¿®æ”¹è‡ªå®šä¹‰å¯¹è±¡çš„åŸå‹ä¸€æ ·ä¿®æ”¹åŸç”Ÿå¯¹è±¡çš„åŸå‹ï¼Œå› æ­¤å¯ä»¥éšæ—¶æ·»åŠ æ–¹æ³•ã€‚ä¸‹é¢çš„ä»£ç å°±ç»™åŸºæœ¬åŒ…è£…ç±»å‹Stringæ·»åŠ äº†ä¸€ä¸ªåä¸ºstartsWith()æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.startsWith = <span class="function"><span class="keyword">function</span> (<span class="params">text</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.indexOf(text) == <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> msg = <span class="string">'Hello World'</span></span><br><span class="line"><span class="built_in">console</span>.log(msg.startsWith(<span class="string">'Hello'</span>))   <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>å°½ç®¡å¯ä»¥è¿™æ ·åšï¼Œä½†ä¸æ¨èåœ¨äº§å“åŒ–çš„ç¨‹åºä¸­ä¿®æ”¹åŸç”Ÿå¯¹è±¡çš„åŸå‹ã€‚å¦‚æœå› æŸä¸ªäº‹é¡¹ä¸­ç¼ºå°‘æŸä¸ªæ–¹æ³•ï¼Œå°±åœ¨åŸç”Ÿå¯¹è±¡çš„åŸå‹ä¸­æ·»åŠ è¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå½“åœ¨å¦ä¸€ä¸ªæ”¯æŒè¯¥æ–¹æ³•çš„è§†çº¿ä¸­è¿è¡Œä»£ç æ—¶ï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´å‘½åå†²çªï¼Œè€Œä¸”è¿™æ ·åšä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°é‡å†™åŸç”Ÿæ–¹æ³•ã€‚<br><strong>åŸç”Ÿå¯¹è±¡åœ°é—®é¢˜</strong><br>åŸå‹æ¨¡å¼ä¹Ÿä¸æ˜¯æ²¡æœ‰ç¼ºç‚¹ï¼Œé¦–å…ˆï¼Œå®ƒçœç•¥äº†ä¸ºæ„é€ å‡½æ•°ä¼ é€’åˆå§‹åŒ–é˜è¿°è¿™ä¸€å›å§ï¼Œç»“æœæ‰€æœ‰å®ä¾‹åœ¨é»˜è®¤æƒ…å†µä¸‹éƒ½å°†å–å¾—ç›¸åŒçš„å±æ€§å€¼ã€‚è™½ç„¶è¿™ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šå¸¦æ¥ä¸€äº›ä¸æ–¹ä¾¿ï¼Œä½†è¿˜ä¸æ˜¯åŸå‹çš„æœ€å¤§é—®é¢˜ï¼ŒåŸå‹æ¨¡å¼çš„æœ€å¤§é—®é¢˜æ˜¯ç”±å…¶å…±äº«çš„æœ¬æ€§æ‰€å¯¼è‡´çš„ã€‚<br>åŸå‹ä¸­æ‰€æœ‰å±æ€§æ˜¯è¢«å¾ˆå¤šå®ä¾‹å…±äº«çš„ï¼Œè¿™ç§å…±äº«å¯¹äºå‡½æ•°éå¸¸åˆé€‚ã€‚å¯¹äºé‚£äº›åŒ…å«åŸºæœ¬å€¼çš„å±æ€§è¯´å¾—è¿‡å»ï¼Œå› ä¸ºé€šè¿‡åœ¨å®åŠ›ä¸Šæ·»åŠ ä¸€ä¸ªåŒåå±æ€§ï¼Œå¯ä»¥éšè—åŸå‹ä¸­çš„å¯¹åº”å±æ€§ã€‚ä½†å¯¹äºåŒ…å«å¼•ç”¨ç±»å‹çš„å±æ€§æ¥è¯´ï¼Œé—®é¢˜å°±æ¯”è¾ƒçªå‡ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Person,</span><br><span class="line">    name: 'Nicholas',</span><br><span class="line">    age: 19,</span><br><span class="line">    job: 'software enginee',</span><br><span class="line">    friends: ['daing', 'lingling'],</span><br><span class="line">    sayName: function() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person()</span><br><span class="line">person1.friends.push(<span class="string">'Van'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1.friends)                       <span class="comment">//daing, lingling, Van</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.friends)                       <span class="comment">//daing, lingling, Van</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.friends === person2.freidns)   <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>åœ¨person1çš„friendsä¸­æ·»åŠ ä¸€é¡¹ï¼Œperson2çš„friendsä¹Ÿç›¸åº”æ·»åŠ äº†ä¸€é¡¹ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¿™æ˜¯ä¸æƒ³è¦çš„ï¼Œè¿™ä¸ªé—®é¢˜æ­£æ˜¯å¾ˆå°‘æœ‰äººå•ç‹¬ä½¿ç”¨åŸå‹æ¨¡å¼çš„åŸå› ã€‚</p>
<h3 id="ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼"><a href="#ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼" class="headerlink" title="ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼"></a>ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼</h3><p>åˆ›å»ºè‡ªå®šä¹‰ç±»å‹çš„æœ€å¸¸è§æ–¹å¼ï¼Œå°±æ˜¯ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼ä¸åŸå‹æ¨¡å¼ã€‚<strong>æ„é€ å‡½æ•°æ¨¡å¼ç”¨äºå®šä¹‰å®ä¾‹å±æ€§ï¼Œè€ŒåŸå‹æ¨¡å¼ç”¨äºå®šä¹‰æ–¹æ³•å’Œå…±äº«çš„å±æ€§</strong>ã€‚è¿™æ ·ï¼Œæ¯ä¸ªå®åŠ›éƒ½ä¼šæœ‰è‡ªå·±çš„ä¸€ä»½å®ä¾‹å±æ€§çš„å‰¯æœ¬ï¼Œä½†åŒæ—¶åˆå…±äº«ç€å¯¹æ–¹æ³•çš„å¼•ç”¨ï¼Œè¿™æœ€å¤§é™åº¦åœ°æ¥ä¸Šäº†å†…å­˜ã€‚å¦å¤–ï¼Œè¿™ç§æ··æˆæ¨¡å¼è¿˜æ”¯æŒå‘æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">this</span>.friends = [<span class="string">'daming'</span>, <span class="string">'lingling'</span>]</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Person,</span><br><span class="line">    sayName: function() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">'Nicholas'</span>, <span class="number">19</span>, <span class="string">'software engineer'</span>)</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">'Greg'</span>, <span class="number">17</span>, <span class="string">'doctor'</span>)</span><br><span class="line">person1.friends.push(<span class="string">'van'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person1.friends)                                 <span class="comment">//daming, lingling, van</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.friends)                                 <span class="comment">//daming, lingling</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.friends === person2.friends)             <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.sayName === person2.sayName)             <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<h3 id="åŠ¨æ€åŸå‹æ¨¡å¼"><a href="#åŠ¨æ€åŸå‹æ¨¡å¼" class="headerlink" title="åŠ¨æ€åŸå‹æ¨¡å¼"></a>åŠ¨æ€åŸå‹æ¨¡å¼</h3><p>åŠ¨æ€åŸå‹æ¨¡å¼æŠŠæ‰€æœ‰ä¿¡æ¯éƒ½å°è£…å†äº†æ„é€ å‡½æ•°ä¸­ï¼ŒäºŒé€šè¿‡åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–åŸå‹ï¼Œåˆä¿æŒäº†åŒæ—¶ä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹çš„ä¼˜ç‚¹ã€‚æ¢å¥è¯è¯´ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æŸä¸ªåº”è¯¥å­˜åœ¨çš„æ–¹æ³•æ˜¯å¦æœ‰æ•ˆï¼Œæ¥å†³å®šæ˜¯å¦æœ‰éœ€è¦åˆå§‹åŒ–åŸå‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.sayName != <span class="string">"function"</span>) &#123;</span><br><span class="line">        Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼"><a href="#å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼" class="headerlink" title="å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼"></a>å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼</h3><p>é€šå¸¸ï¼Œåœ¨å‰è¿°çš„é›†ä¸­æ¨¡å¼éƒ½ä¸é€‚ç”¨çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å¯„ç”Ÿ(parasitic)æ„é€ å‡½æ•°æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼çš„åŸºæœ¬æ€æƒ³æ—¶åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨ä»…ä»…æ—¶å°è£…åˆ›å»ºå¯¹è±¡çš„ä»£ç ï¼Œç„¶åå†è¿”å›æ–°å»ºçš„å¯¹è±¡ï¼›ä½†ä»è¡¨é¢ä¸Šçœ‹ï¼Œè¿™ä¸ªå‡½æ•°åˆåƒæ˜¯å…¸å‹çš„æ„é€ å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    o.name = name</span><br><span class="line">    o.age = age</span><br><span class="line">    o.job = job</span><br><span class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> friend = <span class="keyword">new</span> Person(<span class="string">'Nicholas'</span>, <span class="number">29</span>, <span class="string">'software engineer'</span>)</span><br><span class="line">friend.sayName()                                                  <span class="comment">//Nicholas</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé™¤äº†ä½¿ç”¨newæ“ä½œç¬¦å¹¶æŠŠä½¿ç”¨çš„åŒ…è£…å‡½æ•°å«åšæ„é€ å‡½æ•°éª„å‚²åšæ„é€ å‡½æ•°ä¹‹å¤–ï¼Œè¿™ä¸ªæ¨¡å¼è·Ÿå·¥å‚æ¨¡å¼å…¶å®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚<strong>æ„é€ å‡½æ•°åœ¨ä¸è¿”å›å€¼çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¼šè¿”å›æ–°å¯¹è±¡å®ä¾‹ã€‚è€Œé€šè¿‡æ„é€ å‡½æ•°çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªreturnè¯­å¥ï¼Œå¯ä»¥é‡å†™è°ƒç”¨æ„é€ å‡½æ•°æ—¶è¿”å›çš„å€¼ã€‚</strong><br>è¿™ä¸ªæ¨¡å¼å¯ä»¥åœ¨ç‰¹æ®Šçš„æƒ…å†µè¥¿ç”¨æ¥ä¸ºå¯¹è±¡åˆ›å»ºæ„é€ å‡½æ•°ï¼Œå‡è®¾æˆ‘ä»¬å‘åˆ›å»ºä¸€ä¸ªå…·æœ‰é¢å¤–æ–¹æ³•çš„ç‰¹æ®Šæ•°ç»„ã€‚ç”±äºä¸èƒ½ç›´æ¥ä¿®æ”¹Arrayæ„é€ å‡½æ•°ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SpecialArray</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> values = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">    values.push.apply(values, <span class="built_in">arguments</span>)</span><br><span class="line">    values.toPipedString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.join(<span class="string">"|"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> values</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> colors = <span class="keyword">new</span> SpecialArray(<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>)</span><br><span class="line"><span class="built_in">console</span>.log((colors.toPipeString()));</span><br></pre></td></tr></table></figure>
<p>å…³äºå¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼ï¼Œæœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜ï¼šé¦–å…ˆï¼Œè¿”å›çš„å¯¹è±¡ä¸æ„é€ å‡½æ•°æˆ–è€…ä¸æ„é€ å‡½æ•°çš„åŸå‹å±æ€§ä¹‹é—´æ²¡æœ‰å…³ç³»ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ„é€ å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸åœ¨æ„é€ æ±‰é¡ºå¤–éƒ¨åˆ›å»ºçš„å¯¹è±¡æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚ä¸ºæ­¤ä¸èƒ½ä¾èµ–instanceofæ“ä½œç¬¦æ¥ç¡®å®šå¯¹è±¡ç±»å‹ã€‚</p>
<h3 id="ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼"><a href="#ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼" class="headerlink" title="ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼"></a>ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼</h3><p>æ‰€è°“ç¨³å¦¥å¯¹è±¡ï¼ŒæŒ‡çš„æ˜¯æ²¡æœ‰å…¬å…±å±æ€§ï¼Œè€Œä¸”å…¶æ–¹æ³•ä¹Ÿä¸å¼•ç”¨thiså¯¹è±¡ï¼Œç¨³å¦¥å¯¹è±¡æœ€é€‚åˆåœ¨ä¸€äº›å®‰å…¨çš„ç¯å¢ƒä¸­ä½¿ç”¨ï¼ˆè¿™äº›ç¯å¢ƒä¸­ä¼šç¦æ­¢ä½¿ç”¨thiså’Œnewï¼‰ï¼Œæˆ–è€…åœ¨é˜²æ­¢æ•°æ®è¢«å…¶ä»–åº”ç”¨ç¨‹åºï¼ˆå¦‚Mashupç¨‹åºï¼‰æ”¹åŠ¨æ—¶ä½¿ç”¨ã€‚ç¨³å¦¥æ„é€ å‡½æ•°éµå¾ªä¸å¯„ç”Ÿæ„é€ å‡½æ•°ç±»ä¼¼çš„æ¨¡å¼ï¼Œä½†æœ‰ä¸¤ç‚¹ä¸åŒï¼šä¸€æ˜¯æ–°åˆ›å»ºå¯¹è±¡çš„å®ä¾‹æ–¹æ³•ä¸å¼•ç”¨thisï¼ŒäºŒæ˜¯ä¸ä½¿ç”¨newæ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> friend = Person(<span class="string">"Nicholas"</span>, <span class="number">19</span>, <span class="string">"Software Engineer"</span>)</span><br><span class="line">friend.sayName()                                             <span class="comment">//Nicholas</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œåœ¨ä»¥è¿™ç§æ¨¡å¼åˆ›å»ºçš„å¯¹è±¡ä¸­ï¼Œé™¤äº†ä½¿ç”¨sayName()æ–¹æ³•ä¹‹å¤–ï¼Œæ²¡æœ‰å…¶ä»–åŠæ³•è®¿é—®nameçš„å€¼ã€‚<br>è¿™æ ·ï¼Œå˜é‡personä¸­ä¿å­˜çš„æ˜¯ä¸€ä¸ªç¨³å¦¥å¯¹è±¡ï¼Œè€Œé™¤äº†è°ƒç”¨sayName()æ–¹æ³•å¤–ï¼Œæ²¡æœ‰åˆ«çš„æ–¹å¼å¯ä»¥è®¿é—®å…¶æ•°æ®æˆå‘˜ã€‚å³ä½¿æœ‰å…¶ä»–ä»£ç ä¼šç»™è¿™ä¸ªå¯¹è±¡æ·»åŠ æ–¹æ³•æˆ–æ•°æ®æˆå‘˜ï¼Œä½†ä¹Ÿä¸å¯èƒ½æœ‰åˆ«çš„åŠæ³•è®¿é—®ä¼ å…¥åˆ°æ„é€ å‡½æ•°ä¸­çš„åŸå§‹æ•°æ®ã€‚ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼æä¾›è¿™ç§å®‰å…¨æ€§ã€‚<br>ä¸å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼ç±»ä¼¼ï¼Œä½¿ç”¨ç¨³å¦¥æ„é€ å«ç³Šæ¨¡å¼åˆ›å»ºçš„å¯¹è±¡ä¸æ„é€ å‡½æ•°ä¹‹é—´ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œå› æ­¤instanceofæ“ä½œç¬¦å¯¹è¿™ç§å¯¹è±¡ä¹Ÿæ²¡æœ‰æ„ä¹‰ã€‚</p>
<h2 id="æ‰©å±•çš„å¯¹è±¡åŠŸèƒ½"><a href="#æ‰©å±•çš„å¯¹è±¡åŠŸèƒ½" class="headerlink" title="æ‰©å±•çš„å¯¹è±¡åŠŸèƒ½"></a>æ‰©å±•çš„å¯¹è±¡åŠŸèƒ½</h2><h3 id="å¯¹è±¡ç±»åˆ«"><a href="#å¯¹è±¡ç±»åˆ«" class="headerlink" title="å¯¹è±¡ç±»åˆ«"></a>å¯¹è±¡ç±»åˆ«</h3><p>å¯¹è±¡ç±»åˆ«åŒ…æ‹¬ï¼š<br>æ™®é€šå¯¹è±¡ï¼š æ‹¥æœ‰JSå¯¹è±¡æ‰€æœ‰é»˜è®¤çš„å†…éƒ¨è¡Œä¸º<br>å¥‡å¼‚å¯¹è±¡ï¼šå…¶å†…éƒ¨è¡Œä¸ºåœ¨æŸäº›æ–¹é¢æœ‰åˆ«äºé»˜è®¤è¡Œä¸º<br>æ ‡å‡†å¯¹è±¡ï¼šåœ¨ES6ä¸­è¢«å®šä¹‰çš„å¯¹è±¡ï¼Œä¾‹å¦‚Arrayã€Dateç­‰ç­‰<br>å†…ç½®å¯¹è±¡ï¼šåœ¨è„šæœ¬å¼€å§‹è¿è¡Œæ—¶ç”±JSè¿è¡Œç¯å¢ƒæä¾›çš„å¯¹è±¡ã€‚<strong>æ‰€æœ‰æ ‡å‡†å¯¹è±¡éƒ½æ˜¯å†…ç½®å¯¹è±¡ã€‚</strong></p>
<h3 id="å¯¹è±¡å­—é¢é‡è¯­æ³•çš„æ‰©å±•"><a href="#å¯¹è±¡å­—é¢é‡è¯­æ³•çš„æ‰©å±•" class="headerlink" title="å¯¹è±¡å­—é¢é‡è¯­æ³•çš„æ‰©å±•"></a>å¯¹è±¡å­—é¢é‡è¯­æ³•çš„æ‰©å±•</h3><p>å¯¹è±¡å­—é¢é‡æ˜¯JSä¸­æœ€æµè¡Œçš„æ¨¡å¼ä¹‹ä¸€ï¼ˆJSONå°±æ˜¯åŸºäºè¿™ç§è¯­æ³•ï¼‰ï¼Œè€Œå®ƒè¿˜å­˜åœ¨äºäº’è”ç½‘ä¸Šçš„å‡ ä¹æ‰€æœ‰JSæ–‡ä»¶ä¸­ã€‚<br><strong>å±æ€§åˆå§‹åŒ–å™¨çš„é€Ÿè®°æ³•</strong><br>åœ¨ES5åŠæ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼Œå¯¹è±¡å­—é¢é‡æ˜¯â€œé”®å€¼å¯¹â€çš„ç®€å•é›†åˆã€‚è¿™æ„å‘³ç€åœ¨å±æ€§å€¼è¢«åˆå§‹åŒ–æ—¶å¯èƒ½ä¼šæœ‰é‡å¤ï¼ŒES6ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å±æ€§åˆå§‹åŒ–å™¨çš„é€Ÿè®°æ³•æ¥æ¶ˆé™¤å¯¹è±¡åç§°ä¸æœ¬åœ°å˜é‡çš„é‡å¤æƒ…å†µã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        name: name,</span><br><span class="line">        age: age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ES6è¯­æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cretePerson</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        name,</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•ç®€å†™</strong><br>ES6åŒæ ·æ”¹è¿›äº†ä¸ºå¯¹è±¡å­—é¢é‡æ–¹æ³•èµ‹å€¼çš„è¯­æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">"nicholas"</span>,</span><br><span class="line">    sayName() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>éœ€è®¡ç®—å±æ€§å</strong><br>å¯¹è±¡å®ä¾‹èƒ½ä½¿ç”¨â€éœ€è®¡ç®—å±æ€§åâ€œï¼Œåªè¦ç”¨æ–¹æ‹¬å·è¡¨ç¤ºæ³•æ¥æ›¿ä»£å°æ•°ç‚¹è¡¨ç¤ºæ³•å³å¯ã€‚æ–¹æ‹¬å·å…è®¸ä½ å°†å˜é‡æˆ–å­—ç¬¦ä¸²å­—é¢é‡æŒ‡å®šä¸ºå±æ€§åï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> lastName = <span class="string">'last name'</span></span><br><span class="line">person[<span class="string">'first name'</span>] = <span class="string">'nicholas'</span></span><br><span class="line">person[lastName] = <span class="string">'zakas'</span></span><br><span class="line"><span class="built_in">console</span>.log(person[<span class="string">'first name'</span>])          <span class="comment">//nicholas</span></span><br><span class="line"><span class="built_in">console</span>.log(person[lastName])              <span class="comment">//zakas</span></span><br><span class="line"><span class="built_in">console</span>.log(person.first name)             <span class="comment">//error</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥åœ¨å¯¹è±¡å­—é¢é‡ä¸­å°†å­—ç¬¦ä¸²å­—é¢é‡ç›´æ¥ç”¨ä½œå±æ€§ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="string">'first name'</span>: <span class="string">'nicholas'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(person[<span class="string">'first name'</span>])</span><br></pre></td></tr></table></figure>
<p>åœ¨ES6ä¸­ï¼Œéœ€è®¡ç®—å±æ€§åæ—¶å¯¹è±¡å­—é¢è¯­æ³•çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨çš„ä¹Ÿæ˜¯æ–¹æ‹¬å·è¡¨ç¤ºæ³•ï¼Œäºæ­¤å‰åœ¨å¯¹è±¡å®ä¾‹ä¸Šçš„ç”¨æ³•ä¸€ç›´</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lastName = <span class="string">'last name'</span></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="string">'first name'</span>: <span class="string">'nicholas'</span>,</span><br><span class="line">    [lastName]: <span class="string">'zakas'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(person[<span class="string">'first name'</span>])</span><br><span class="line"><span class="built_in">console</span>.log(person[lastName])</span><br></pre></td></tr></table></figure>
<p>å¯¹è±¡å­—é¢é‡å†…çš„æ–¹æ‹¬å·è¡¨æ˜è¯¥å±æ€§åéœ€è¦è®¡ç®—ï¼Œå…¶ç»“æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™æ„å‘³ç€å…¶ä¸­å¯ä»¥åŒ…å«è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> suffix = <span class="string">' name'</span></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    [<span class="string">'first'</span> + suffix]: <span class="string">'nicholas'</span>,</span><br><span class="line">    [<span class="string">'last'</span> + suffix]: <span class="string">'zakas'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(person[<span class="string">'first name'</span>])</span><br><span class="line"><span class="built_in">console</span>.log(person[<span class="string">'last name'</span>])</span><br></pre></td></tr></table></figure>
<h3 id="æ–°çš„æ–¹æ³•"><a href="#æ–°çš„æ–¹æ³•" class="headerlink" title="æ–°çš„æ–¹æ³•"></a>æ–°çš„æ–¹æ³•</h3><p>å½“JSä¸­è¦æ¯”è¾ƒä¸¤ä¸ªå€¼æ—¶ï¼Œå¯èƒ½ä¼šä½¿ç”¨ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ==ï¼‰æˆ–ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰ã€‚ä¸ºäº†é¿å…åœ¨æ¯”è¾ƒæ—¶å‘ç”Ÿå‰å€¼ç±»å‹è½¬åŒ–ï¼Œè®¸å¤šå¼€å‘è€…æ›´å€¾å‘ä½¿ç”¨åè€…ã€‚ä½†ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ä¹Ÿä¸å®Œå…¨æ ‡å‡†ï¼Œä¾‹å¦‚å®ƒè®¤ä¸º+0å’Œ-0ç›¸ç­‰ï¼Œå³ä½¿è¿™ä¸¤è€…åœ¨JSå¼•æ“ä¸­æœ‰ä¸åŒçš„è¡¨ç¤ºï¼›å¦å¤–NaN===NaNä¼šè¿”å›falseï¼Œå› æ­¤æœ‰å¿…è¦ä½¿ç”¨isNaN()å‡½æ•°æ¥æ­£ç¡®æ£€æŸ¥NaNï¼Œ<br>ES6å¼•å…¥äº†Object.is()æ–¹æ³•æ¥å¼¥è¡¥ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦æ®‹ç•™çš„æ€ªå¼‚ç‚¹ã€‚æ­¤æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¼šåœ¨äºŒè€…çš„å€¼ç›¸ç­‰æ—¶è¿”å›trueï¼Œæ­¤æ—¶è¦æ±‚äºŒè€…ç±»å‹ç›¸åŒå¹¶ä¸”å€¼ä¹Ÿç›¸ç­‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(+<span class="number">0</span> == <span class="number">-0</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(+<span class="number">0</span> === <span class="number">-0</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(+<span class="number">0</span>, <span class="number">-0</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">NaN</span> == <span class="literal">NaN</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">NaN</span> === <span class="literal">NaN</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(<span class="literal">NaN</span>, <span class="literal">NaN</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span> == <span class="number">5</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span> == <span class="string">"5"</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span> === <span class="number">5</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span> === <span class="string">"5"</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(<span class="number">5</span>, <span class="number">5</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(<span class="number">5</span>, <span class="string">"5"</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p><strong>Object.assignæ–¹æ³•</strong><br>æ··å…¥ï¼ˆMixinï¼‰æ˜¯åœ¨JSä¸­ç»„åˆå¯¹è±¡æ—¶æœ€æµè¡Œçš„æ¨¡å¼ã€‚å†ä¸€æ¬¡æ··å…¥ä¸­ï¼Œä¸€ä¸ªå¯¹è±¡ä¼šä»å¦ä¸€ä¸ªå¯¹è±¡ä¸­æ¥æ”¶å±æ€§ä¸æ–¹æ³•ã€‚å¾ˆå¤šJSçš„åº“ä¸­éƒ½æœ‰ç±»ä¼¼ä¸‹é¢çš„æ··å…¥æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minin</span>(<span class="params">receiver, supplier</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.keys(supplier).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">        receiver[key] = supplier[key]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> receiver</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±äºmixin()å‡½æ•°ä½¿ç”¨äº†èµ‹å€¼è¿ç®—ç¬¦ï¼ˆ=ï¼‰ï¼Œ<strong>å› æ­¤æ— æ³•å°†è®¿é—®å™¨å±æ€§å¤åˆ¶åˆ°æ¥æ”¶è€…ä¸Šï¼ŒObject.assign()ä½“ç°äº†è¿™ç§åŒºåˆ«(å³æ— æ³•å¤åˆ¶è®¿é—®å™¨å±æ€§ï¼‰ã€‚</strong><br>Object.assign() æ–¹æ³•æ¥å—ä»»æ„æ•°é‡çš„ä¾›åº”è€…ï¼Œè€Œæ¥æ”¶è€…ä¼šæŒ‰ç…§ä¾›åº”è€…åœ¨å‚æ•°ä¸­çš„é¡ºåºæ¥ä¾æ¬¡æ¥æ”¶å®ƒä»¬çš„å±æ€§ã€‚è¿™æ„å‘³ç€åœ¨æ¥æ”¶è€…ä¸­ï¼Œç¬¬äºŒä¸ªä¾›åº”è€…çš„å±æ€§å¯èƒ½ä¼šè¦†ç›–ç¬¬ä¸€ä¸ªä¾›åº”è€…çš„ï¼Œè¿™åœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­å°±å‘ç”Ÿäº†ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> receiver = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.assign(receiver,</span><br><span class="line">    &#123;</span><br><span class="line">        type: <span class="string">"js"</span>,</span><br><span class="line">        name: <span class="string">"file.js"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        type: <span class="string">"css"</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="built_in">console</span>.log(receiver.type) <span class="comment">// "css"</span></span><br><span class="line"><span class="built_in">console</span>.log(receiver.name) <span class="comment">// "file.js"</span></span><br></pre></td></tr></table></figure>
<p><strong>éœ€è¦è®°ä½ Object.assign() å¹¶æœªåœ¨æ¥æ”¶è€…ä¸Šåˆ›å»ºè®¿é—®å™¨å±æ€§ï¼Œå³ä½¿ä¾›åº”è€…æ‹¥æœ‰è®¿é—®å™¨å±æ€§ã€‚ç”±äº Object.assign() ä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œä¾›åº”è€…çš„è®¿é—®å™¨å±æ€§å°±ä¼šè½¬å˜æˆæ¥æ”¶è€…æ•°æ®å±æ€§</strong>ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> receiver = &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> supplier = &#123;</span><br><span class="line">    <span class="keyword">get</span> name() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"file.js"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.assign(receiver, supplier)</span><br><span class="line"><span class="keyword">var</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(receiver, <span class="string">"name"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(descriptor.value) <span class="comment">// "file.js"</span></span><br><span class="line"><span class="built_in">console</span>.log(descriptor.get); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p><strong>é‡å¤çš„å¯¹è±¡å­—é¢é‡å±æ€§</strong><br>ES5 ä¸¥æ ¼æ¨¡å¼ä¸ºé‡å¤çš„å¯¹è±¡å­—é¢é‡å±æ€§å¼•å…¥äº†ä¸€ä¸ªæ£€æŸ¥ï¼Œè‹¥æ‰¾åˆ°é‡å¤çš„å±æ€§åï¼Œå°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç å°±æœ‰é—®é¢˜ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">"Nicholas"</span>,</span><br><span class="line">    name: <span class="string">"Greg"</span> <span class="comment">// åœ¨ ES5 ä¸¥æ ¼æ¨¡å¼ä¸­æ˜¯è¯­æ³•é”™è¯¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½† ES6 ç§»é™¤äº†é‡å¤å±æ€§çš„æ£€æŸ¥ï¼Œä¸¥æ ¼æ¨¡å¼ä¸éä¸¥æ ¼æ¨¡å¼éƒ½ä¸å†æ£€æŸ¥é‡å¤çš„å±æ€§ã€‚å½“å­˜åœ¨é‡å¤å±æ€§æ—¶ï¼Œæ’åœ¨åé¢çš„å±æ€§çš„å€¼ä¼šæˆä¸ºè¯¥å±æ€§çš„å®é™…å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">"Nicholas"</span>,</span><br><span class="line">    name: <span class="string">"Greg"</span> <span class="comment">// åœ¨ ES6 ä¸¥æ ¼æ¨¡å¼ä¸­ä¸ä¼šå‡ºé”™</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(person.name) <span class="comment">// "Greg"</span></span><br></pre></td></tr></table></figure>
<p><strong>è‡ªæœ‰å±æ€§çš„æšä¸¾é¡ºåº</strong><br>ES5å¹¶æ²¡æœ‰å®šä¹‰å¯¹è±¡å±æ€§çš„æšä¸¾é¡ºåºã€‚ES6ä¸­åˆ™ä¸¥æ ¼å®šä¹‰äº†å¯¹è±¡è‡ªç”±å±æ€§åœ¨è¢«ç¾å‰§æ—¶è¿”å›çš„é¡ºåºã€‚è¿™å¯¹Object.getOwnPropertyNames()å’ŒReflect.ownKeyså¦‚ä½•è¿”å›å±æ€§é€ æˆäº†å½±å“ï¼ŒåŒæ ·å½±å“äº†Object.assign()å¤„ç†å±æ€§çš„é¡ºåºã€‚<br>è‡ªæœ‰å±æ€§æšä¸¾æ—¶åŸºæœ¬é¡ºåºå¦‚ä¸‹ï¼š<br>1.æ‰€æœ‰çš„æ•°å­—ç±»å‹é”®ï¼ŒæŒ‰å‡åºæ’åˆ—ï¼›<br>2.æ‰€æœ‰çš„å­—ç¬¦ä¸²ç±»å‹é”®ï¼ŒæŒ‰è¢«æ·»åŠ åˆ°å¯¹è±¡çš„é¡ºåºæ’ç±»ï¼›<br>3.æ‰€æœ‰çš„ç¬¦å·ç±»å‹é”®ï¼Œä¹ŸæŒ‰æ·»åŠ é¡ºåºæ’åˆ—ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">    c: <span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">1</span>,</span><br><span class="line">    b: <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">obj.d = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(obj).join(<span class="string">""</span>)); <span class="comment">// "012acbd"</span></span><br></pre></td></tr></table></figure>
<p><strong>for-in å¾ªç¯çš„æšä¸¾é¡ºåºä»æœªè¢«æ˜ç¡®è§„å®šï¼Œå› ä¸ºå¹¶éæ‰€æœ‰çš„ JS å¼•æ“éƒ½é‡‡ç”¨ç›¸åŒçš„æ–¹å¼ã€‚è€Œ Object.keys() å’Œ JSON.stringify() ä¹Ÿä½¿ç”¨äº†ä¸ for-in ä¸€æ ·çš„æšä¸¾é¡ºåºã€‚</strong><br><strong>æ›´å¼ºå¤§çš„åŸå‹</strong><br>ä¿®æ”¹å¯¹è±¡çš„åŸå‹<br>ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹è±¡çš„åŸå‹ä¼šåœ¨é€šè¿‡æ„é€ å™¨æˆ– Object.create() æ–¹æ³•åˆ›å»ºè¯¥å¯¹è±¡æ—¶è¢«æŒ‡å®šã€‚ç›´åˆ°ES5 ä¸ºæ­¢ï¼Œ JS ç¼–ç¨‹æœ€é‡è¦çš„å‡å®šä¹‹ä¸€å°±æ˜¯å¯¹è±¡çš„åŸå‹åœ¨åˆå§‹åŒ–å®Œæˆåä¼šä¿æŒä¸å˜ã€‚å°½ç®¡ES5 æ·»åŠ äº† Object.getPrototypeOf() æ–¹æ³•æ¥ä»ä»»æ„æŒ‡å®šå¯¹è±¡ä¸­è·å–å…¶åŸå‹ï¼Œä½†ä»ç„¶ç¼ºå°‘åœ¨åˆå§‹åŒ–ä¹‹åæ›´æ”¹å¯¹è±¡åŸå‹çš„æ ‡å‡†æ–¹æ³•ã€‚<br>ES6 é€šè¿‡æ·»åŠ  Object.setPrototypeOf() æ–¹æ³•è€Œæ”¹å˜äº†è¿™ç§å‡å®šï¼Œæ­¤æ–¹æ³•å…è®¸ä½ ä¿®æ”¹ä»»æ„æŒ‡å®šå¯¹è±¡çš„åŸå‹ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šéœ€è¦è¢«ä¿®æ”¹åŸå‹çš„å¯¹è±¡ï¼Œä»¥åŠå°†ä¼šæˆä¸ºå‰è€…åŸå‹çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> dog = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Woof"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹ä¸º person</span></span><br><span class="line"><span class="keyword">let</span> friend = <span class="built_in">Object</span>.create(person);</span><br><span class="line"><span class="built_in">console</span>.log(friend.getGreeting()); <span class="comment">// "Hello"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(friend) === person); <span class="comment">// true</span></span><br><span class="line"><span class="comment">// å°†åŸå‹è®¾ç½®ä¸º dog</span></span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf(friend, dog);</span><br><span class="line"><span class="built_in">console</span>.log(friend.getGreeting()); <span class="comment">// "Woof"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(friend) === dog); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>å¯¹è±¡åŸå‹çš„å®é™…å€¼è¢«å­˜å‚¨åœ¨ä¸€ä¸ªå†…éƒ¨å±æ€§[[Prototype]]ä¸Šï¼ŒObject.getPrototypeOf()æ–¹æ³•ä¼šè¿”å›æ­¤å±æ€§å­˜å‚¨çš„å€¼ï¼Œè€ŒObject.setPrototypeOf()æ–¹æ³•èƒ½å¤Ÿä¿®æ”¹è¯¥å€¼ã€‚<br><strong>ä½¿ç”¨superå¼•ç”¨çš„ç®€å•åŸå‹è®¿é—®</strong><br>å…³äºåŸå‹çš„å¦ä¸€é¡¹è¿›æ­¥å°±æ˜¯å¼•å…¥äº†superå¼•ç”¨ï¼Œè¿™è®©åœ¨å¯¹è±¡åŸå‹ä¸Šçš„åŠŸèƒ½è°ƒç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ä¾‹å¦‚è‹¥è¦è¦†ç›–å¯¹è±¡å®ä¾‹çš„ä¸€ä¸ªæ–¹æ³•ã€ä½†ä¾ç„¶è¦è°ƒç”¨åŸå‹ä¸Šçš„åŒåæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼ˆä»¥ä¸‹ä»£ç ä¸ºES5çš„å®ç°æ–¹æ¡ˆï¼‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'hello'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> dog = &#123;</span><br><span class="line">	name: <span class="string">'daming'</span>,</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="comment">// return 'woof' + this.name</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'woof'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> friend = &#123;</span><br><span class="line">	name: <span class="string">'friend'</span>,</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.getPrototypeOf(<span class="keyword">this</span>).getGreeting.call(<span class="keyword">this</span>) + <span class="string">', hi'</span>         <span class="comment">//è¿™é‡Œçš„thisæŒ‡å‘friendï¼Œå¯ä»¥é€šè¿‡this.nameéªŒè¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf(friend, person)</span><br><span class="line"><span class="built_in">console</span>.log(friend.getGreeting())                             <span class="comment">//hello, hi</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(friend) === person)         <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf(friend, dog)</span><br><span class="line"><span class="built_in">console</span>.log(friend.getGreeting())                             <span class="comment">//woof, hi</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(friend) === dog)            <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºthisçš„æŒ‡å‘è¿‡äºå¤æ‚ã€‚ES6ä¸­å¼•å…¥superã€‚ç®€å•è¯´ï¼Œsuperæ˜¯æŒ‡å‘å½“å‰å¯¹è±¡çš„åŸå‹çš„ä¸€ä¸ªæŒ‡é’ˆï¼Œå®é™…ä¸Šå°±æ˜¯Object.getPrototypeOf(this)çš„å€¼ã€‚ç”±æ­¤ç®€åŒ–friendä¸­çš„getGreet()æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> friend = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">    <span class="comment">// è¿™ç›¸å½“äºä¸Šä¸ªä¾‹å­ä¸­çš„ï¼š</span></span><br><span class="line">    <span class="comment">// Object.getPrototypeOf(this).getGreeting.call(this)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getGreeting() + <span class="string">", hi!"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„è°ƒç”¨super.getGreeting()ç­‰ç”¨äºåœ¨ä¸Šä¾‹çš„ç¯å¢ƒä¸­ä½¿ç”¨Object.getPrototypeOf(this).getGreeting.call(this).ç±»ä¼¼çš„ï¼Œèƒ½ä½¿ç”¨superå¼•ç”¨æ¥è°ƒç”¨å¯¹è±¡åŸå‹ä¸Šçš„ä»»ä½•æ–¹æ³•ï¼Œ<strong>åªè¦è¿™ä¸ªå¼•ç”¨æ—¶ä½äºç®€å†™çš„æ–¹æ³•ä¹‹å†…</strong>ã€‚è¯•å›¾åœ¨æ–¹æ³•æ¥å¸ä¹‹å¤–çš„æƒ…å†µä½¿ç”¨superä¼šå¯¼è‡´è¯­æ³•é”™è¯¯ï¼Œ<strong>åœ¨è¿™ç§ä¸Šä¸‹æ–‡ä¸­ super æ˜¯ä¸å¯ç”¨çš„ï¼šé”™è¯¯ä¿¡æ¯ï¼ˆSyntaxError: â€˜superâ€™ keyword unexpected hereï¼‰</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> friend = &#123;</span><br><span class="line">    getGreeting: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getGreeting() + <span class="string">', hi'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å¤šç»§æ‰¿æ—¶ï¼Œsuperå¼•ç”¨åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹ï¼ŒObject.getPrototypeOf()ä¸å†é€‚ç”¨äºæ‰€æœ‰åœºæ™¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'hello'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> friend = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="comment">// console.log('%%%%%%%%%%%%%%%%')</span></span><br><span class="line">    	<span class="comment">// console.log(this === relative)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.getPrototypeOf(<span class="keyword">this</span>).getGreeting.call(<span class="keyword">this</span>) + <span class="string">',hi'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf(friend, person)</span><br><span class="line"><span class="keyword">let</span> relative = <span class="built_in">Object</span>.create(friend)</span><br><span class="line"><span class="built_in">console</span>.log(person.getGreeting())                   <span class="comment">//hello</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.getGreeting())                   <span class="comment">//hello, hi</span></span><br><span class="line"><span class="built_in">console</span>.log(relative.getGreeting())                 <span class="comment">//error</span></span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨ Object.getPrototypeOf() æ—¶ï¼Œåœ¨è°ƒç”¨ relative.getGreeting() å¤„å‘ç”Ÿäº†é”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºæ­¤æ—¶ this çš„å€¼æ˜¯ relative ï¼Œè€Œ relative çš„åŸå‹æ˜¯ friend å¯¹è±¡ï¼Œè¿™æ ·<br>friend.getGreeting().call() è°ƒç”¨å°±ä¼šå¯¼è‡´è¿›ç¨‹å¼€å§‹åå¤è¿›è¡Œé€’å½’è°ƒç”¨ï¼Œç›´åˆ°å‘ç”Ÿå †æ ˆé”™è¯¯ã€‚(åŸå› åœ¨äºthiså¼•ç”¨çš„ä¸€ç›´éƒ½æ˜¯relative)<br>åœ¨ES6ä¸­ï¼Œåˆ©ç”¨superå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹ä¸º person</span></span><br><span class="line"><span class="keyword">let</span> friend = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getGreeting() + <span class="string">", hi!"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf(friend, person)</span><br><span class="line"><span class="comment">// åŸå‹ä¸º friend</span></span><br><span class="line"><span class="keyword">let</span> relative = <span class="built_in">Object</span>.create(friend)</span><br><span class="line"><span class="built_in">console</span>.log(person.getGreeting()) <span class="comment">// "Hello"</span></span><br><span class="line"><span class="built_in">console</span>.log(friend.getGreeting()) <span class="comment">// "Hello, hi!"</span></span><br><span class="line"><span class="built_in">console</span>.log(relative.getGreeting()) <span class="comment">// "Hello, hi!"</span></span><br></pre></td></tr></table></figure>
<p><strong>æ­£å¼çš„â€œæ–¹æ³•â€å®šä¹‰</strong><br>åœ¨ES6ä¹‹å‰ï¼Œâ€œæ–¹æ³•â€çš„æ¦‚å¿µä»æœªè¢«æ­£å¼å®šä¹‰ï¼Œæ­¤å‰ç¦æ­¢å¯¹è±¡çš„å‡½æ•°å±æ€§ï¼ˆè€Œéæ•°æ®å±æ€§ï¼‰ã€‚ES6ä¸­æ­£äº‹åšå‡ºäº†å®šä¹‰ï¼šæ–¹æ³•æ—¶ä¸€ä¸ªæ‹¥æœ‰[[HomeObject]]å†…éƒ¨å±æ€§çš„å‡½æ•°ï¼Œæ­¤å†…éƒ¨å±æ€§æŒ‡å‘è¯¥æ–¹æ³•æ‰€å±çš„å¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shareGreeting</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hi'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»»ä½•å¯¹ super çš„å¼•ç”¨éƒ½ä¼šä½¿ç”¨ [[HomeObject]] å±æ€§æ¥åˆ¤æ–­è¦åšä»€ä¹ˆã€‚ç¬¬ä¸€æ­¥æ˜¯åœ¨[[HomeObject]] ä¸Šè°ƒç”¨ Object.getPrototypeOf() æ¥è·å–å¯¹åŸå‹çš„å¼•ç”¨ï¼›æ¥ä¸‹æ¥ï¼Œåœ¨è¯¥åŸå‹<br>ä¸ŠæŸ¥æ‰¾åŒåå‡½æ•°ï¼›æœ€åï¼Œåˆ›å»º this ç»‘å®šå¹¶è°ƒç”¨è¯¥æ–¹æ³•ã€‚è¿™é‡Œæœ‰ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŸå‹ä¸º person</span></span><br><span class="line"><span class="keyword">let</span> friend = &#123;</span><br><span class="line">    getGreeting() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getGreeting() + <span class="string">", hi!"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf(friend, person)</span><br><span class="line"><span class="built_in">console</span>.log(friend.getGreeting()) <span class="comment">// "Hello, hi!"</span></span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨ friend.getGreeting() è¿”å›äº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯ person.getGreeting() çš„è¿”å›å€¼ä¸â€, hi!â€ çš„åˆå¹¶ç»“æœã€‚æ­¤æ—¶ friend.getGreeting() çš„ [[HomeObject]] å€¼æ˜¯ friend ï¼Œå¹¶ä¸”friend çš„åŸå‹æ˜¯ person ï¼Œå› æ­¤ super.getGreeting() å°±ç­‰ä»·äºperson.getGreeting.call(this) ã€‚</p>
<h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p>ECMAScriptä¸­æè¿°äº†<strong>åŸå‹é“¾</strong>çš„æ¦‚å¿µï¼Œå¹¶å°†åŸå‹é“¾ä½œä¸ºå®ç°ç»§æ‰¿çš„ä¸»è¦æ–¹æ³•ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯åˆ©ç”¨åŸå‹è®©ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§æ‰¿å¦ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ã€‚<br>å®ç°åŸå‹é“¾æœ‰ä¸€ç§åŸºæœ¬æ¨¡å¼ï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.property = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.property</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subproperty = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.subproperty</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.getSuperValue())         <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(instance.constructor)             <span class="comment">//SuperType</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å®ç°åŸå‹é“¾ï¼Œæœ¬è´¨ä¸Šæ‰©å±•äº†æœ¬ç« å‰é¢ä»‹ç»çš„åŸå‹æœç´¢æœºåˆ¶ã€‚å³ï¼Œå½“ä¸€åº¦å»æ¨¡å¼è®¿é—®ä¸€ä¸ªå®ä¾‹å±æ€§æ˜¯ï¼Œé¦–å…ˆä¼šåœ¨å®åŠ›ä¸Šæœç´¢æ”¹å±æ€§ï¼Œæœæœæ²¡æœ‰æ‰¾åˆ°æ”¹å±æ€§ï¼Œåˆ™ä¼šç»§ç»­æœç´¢å®ä¾‹çš„åŸå‹ï¼Œå†é€šè¿‡åŸå‹é“¾å®ç°é›†æˆçš„è¯·æ¬¾è¥¿ï¼Œæœç´¢è¿‡ç¨‹å°±å¾—ä»¥æ²¿ç€åŸå‹é“¾ç»§ç»­å‘ä¸Šã€‚å°±æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œæ¡ç”¨instance.getSuperValue()ä¼šç»å†ä¸‰ä¸ªæœç´¢æ­¥éª¤ï¼š1ï¼‰æœç´¢å®ä¾‹ï¼›2ï¼‰æœç´¢SubType.prototypeï¼›3ï¼‰æœç´¢SuperType.prototypeï¼Œæœ€åä¸€æ­¥æ‰ä¼šæ‰¾åˆ°è¯¥æ–¹æ³•ã€‚å†æ‰¾ä¸åˆ°å±æ€§æˆ–æ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œæœç´¢è¿‡ç¨‹æ€»æ˜¯è¦ä¸€ç¯ä¸€ç¯åœ°å‰è¡Œåˆ°åŸå‹é“¾æœ«ç«¯æ‰ä¼šåœä¸‹æ¥ã€‚<br><strong>é»˜è®¤çš„åŸå‹</strong><br>ä¹‹å‰çš„ä¾‹å­ä¸­å±•ç¤ºçš„åŸå‹é“¾è¿˜å°‘ä¸€ç¯ã€‚æ‰€æœ‰å¼•ç”¨ç±»å‹é»˜è®¤éƒ½ç»§æ‰¿äº†Objectï¼Œè€Œè¿™ä¸ªç»§æ‰¿ä¹Ÿæ˜¯é€šè¿‡åŸå‹é“¾å®ç°çš„ã€‚æ‰€æœ‰å‡½æ•°çš„é»˜è®¤åŸå‹éƒ½æ˜¯Objectçš„å®ä¾‹ã€‚å› æ­¤é»˜è®¤å†…æºæ€§éƒ½ä¼šåŒ…å«ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆï¼ŒæŒ‡å‘Object.prototypeã€‚è¿™ä¹Ÿæ˜¯æ‰€æœ‰è‡ªå®šä¹‰ç±»å‹éƒ½ä¼šç»§æ‰¿toString()ã€valueOf()ç­‰é»˜è®¤æ–¹æ³•çš„æ ¹æœ¬åŸå› ã€‚<br><strong>SubTypeç»§æ‰¿äº†SuperTypeï¼Œè€ŒSuperTypeç»§æ‰¿äº†Objectã€‚</strong><br><strong>ç¡®å®šåŸå‹å’Œå®ä¾‹å…³ç³»</strong><br>å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥ç¡®å®šåŸå‹å’Œå®ä¾‹ä¹‹é—´çš„å…³ç³»ã€‚ç¬¬ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨instanceofæ“ä½œç¬¦ã€‚åªè¦ç”¨è¿™ä¸ªæ“ä½œç¬¦æ¥æµ‹è¯•å®ä¾‹ä¸åŸå‹é“¾ä¸­å‡ºç°è¿‡çš„æ„é€ å‡½æ•°ï¼Œç»“æœå°±å›è¿”å›trueã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> <span class="built_in">Object</span>)                <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> SuperType)             <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> SubType)               <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>ç”±äºåŸå‹é“¾çš„å…³ç³»ï¼Œå¯ä»¥è¯´instanceæ˜¯Objectã€SuperTypeæˆ–SubTypeä¸­ä»»ä½•ä¸€ä¸ªç±»å‹çš„å®ä¾‹ã€‚<br>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨isPrototypeOf()æ–¹æ³•ã€‚åŒæ ·ï¼Œåªè¦æ˜¯åŸå‹é“¾ä¸­å‡ºç°è¿‡çš„åŸå‹ï¼Œéƒ½å¯ä»¥è¯´æ˜¯è¯¥åŸå‹é“¾æ´¾ç”Ÿçš„å®ä¾‹çš„åŸå‹ã€‚å› æ­¤isPrototypeOf()æ–¹æ³•ä¹Ÿä¼šè¿”å›trueï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.isPrototypeOf(instance))     <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(SuperType.prototype.isPrototypeOf(instance))  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(SubType.prototoye.insPrototypeOf(instance))   <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p><strong>è°¨æ…çš„å®šä¹‰æ–¹æ³•</strong><br>å­ç±»å‹æœ‰æ—¶å€™éœ€è¦é‡å†™è¶…ç±»å‹ä¸­çš„æŸä¸ªæ–¹æ³•ï¼Œæˆ–è€…éœ€è¦æ·»åŠ è¶…ç±»å‹ä¸­ä¸å­˜åœ¨çš„æŸä¸ªæ–¹æ³•ã€‚ä½†ä¸ç®¡æ€ä¹ˆæ ·ï¼Œç»™åŸå‹æ·»åŠ æ–¹æ³•çš„ä»£ç ä¸€å®šè¦æ”¾åœ¨æ›¿æ¢åŸå‹çš„è¯­å¥ä¹‹åã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.property = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.property</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subproperty = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.subproperty</span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.getSuperValue())              <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦ä¸€ä¸ªç»§æ‰¿SuperTypeçš„å¯¹è±¡å¯¹getSuperValue()çš„å¼•ç”¨æœªå‘ç”Ÿæ”¹å˜</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anSubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.anSubProperty = <span class="string">'hhh'</span></span><br><span class="line">&#125;</span><br><span class="line">anSubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line">anSubType.prototype.getanSubProperty = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.anSubProperty</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> anInstance = <span class="keyword">new</span> anSubType()</span><br><span class="line"><span class="built_in">console</span>.log(anInstance.getSuperValue())             <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>å½“é€šè¿‡SubTypeçš„å®ä¾‹è°ƒç”¨getSuperValue()æ—¶ï¼Œè°ƒç”¨çš„å°±æ˜¯è¿™ä¸ªé‡æ–°å®šä¹‰çš„æ–¹æ³•ï¼›ä½†é€šè¿‡SuperTypeçš„å®ä¾‹è°ƒç”¨getSuperValue()æ—¶ï¼Œè¿˜ä¼šç»§ç»­è°ƒç”¨åŸæ¥çš„é‚£ä¸ªæ–¹æ³•ã€‚<br>è¿™é‡Œè¦æ ¼å¤–æ³¨æ„çš„æ—¶ï¼Œ<strong>å¿…é¡»åœ¨ç”¨SuperTypeçš„å®ä¾‹æ›¿æ¢åŸå‹ä¹‹åï¼Œå†å®šä¹‰è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚</strong><br>é™¤é»˜è®¤åŸå‹å¤–ï¼Œå…¶ä»–å®ä¾‹ä¸­ä¸åŒ…å«æŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆï¼Œè¿™ä¹Ÿå°±æ˜¯å›¾6-5ä¸­å±•ç°å‡ºçš„å½¢å¼ï¼Œå³SubType.prototypeä¸åŒ…å«constructorå±æ€§ï¼Œå› ä¸ºå®ƒæ˜¯ç”±SuperTypeç”Ÿæˆçš„å®ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(SubType.prototype.constructor)               <span class="comment">//SuperType</span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œå³åœ¨é€šè¿‡åŸå‹é“¾å®ç°ç»§æ‰¿ï¼Œä¸èƒ½ä½¿ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºåŸå‹æ–¹æ³•ï¼Œå› ä¸ºè¿™æ ·åšå°±ä¼šé‡å†™åŸå‹é“¾:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.property = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.property</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subproperty = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line">SubType.prototype = &#123;</span><br><span class="line">    getSubValue: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.subproperty</span><br><span class="line">    &#125;,</span><br><span class="line">    getSuperValue: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype.</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.getSuperValue())               <span class="comment">//error</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç å±•ç¤ºäº†åˆšåˆšæŠŠSuperTypeçš„å®ä¾‹èµ‹å€¼ç»™åŸå‹é“¾ï¼Œç´§æ¥ç€åˆå°†åŸå‹æ›¿æ¢æˆä¸€ä¸ªå¯¹è±¡å­—é¢é‡è€Œå¯¼è‡´çš„é—®é¢˜ã€‚ç”±äºç°åœ¨çš„åŸå‹åŒ…å«çš„æ˜¯ä¸€ä¸ªObjectçš„å®ä¾‹ï¼Œè€ŒéSuperTypeçš„å®ä¾‹ï¼Œä¸€æ¬¡åŸå‹é“¾å·²ç»è¢«åˆ‡æ–­ã€‚<br><strong>æ­¤å¤„ç»§æ‰¿å’Œé€šè¿‡åŸå‹æ„é€ å®ä¾‹çš„å¯¹è±¡å­—é¢é‡æ–¹å¼çš„åŒºåˆ«ä¸è”ç³»åœ¨äºï¼š</strong></p>
<p><strong>åŸå‹é“¾çš„é—®é¢˜</strong><br>åŸå‹é“¾è™½ç„¶å¾ˆå¼ºå¤§ï¼Œå¯ä»¥ç”¨å®ƒæ¥å®ç°ç»§æ‰¿ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚å…¶ä¸­æœ€ä¸»è¦çš„é—®é¢˜æ¥è‡ªåŒ…å«å¼•ç”¨ç±»å‹å€¼çš„åŸå‹ã€‚åŒ…å«å¼•ç”¨ç±»å‹å€¼çš„åŸå‹å±æ€§ä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«ï¼Œè¿™ä¹Ÿæ­£æ˜¯ä¸ºä»€ä¹ˆè¦åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè€Œä¸æ˜¯åœ¨åŸå‹å¯¹è±¡ä¸­å®šä¹‰å±æ€§çš„åŸå› ã€‚åœ¨é€šè¿‡åŸå‹æ¥å®ç°ç»§æ‰¿æ—¶ï¼ŒåŸå‹å®é™…ä¸Šä¼šå˜æˆå¦ä¸€ä¸ªç±»å‹çš„å®ä¾‹ã€‚äºæ˜¯ï¼ŒåŸå…ˆçš„å®ä¾‹å±æ€§ä¹Ÿå°±é¡ºç†æˆç« åœ°å˜æˆäº†ç°åœ¨çš„åŸå‹å±æ€§äº†ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'green'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType()</span><br><span class="line">instance1.colors.push(<span class="string">'black'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance1.colors)            <span class="comment">//red, blue, green, black</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance2.colors)            <span class="comment">//red, blue, green, black</span></span><br></pre></td></tr></table></figure>
<p>åŸå‹é“¾çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼šåœ¨åˆ›å»ºiä¹‹ç±»æ€§çš„å®ä¾‹æ—¶ï¼Œä¸èƒ½å‘è¶…ç±»å‹çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’å‚æ•°ã€‚å®é™…ä¸Šï¼Œåº”è¯¥è¯´æ˜¯æ²¡æœ‰åŠæ³•åœ¨ä¸å½±å“æ‰€æœ‰å¯¹è±¡å®ä¾‹çš„æƒ…å†µä¸‹ï¼Œç»™è¶…ç±»å‹çš„æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚</p>
<h2 id="å€Ÿç”¨æ„é€ å‡½æ•°"><a href="#å€Ÿç”¨æ„é€ å‡½æ•°" class="headerlink" title="å€Ÿç”¨æ„é€ å‡½æ•°"></a>å€Ÿç”¨æ„é€ å‡½æ•°</h2><p>åœ¨è§£å†³åŸå‹ä¸­åŒ…å«å¼•ç”¨ç±»å‹å€¼æ‰€å¸¦æ¥é—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œå¼€å§‹ä½¿ç”¨ä¸€ç§å«åšå€Ÿç”¨æ„é€ å‡½æ•°çš„æŠ€æœ¯ã€‚å…¶åŸºæœ¬æ€æƒ³ä¸ºåœ¨å­ç±»å‹æ„é€ å‡½æ•°çš„å†…éƒ¨è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°ã€‚**å‡½æ•°åªä¸è¿‡æ˜¯åœ¨ç‰¹å®šç¯å¢ƒä¸­æ‰§è¡Œä»£ç çš„å¯¹è±¡ï¼Œå› æ­¤é€šè¿‡ä½¿ç”¨apply()å’Œcall()æ–¹æ³•ä¹Ÿå¯ä»¥åœ¨ï¼ˆå°†æ¥ï¼‰åˆ›å»ºçš„å¯¹è±¡ä¸Šæ‰§è¡Œæ„é€ å‡½æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'green'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//ç»§æ‰¿äº†SuperType</span></span><br><span class="line">    SuperType.call(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType()</span><br><span class="line">instance1.colors.push(<span class="string">'black'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance1.colors)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance2.colors)</span><br></pre></td></tr></table></figure>
<p>ä»£ç ä¸­æ³¨é‡Šâ€ç»§æ‰¿äº†SuperTypeâ€é‚£ä¸€è¡Œä»£ç å€Ÿè°ƒäº†è¶…ç±»å‹çš„æ„é€ å‡½æ•°ã€‚é€šè¿‡ä½¿ç”¨call()æ–¹æ³•å’Œapply()æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯åœ¨æ–°åˆ›å»ºçš„SubTypeå®ä¾‹çš„ç¯å¢ƒä¸‹è°ƒç”¨äº†SuperTypeæ„é€ å‡½æ•°ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±å›åœ¨æ–°SubTypeå¯¹è±¡ä¸Šæ‰§è¡ŒSuperType()å‡½æ•°ä¸­å®šä¹‰çš„æ‰€æœ‰å¯¹è±¡åˆå§‹åŒ–ä»£ç ï¼ˆå®é™…ä¸Šåˆ©ç”¨thisç»‘å®šåˆ°æ–°å¯¹è±¡ï¼‰ï¼Œç”±æ­¤ï¼ŒSubTypeçš„æ¯ä¸ªå®ä¾‹å°±éƒ½ä¼šå…·æœ‰è‡ªå·±çš„colorså±æ€§çš„å‰¯æœ¬ã€‚<br><strong>ä¼ é€’å‡½æ•°</strong><br>ç›¸å¯¹äºåŸå‹é“¾è€Œè¨€ï¼Œå€Ÿç”¨æ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŠ¿ï¼š å³å¯ä»¥åœ¨å­ç±»å‹æ„é€ å‡½æ•°ä¸­å‘è¶…ç±»å‹æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ï¼Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    SuperType.call(<span class="keyword">this</span>, <span class="string">"Nicholas"</span>)</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">19</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.name)                   <span class="comment">//Nicholas</span></span><br><span class="line"><span class="built_in">console</span>.log(instance.age)                    <span class="comment">//19</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç ä¸­çš„SuperTypeåªæ¥æ”¶ä¸€ä¸ªå‚æ•°nameï¼Œè¯¥å‚æ•°ä¼šç›´æ¥èµ‹ç»™ä¸€ä¸ªå±æ€§ï¼Œåœ¨SubTypeæ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨SuperTypeæ„é€ å‡½æ•°æ—¶ï¼Œå®é™…ä¸Šæ˜¯ä¸ºSubTypeçš„å®ä¾‹è®¾ç½®äº†nameå±æ€§ã€‚ä¸ºä¿è¯SuperTypeæ„é€ å‡½æ•°ä¸ä¼šé‡å†™å­ç±»å‹çš„å±æ€§ï¼Œå¯ä»¥åœ¨è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°åï¼Œå†æ·»åŠ åº”è¯¥åœ¨å­ç±»å‹ä¸­å®šä¹‰çš„å±æ€§ã€‚<br><strong>å€Ÿç”¨æ„é€ å‡½æ•°çš„é—®é¢˜</strong><br>å¦‚æœä»…ä»…æ˜¯å€Ÿç”¨æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆä¹Ÿå°†æ— æ³•é¿å…æ„é€ å‡½æ•°æ¨¡å¼å­˜åœ¨çš„é—®é¢˜â€”â€”â€”â€”æ–¹æ³•éƒ½åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ï¼Œå› æ­¤æ— æ³•è¿›è¡Œå‡½æ•°å¤ç”¨ã€‚è€Œä¸”ï¼Œåœ¨è¶…ç±»å‹çš„åŸå‹ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå¯¹å­ç±»å‹è€Œè¨€ä¹Ÿæ˜¯ä¸å¯è§çš„ï¼Œç»“æœæ‰€æœ‰ç±»å‹éƒ½åªèƒ½ä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼ã€‚</p>
<h3 id="ç»„åˆç»§æ‰¿"><a href="#ç»„åˆç»§æ‰¿" class="headerlink" title="ç»„åˆç»§æ‰¿"></a>ç»„åˆç»§æ‰¿</h3><p>ç»„åˆç»§æ‰¿æœ‰æ—¶å€™ä¹Ÿå«åšä¼ªç»å…¸ç»§æ‰¿ï¼ŒæŒ‡çš„æ˜¯å°†åŸå‹é“¾å’Œå€Ÿç”¨æ„é€ å‡½æ•°çš„æŠ€æœ¯ç»“åˆåˆ°ä¸€èµ·ã€‚å…¶æ€è·¯æ˜¯ä½¿ç”¨åŸå‹é“¾å®ç°å¯¹åŸå‹å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ï¼Œè€Œé€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥å®ç°å¯¹å®ä¾‹å±æ€§çš„ç»§æ‰¿ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'green'</span>]</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    SuperType.call(<span class="keyword">this</span>, name)</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.age)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType(<span class="string">"Nicholas"</span>, <span class="number">19</span>)</span><br><span class="line">instance1.colors.push(<span class="string">"black"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance1.colors)</span><br><span class="line">instance1.sayName()</span><br><span class="line">instance1.sayAge()</span><br><span class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType(<span class="string">"Greg"</span>, <span class="number">17</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance2.colors)</span><br><span class="line">instance2.sayName()</span><br><span class="line">instance2.sayAge()</span><br></pre></td></tr></table></figure>
<p>instanceofå’ŒisPrototypeOf()ä¹Ÿèƒ½å¤Ÿç”¨äºè¯†åˆ«åŸºäºç»„åˆç»§æ‰¿åˆ›å»ºçš„å¯¹è±¡ã€‚</p>
<h3 id="åŸå‹å¼ç»§æ‰¿"><a href="#åŸå‹å¼ç»§æ‰¿" class="headerlink" title="åŸå‹å¼ç»§æ‰¿"></a>åŸå‹å¼ç»§æ‰¿</h3><p>è¯¥æ–¹å¼çš„åŸºæœ¬æƒ³æ³•ä¸ºå€ŸåŠ©åŸå‹å¯ä»¥åŸºäºå·²æœ‰çš„å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡ï¼ŒåŒæ—¶è¿˜ä¸å¿…å› æ­¤åˆ›å»ºè‡ªå®šä¹‰ç±»å‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">object</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        F.prototype = o</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> F()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨object()å‡½æ•°å†…éƒ¨ï¼Œå…ˆåˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ€§çš„æ„é€ å‡½æ•°ï¼Œç„¶åå°†ä¼ å…¥çš„å¯¹è±¡å·¦å³è¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹ï¼Œæœ€åè¿”å›äº†è¿™ä¸ªä¸´æ—¶ç±»å‹çš„æ–°å®ä¾‹ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œobject()å¯¹ä¼ å…¥å…¶ä¸­çš„å¯¹è±¡æ‰§è¡Œäº†ä¸€æ¬¡æµ…å¤åˆ¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">'Nicholas'</span>,</span><br><span class="line">    friends: [<span class="string">'shelby'</span>, <span class="string">'court'</span>, <span class="string">'van'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> anotherPerson = object(person)</span><br><span class="line">anotherPerson.name = <span class="string">'Greg'</span></span><br><span class="line">anotherPerson.friends.push(<span class="string">'rob'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yetAnotherPerson = object(person)</span><br><span class="line">yetAnotherPerson.name = <span class="string">'linda'</span></span><br><span class="line">yetAnotherPerson.friends.push(<span class="string">'barbie'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person.friends)                    <span class="comment">//'shelby', 'court', 'van', 'rob'</span></span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šï¼Œä¸Šè¿°ä»£ç ç›¸å½“äºåˆåˆ›å»ºäº†personçš„ä¸¤ä¸ªå‰¯æœ¬<br>ECMAScript5é€šè¿‡Object.create()æ–¹æ³•è§„èŒƒåŒ–äº†åŸå‹å¼ç»§æ‰¿ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªç”¨ä½œæ–°å¯¹è±¡åŸå‹çš„å¯¹è±¡å’Œï¼ˆå¯é€‰çš„ï¼‰ä¸€ä¸ªä¸ºæ–°å¯¹è±¡å®šä¹‰é¢å¤–å±æ€§çš„å¯¹è±¡ã€‚åœ¨ä¼ å…¥ä¸€ä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼ŒObject.create()å’ŒObject()æ–¹æ³•çš„è¡Œä¸ºç›¸åŒã€‚(<strong>æ³¨æ„åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«</strong>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">'Nicholas'</span>,</span><br><span class="line">    friends: [<span class="string">'shelby'</span>, <span class="string">'count'</span>, <span class="string">'van'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> anotherPerson = <span class="built_in">Object</span>.create(person)</span><br><span class="line">aontherPerson.name = <span class="string">'Greg'</span></span><br><span class="line">anotherPerson.friends.push(<span class="string">'Rob'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yetAnotherPerson = <span class="built_in">Object</span>.create(person)</span><br><span class="line">yetAnotherPerson.name = <span class="string">'Linda'</span></span><br><span class="line">yetAnotherPerson.friends.push(<span class="string">'Barbie'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(person.friends)                <span class="comment">//'shelby', 'count', 'van', 'Rob', 'Barbie'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person2 = &#123;</span><br><span class="line">    name: <span class="string">'nicholas'</span>,</span><br><span class="line">    friends: [<span class="string">'shelby'</span>, <span class="string">'count'</span>, <span class="string">'van'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> anotherPerson = <span class="built_in">Object</span>.create(person, &#123;</span><br><span class="line">    name: &#123;</span><br><span class="line">        value: <span class="string">'greg'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(anotherPerson.name)                <span class="comment">//greg</span></span><br><span class="line"><span class="built_in">console</span>.log(anotherPerson)                     <span class="comment">//&#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(person)                            <span class="comment">//&#123; name: 'nicholas', friends: [ 'shelby', 'count', 'van' ] &#125;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ²¡å¿…è¦ä½¿ç”¨æ„é€ å‡½æ•°ï¼Œåªæƒ³è®©ä¸€ä¸ªå¯¹è±¡ä¸å¦ä¸€ä¸ªå¯¹è±¡ä¿æŒç±»ä¼¼çš„æƒ…å†µè¥¿ï¼ŒåŸå‹å¼ç»§æ‰¿å®Œå…¨å¯ä»¥èƒœä»»ã€‚ä¸è¿‡ï¼ŒåŒ…å«å¼•ç”¨ç±»å‹å€¼çš„å±æ€§å§‹ç»ˆéƒ½ä¼šå…±äº«ç›¸åº”çš„å€¼ï¼Œå°±åƒä½¿ç”¨åŸå‹æ¨¡å¼ä¸€æ ·ã€‚</p>
<h3 id="å¯„ç”Ÿå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿå¼ç»§æ‰¿"></a>å¯„ç”Ÿå¼ç»§æ‰¿</h3><p>å¯„ç”Ÿå¼ç»§æ‰¿æ˜¯ä¸åŸå‹å¼ç»§æ‰¿ç›¸å…³çš„ä¸€ç§æ€è·¯ã€‚å¯„ç”Ÿå¼ç»§æ‰¿çš„æ€è·¯ä¸å¯„ç”Ÿæ„é€ å‡½æ•°å’Œå·¥å‚æ¨¡å¼ç±»ä¼¼ï¼Œå³èˆ¹èˆ°ä¸€ä¸ªä»…ç”¨äºå°è£…å‡»æ²‰è¿‡ç¨‹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨å†…éƒ¨ä»¥æŸç§æ„¤æ€’æ—¶æ¥å¢å¼ºå¯¹è±¡ï¼Œæœ€åå†åƒçœŸçš„æ˜¯ä»–åšäº†æ‰€æœ‰å·¥ä½œä¸€æ ·è¿”å›å¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createAnother</span>(<span class="params">original</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> clone = object(original)</span><br><span class="line">    clone.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hi'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> clone</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">'nicholas'</span>,</span><br><span class="line">    friends: [<span class="string">'shelby'</span>, <span class="string">'courts'</span>, <span class="string">'van'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> anotherPerson = createAnother(person)</span><br><span class="line">anotherPerson.sayHi()</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å¯„ç”Ÿå¼ç»§æ‰¿æ¥ä¸ºå¯¹è±¡æ·»åŠ å‡½æ•°ä¼šç”±äºä¸é¥¿èƒ½åšåˆ°å‡½æ•°å¤ç”¨è€Œé™ä½æ•ˆç‡ï¼›è¿™ä¸€ç‚¹ä¸æ„é€ å‡½æ•°ç±»ä¼¼</p>
<h3 id="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"></a>å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿</h3><p>å‰é¢è¯´è¿‡ï¼Œç»„åˆç»§æ‰¿æ˜¯javaScriptæœ€å¸¸ç”¨çš„é›†æˆæ¨¡å¼ï¼›ä¸è¿‡ï¼Œä¹Ÿæœ‰ä¸è¶³ã€‚ç»„åˆç»§æ‰¿æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— è®ºä»€ä¹ˆè¯·æ¬¾ä¸‹ï¼Œéƒ½ä¼šè°ƒç”¨ä¸¤æ¬¡è¶…ç±»å‹æ„é€ å‡½æ•°ï¼šä¸€æ¬¡å®åœ¨åˆ›å»ºå­ç±»å‹åŸå‹çš„æ—¶å€™ï¼Œå¦ä¸€æ¬¡æ˜¯åœ¨å­ç±»å‹æ„é€ å‡½æ•°å†…éƒ¨ã€‚å­ç±»å‹æœ€ç»ˆä¼šåŒ…å«è¶…ç±»å‹å¯¹è±¡çš„å…¨éƒ¨å®ä¾‹ï¼Œä½†ä¸å¾—ä¸å†è°ƒç”¨å­ç±»å‹æ„é€ å‡½æ•°æ—¶é‡å†™è¿™äº›å±æ€§ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Supertype</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'green'</span>]</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.sayName =  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    SuperType.call(<span class="keyword">this</span>, name)                   <span class="comment">//è°ƒç”¨ç¬¬äºŒæ¬¡æ„é€ å‡½æ•°ï¼Œé‡å†™SubTypeåŸå‹SuperTypeä¸­çš„nameå’Œcolorså±æ€§</span></span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()              <span class="comment">//è°ƒç”¨ç¬¬ä¸€æ¬¡æ„é€ å‡½æ•°</span></span><br><span class="line">SubType.prototype.constructor = SubType</span><br><span class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€è°“å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œå³é€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥ç»§æ‰¿å±æ€§ï¼Œé€šè¿‡åŸå‹é“¾çš„æ··æˆå½¢æˆæ¥ç»§æ‰¿æ–¹æ³•ã€‚å…¶èƒŒåçš„æ€è·¯æ˜¯ï¼šä¸å¿…ä¸ºäº†æŒ‡å®šå­ç±»å‹çš„åŸå‹è€Œè°ƒç”¨è¶…ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œæ‰€éœ€çš„æ— éæ˜¯è¶…ç±»å‹åŸå‹çš„ä¸€ä¸ªå‰¯æœ¬è€Œå·²ã€‚æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä½¿ç”¨å¯„ç”Ÿå¼ç»§æ‰¿æ¥ç»§æ‰¿è¶…ç±»å‹çš„åŸå‹ï¼Œç„¶åå†å°†ç»“æœæŒ‡å®šç»™å­ç±»å‹çš„åŸå‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inheritPrototype</span>(<span class="params">subType, superType</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> prototype = object(superType.ptototype)</span><br><span class="line">    prototype.constructor = subType</span><br><span class="line">    subType.prototype = prototype</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.colors = [<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'green'</span>]</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    SuperType.call(<span class="keyword">this</span>, name)</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line">inheritPrototype(SubType, SuperType)</span><br><span class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E4%BA%8B%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E4%BA%8B%E4%BB%B6/" class="post-title-link" itemprop="url">äº‹ä»¶</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 10:04:36 / Modified: 11:23:05" itemprop="dateCreated datePublished" datetime="2020-04-26T10:04:36+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>JavaScriptä¸HTMLä¹‹é—´çš„äº¤äº’æ˜¯é€šè¿‡äº‹ä»¶å®ç°çš„ã€‚<strong>äº‹ä»¶ï¼Œå°±æ˜¯æ–‡æ¡£æˆ–æµè§ˆå™¨çª—å£ä¸­å‘ç”Ÿçš„ä¸€äº›ç‰¹å®šäº¤äº’ç¬é—´ã€‚</strong>å¯ä»¥ä½¿ç”¨ä¾¦å¬å™¨ï¼ˆæˆ–å¤„ç†ç¨‹åºï¼‰æ¥è®¢é˜…äº‹ä»¶ï¼Œä»¥ä¾¿äº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œç›¸åº”çš„ä»£ç ã€‚è¿™ç§åœ¨ä¼ ç»Ÿè½¯ä»¶å·¥ç¨‹ä¸­è¢«ç§°ä¸ºè§‚å¯Ÿå‘˜æ¨¡å¼ã€‚æ”¯æŒé¡µé¢çš„è¡Œä¸ºä¸é¡µé¢çš„å¤–è§‚ä¹‹é—´çš„æ¾æ•£è€¦åˆã€‚</p>
<h2 id="äº‹ä»¶æµ"><a href="#äº‹ä»¶æµ" class="headerlink" title="äº‹ä»¶æµ"></a>äº‹ä»¶æµ</h2><p>äº‹ä»¶æµæè¿°çš„æ˜¯ä»é¡µé¢ä¸­æ¥æ”¶äº‹ä»¶çš„é¡ºåºã€‚</p>
<h3 id="äº‹ä»¶å†’æ³¡"><a href="#äº‹ä»¶å†’æ³¡" class="headerlink" title="äº‹ä»¶å†’æ³¡"></a>äº‹ä»¶å†’æ³¡</h3><p>IEçš„äº‹ä»¶æµå«åšäº‹ä»¶å†’æ³¡ï¼ˆevent bubblingï¼‰ï¼Œå³äº‹ä»¶å¼€å§‹æ—¶æœ‰æœ€å…·ä½“çš„å…ƒç´ ï¼ˆæ–‡æ¡£ä¸­åµŒå¥—å±‚æ¬¡æœ€æ·±çš„é‚£ä¸ªèŠ‚ç‚¹ï¼‰æ¥æ”¶ï¼Œç„¶åé€çº§å‘ä¸Šä¼ æ’­åˆ°è¾ƒä¸ºä¸å…·ä½“çš„èŠ‚ç‚¹ï¼ˆæ–‡æ¡£ï¼‰ã€‚</p>
<h3 id="äº‹ä»¶æ•è·"><a href="#äº‹ä»¶æ•è·" class="headerlink" title="äº‹ä»¶æ•è·"></a>äº‹ä»¶æ•è·</h3><p>äº‹ä»¶æ•è·çš„æ€æƒ³æ˜¯ä¸å¤ªå…·ä½“çš„èŠ‚ç‚¹æ›´æ—©æ¥æ”¶åˆ°äº‹ä»¶ï¼Œå…·ä½“çš„èŠ‚ç‚¹æœ€åæ¥æ”¶åˆ°äº‹ä»¶ã€‚äº‹ä»¶æ•è·çš„ç”¨æ„åœ¨äºåœ¨äº‹ä»¶åˆ°è¾¾é¢„å®šç›®æ ‡ä¹‹å‰æ•è·å®ƒã€‚è€ç‰ˆæœ¬çš„æµè§ˆå™¨å¯¹äº‹ä»¶æ•è·ä¸æ”¯æŒã€‚</p>
<h3 id="DOMäº‹ä»¶æµ"><a href="#DOMäº‹ä»¶æµ" class="headerlink" title="DOMäº‹ä»¶æµ"></a>DOMäº‹ä»¶æµ</h3><p>â€œDOM2çº§äº‹ä»¶â€è§„å®šçš„äº‹ä»¶æµåŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µï¼šäº‹ä»¶æ•è·é˜¶æ®µã€å¤„äºç›®æ ‡é˜¶æ®µå’Œäº‹ä»¶å†’æ³¡é˜¶æ®µã€‚é¦–å…ˆå‘ç”Ÿçš„æ˜¯äº‹ä»¶æ•è·ï¼Œä¸ºæˆªè·äº‹ä»¶æä¾›äº†æœºä¼šã€‚ç„¶åæ˜¯å®é™…çš„ç›®æ ‡æ¥æ”¶åˆ°äº‹ä»¶ã€‚æœ€åä¸€ä¸ªé˜¶æ®µæ˜¯å†’æ³¡é˜¶æ®µï¼Œå¯ä»¥åœ¨è¿™ä¸ªé˜¶æ®µå¯¹äº‹ä»¶åšå‡ºå“åº”ã€‚</p>
<p>åœ¨DOMäº‹ä»¶æµä¸­ï¼Œå®é™…çš„ç›®æ ‡ï¼ˆ<div>å…ƒç´ ï¼‰åœ¨æ•è·é˜¶æ®µä¸ä¼šæ¥æ”¶åˆ°äº‹ä»¶ã€‚è¿™æ„å‘³ç€åœ¨æ•è·é˜¶æ®µï¼Œäº‹ä»¶ä»documentåˆ°<html>å†åˆ°<body>åå°±åœæ­¢äº†ã€‚ä¸‹ä¸€ä¸ªé˜¶æ®µæ˜¯â€œå¤„äºç›®æ ‡é˜¶æ®µï¼Œäºæ˜¯äº‹ä»¶åœ¨<div>ä¸Šå‘ç”Ÿï¼Œå¹¶åœ¨äº‹ä»¶å¤„ç†ä¸­è¢«çœ‹æˆå†’æ³¡é˜¶æ®µçš„ä¸€éƒ¨åˆ†ã€‚ç„¶åå†’æ³¡é˜¶æ®µå‘ç”Ÿï¼Œäº‹ä»¶åˆä¼ å›æ–‡æ¡£ã€‚</p>
<h2 id="äº‹ä»¶å¤„ç†ç¨‹åº"><a href="#äº‹ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="äº‹ä»¶å¤„ç†ç¨‹åº"></a>äº‹ä»¶å¤„ç†ç¨‹åº</h2><p>äº‹ä»¶å°±æ˜¯ç”¨æˆ·æˆ–æµè§ˆå™¨è‡ªèº«æ‰§è¡Œçš„æŸç§åŠ¨ä½œã€‚è¯¸å¦‚clickã€loadå’Œmouseoverï¼Œéƒ½æ˜¯äº‹ä»¶çš„åå­—ã€‚è€Œå“åº”æŸä¸ªäº‹ä»¶çš„å‡½æ•°å°±å«åšäº‹ä»¶å¤„ç†ç¨‹åºï¼ˆæˆ–äº‹ä»¶ä¾¦å¬å™¨ï¼‰ã€‚äº‹ä»¶å¤„ç†ç¨‹åºçš„åå­—ä»¥â€œonâ€å¼€å¤´ï¼Œå› æ­¤clickäº‹ä»¶çš„å¤„ç†ç¨‹åºå°±æ˜¯onclickï¼Œloadäº‹ä»¶çš„å¤„ç†ç¨‹åºå°±æ˜¯onloadã€‚</p>
<h3 id="HTMLäº‹ä»¶å¤„ç†ç¨‹åº"><a href="#HTMLäº‹ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="HTMLäº‹ä»¶å¤„ç†ç¨‹åº"></a>HTMLäº‹ä»¶å¤„ç†ç¨‹åº</h3><p>æŸä¸ªå…ƒç´ æ”¯æŒçš„æ¯ç§äº‹ä»¶ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¸å“åº”äº‹ä»¶å¤„ç†ç¨‹åºçš„åŒåHTMLç‰¹æ€§æ¥æŒ‡å®šã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"click me"</span> <span class="attr">onclick</span>=<span class="string">"alert('Click')"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æŒ‡å®šæ—¶é—´å¤„ç†ç¨‹åºæœ‰ä¸€äº›ç‹¬åˆ°ä¹‹å¤„ã€‚é¦–å…ˆï¼Œè¿™æ ·ä¼šåˆ›å»ºä¸€ä¸ªå°è£…ç€å…ƒç´ å±æ€§å€¼çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸­æœ‰ä¸€ä¸ªå±€éƒ¨å˜é‡eventï¼Œä¹Ÿå°±æ˜¯äº‹ä»¶å¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"button"</span> value=<span class="string">"click me"</span> onclick=<span class="string">"alert(event.type)"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡eventå˜é‡ï¼Œå¯ä»¥ç›´æ¥è®¿é—®äº‹ä»¶å¯¹è±¡ï¼Œä¸ç”¨è‡ªå·±å®šä¹‰å®ƒï¼Œä¹Ÿä¸ç”¨ä»å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­è¯»å–ã€‚<br>åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œthiså€¼ç­‰äºäº‹ä»¶çš„ç›®æ ‡å…ƒç´ ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"Click Me"</span> <span class="attr">onclick</span>=<span class="string">"alert(event.type)"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…³äºè¿™ä¸ªåŠ¨æ€å‡½æ•°ï¼Œåœ¨å®ƒå†…éƒ¨ï¼Œå¯ä»¥åƒè®¿é—®å±€éƒ¨å˜é‡ä¸€æ ·è®¿é—®documentåŠè¯¥å…ƒç´ æœ¬èº«çš„æˆå‘˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">with</span>(<span class="built_in">document</span>) &#123;</span><br><span class="line">        <span class="keyword">with</span>(<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="comment">// å…ƒç´ å±æ€§</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ˜¯ç”±JavaScriptåº•å±‚å®ç°ï¼Œä¸éœ€è¦å¼€å‘è€…ç¼–å†™ã€‚<br>ç”±æ­¤ï¼Œå¯ä»¥æ›´ä¾¿åˆ©çš„è®¿é—®è‡ªå·±çš„å±æ€§</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"Click Me"</span> <span class="attr">onclick</span>=<span class="string">"alert(value)"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœå½“å‰å…ƒç´ æ˜¯ä¸€ä¸ªè¡¨å•è¾“å…¥å…ƒç´ ï¼Œåˆ™ä½œç”¨åŸŸä¸­è¿˜ä¼šåŒ…å«è®¿é—®è¡¨å•å…ƒç´ ï¼ˆçˆ¶å…ƒç´ ï¼‰çš„å…¥å£ï¼Œè¿™ä¸ªå‡½æ•°å°±å˜æˆäº†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">with</span>(<span class="built_in">document</span>) &#123;</span><br><span class="line">        <span class="keyword">with</span>(<span class="keyword">this</span>.form) &#123;</span><br><span class="line">            <span class="keyword">with</span>(<span class="keyword">this</span>)</span><br><span class="line">            <span class="comment">// å…ƒç´ å±æ€§</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šï¼Œè¿™æ ·æ‰©å±•ä½œç”¨åŸŸçš„æ–¹å¼ï¼Œæ— éå°±æ˜¯æƒ³è®©äº‹ä»¶å¤„ç†ç¨‹åºæ— éœ€å¼•ç”¨è¡¨å•å…ƒç´ å°±èƒ½è®¿é—®å…¶ä»–è¡¨å•å­—æ®µ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"Echo Username"</span> <span class="attr">onclick</span>=<span class="string">"alert(username.value)"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡åœ¨HTMLä¸­æŒ‡å®šäº‹ä»¶å¤„ç†ç¨‹åºæœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚é¦–å…ˆï¼Œå­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®é—®é¢˜ã€‚å› ä¸ºç”¨æˆ·å¯èƒ½ä¼šåœ¨HTMLå…ƒç´ å·²å‡ºç°åœ¨é¡µé¢ä¸Šå°±è§¦å‘ç›¸åº”çš„äº‹ä»¶ï¼Œä½†å½“æ—¶äº‹ä»¶å¤„ç†ç¨‹åºå¯èƒ½ä¸å…·å¤‡æ‰§è¡Œæ¡ä»¶ï¼ˆè¿˜æ²¡æœ‰è¢«è§£æï¼‰<br>å¦ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼Œè¿™æ ·æ‰©å±•äº‹ä»¶å¤„ç†ç¨‹åºçš„ä½œç”¨åŸŸé“¾åœ¨ä¸åŒæµè§ˆå™¨ä¸­ä¼šå¯¼è‡´ä¸åŒç»“æœã€‚<br>è¿˜æœ‰å°±æ˜¯å¯¼è‡´HTMLå’ŒJavaScriptä»£ç ç´§å¯†è€¦åˆã€‚</p>
<h3 id="DOM0çº§äº‹ä»¶å¤„ç†ç¨‹åº"><a href="#DOM0çº§äº‹ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="DOM0çº§äº‹ä»¶å¤„ç†ç¨‹åº"></a>DOM0çº§äº‹ä»¶å¤„ç†ç¨‹åº</h3><p>é€šè¿‡JavaScriptæŒ‡å®šäº‹ä»¶å¤„ç†ç¨‹åºçš„ä¼ ç»Ÿæ–¹å¼ï¼Œå°±æ˜¯å°†ä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå±æ€§ã€‚è¦ä½¿ç”¨JavaScriptæŒ‡å®šäº‹ä»¶å¤„ç†ç¨‹åºï¼Œé¦–å…ˆå¿…é¡»å–å¾—ä¸€ä¸ªè¦æ“ä½œçš„å¯¹è±¡å¼•ç”¨ã€‚<br>æ¯ä¸ªå…ƒç´ ï¼ˆåŒ…æ‹¬windowå’Œdocumentï¼‰éƒ½æœ‰è‡ªå·±çš„äº‹ä»¶å¤„ç†ç¨‹åºå±æ€§ï¼Œè¿™äº›å±æ€§é€šå¸¸å…¨éƒ¨å°å†™ï¼Œä¾‹å¦‚onclickã€‚è¿™ç§å±æ€§çš„å€¼è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥æŒ‡å®šäº‹ä»¶å¤„ç†ç¨‹åº</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bin = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">"Clicked"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ®µä»£ç è¿è¡Œä¹‹å‰ä¸ä¼šæŒ‡å®šäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå› æ­¤å¦‚æœè¿™äº›ä»£ç åœ¨é¡µé¢ä¸­ä½äºæŒ‰é’®åé¢ï¼Œå°±æœ‰å¯èƒ½åœ¨ä¸€æ®µæ—¶é—´å†…å•å‡»æ²¡ååº”ã€‚<br><strong>ä½¿ç”¨DOM0çº§æ–¹æ³•æŒ‡å®šçš„äº‹ä»¶å¤„ç†ç¨‹åºè¢«è®¤ä¸ºæ˜¯å…ƒç´ çš„æ–¹æ³•ã€‚</strong>å› æ­¤ï¼Œè¿™æ—¶å€™çš„äº‹ä»¶å¤„ç†ç¨‹åºå®åœ¨å…ƒç´ çš„ä½œç”¨åŸŸä¸­è¿è¡Œï¼›æ¢å¥è¯è¯´ï¼Œç¨‹åºä¸­çš„thiså¼•ç”¨å½“å‰å…ƒç´ ã€‚<br>ä»¥è¿™ç§æ–¹å¼æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºä¼šåœ¨äº‹ä»¶æµçš„å†’æ³¡é˜¶æ®µè¢«å¤„ç†ã€‚<br>ä¹Ÿå¯ä»¥åˆ é™¤é€šè¿‡DOM0çº§æ–¹æ³•æŒ‡å®šçš„äº‹ä»¶å¤„ç†ç¨‹åº</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btn.onclick = <span class="literal">null</span></span><br></pre></td></tr></table></figure>

<h3 id="DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åº"><a href="#DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åº"></a>DOM2çº§äº‹ä»¶å¤„ç†ç¨‹åº</h3><p>â€œDOM2çº§äº‹ä»¶â€å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œç”¨äºå¤„ç†æŒ‡å®šå’Œåˆ é™¤äº‹ä»¶å¤„ç†ç¨‹åºçš„æ“ä½œï¼šaddEventListener()å’ŒremoveEventListener()ã€‚æ‰€æœ‰DOMèŠ‚ç‚¹ä¸­éƒ½åŒ…å«è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½æ¥å—3ä¸ªå‚æ•°ï¼šè¦å¤„ç†çš„äº‹ä»¶åã€ä½œä¸ºäº‹ä»¶å¤„ç†ç¨‹åºçš„å‡½æ•°å’Œä¸€ä¸ªå¸ƒå°”å€¼ã€‚æœ€åè¿™ä¸ªå¸ƒå°”å€¼å‚æ•°å¦‚æœæ˜¯trueï¼Œè¡¨ç¤ºåœ¨æ•è·é˜¶æ®µè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åºï¼›å¦‚æœæ˜¯falseï¼Œè¡¨ç¤ºåœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åºã€‚<br>è¦åœ¨æŒ‰é’®ä¸Šclickäº‹ä»¶æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºå¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.id)</span><br><span class="line">&#125;,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶å¯ä»¥æ·»åŠ å¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åº</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.id)</span><br><span class="line">&#125;,<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'hello world'</span>)</span><br><span class="line">&#125;,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸ºæŒ‰é’®æ·»åŠ äº†ä¸¤ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œä¼šæŒ‰ç…§æ·»åŠ å®ƒä»¬çš„é¡ºåºè§¦å‘ã€‚<strong>ä¸DOM0çº§æ–¹æ³•ä¸€æ ·ï¼Œè¿™é‡Œæ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºä¹Ÿæ˜¯å†å…¶ä¾é™„çš„å…ƒç´ çš„ä½œç”¨åŸŸä¸­è¿è¡Œã€‚</strong><br>é€šè¿‡addEventListener()æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºåªèƒ½ä½¿ç”¨removeEventListener()æ¥ç§»é™¤ï¼›ä¸€å‡ºäº‹ä¼ å…¥çš„å‚æ•°ä¸æ·»åŠ å¤„ç†ç¨‹åºæ—¶ä½¿ç”¨çš„å‚æ•°ç›¸åŒã€‚<strong>è¿™ä¹Ÿæ„å‘³ç€é€šè¿‡addEventListener()æ·»åŠ çš„åŒ¿åå‡½æ•°å°†æ— æ³•ç§»é™¤</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.id)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line">btn.removeEventlisterer(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  <span class="comment">//æ— æ•ˆ</span></span><br><span class="line">    alert(<span class="keyword">this</span>.id)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line"><span class="keyword">var</span> handler = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.id)</span><br><span class="line">&#125;</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, handler, <span class="literal">false</span>)</span><br><span class="line">btn.removeEventlisterer(<span class="string">'click'</span>, handler, <span class="literal">false</span>)   <span class="comment">//æœ‰æ•ˆ</span></span><br></pre></td></tr></table></figure>

<h3 id="IEäº‹ä»¶å¤„ç†ç¨‹åº"><a href="#IEäº‹ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="IEäº‹ä»¶å¤„ç†ç¨‹åº"></a>IEäº‹ä»¶å¤„ç†ç¨‹åº</h3><p>IEå®ç°äº†ä¸DOMä¸­ç±»ä¼¼çš„ä¸¤ä¸ªæ–¹æ³•ï¼šattachEvent()å’ŒdetachEvent()ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•æ¥å—ç›¸åŒçš„ä¸¤ä¸ªå‚æ•°ï¼šäº‹ä»¶å¤„ç†ç¨‹åºåç§°ä¸äº‹ä»¶å¤„ç†ç¨‹åºå‡½æ•°ã€‚attachEvent()æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºéƒ½ä¼šè¢«æ·»åŠ åˆ°äº‹ä»¶å†’æ³¡é˜¶æ®µã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.attachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'clicked'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>åœ¨IEä¸­ä½¿ç”¨attachEvent()ä¸ä½¿ç”¨DOM0çº§æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºäº‹ä»¶å¤„ç†ç¨‹åºçš„ä½œç”¨åŸŸã€‚åœ¨ä½¿ç”¨attachEvent()æ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œäº‹ä»¶å¤„ç†ç¨‹åºä¼šåœ¨å…¨å±€ä½œç”¨åŸŸä¸­è¿è¡Œï¼Œå› æ­¤thisç­‰äºwindowã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.attachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span> === <span class="built_in">window</span>)   <span class="comment">//true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>attachEvent()æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨æ¥ä¸ºä¸€ä¸ªå…ƒç´ æ·»åŠ å¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºã€‚ä½†æ‰§è¡Œé¡ºåºä¸DOM2æ–¹æ³•ç›¸åã€‚<br>ä½¿ç”¨attachEvent()æ·»åŠ çš„äº‹ä»¶å¯ä»¥é€šè¿‡detachEvent()æ¥ç§»é™¤ï¼Œæ¡ä»¶æ˜¯å¿…é¡»æä¾›ç›¸åŒçš„å‚æ•°ã€‚</p>
<p><strong>è·¨æµè§ˆå™¨çš„äº‹ä»¶å¤„ç†éœ€è¦æ£€æŸ¥æµè§ˆå™¨å¯¹äº‹ä»¶çš„æ”¯æŒç¨‹åº¦ï¼ˆDOM0ã€DOM2æˆ–IEï¼‰</strong></p>
<h2 id="äº‹ä»¶å¯¹è±¡"><a href="#äº‹ä»¶å¯¹è±¡" class="headerlink" title="äº‹ä»¶å¯¹è±¡"></a>äº‹ä»¶å¯¹è±¡</h2><p>åœ¨è§¦å‘DOMä¸Šçš„æŸä¸ªäº‹ä»¶æ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶å¯¹è±¡eventï¼Œè¿™ä¸ªå¯¹è±¡ä¸­åŒ…å«è¿™æ‰€æœ‰ä¸äº‹ä»¶æœ‰å…³çš„ä¿¡æ¯ã€‚åŒ…æ‹¬å¯¼è‡´äº‹ä»¶çš„å…ƒç´ ï¼Œäº‹ä»¶çš„ç±»å‹ä»¥åŠå…¶ä»–ä¸ç‰¹å®šäº‹ä»¶ç›¸å…³çš„ä¿¡æ¯ã€‚æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒeventå¯¹è±¡ï¼Œä½†æ”¯æŒæ–¹å¼ä¸åŒã€‚</p>
<h3 id="DOMä¸­çš„äº‹ä»¶å¯¹è±¡"><a href="#DOMä¸­çš„äº‹ä»¶å¯¹è±¡" class="headerlink" title="DOMä¸­çš„äº‹ä»¶å¯¹è±¡"></a>DOMä¸­çš„äº‹ä»¶å¯¹è±¡</h3><p>å…¼å®¹DOMçš„æµè§ˆå™¨ä¼šå°†ä¸€ä¸ªeventå¯¹è±¡ä¼ å…¥åˆ°äº‹ä»¶å¤„ç†ç¨‹åºä¸­å›½ã€‚æ— è®ºæŒ‡å®šæ—¶é—´å¤„ç†ç¨‹åºæ—¶ä½¿ç”¨ä»€ä¹ˆæ–¹æ³•ï¼ˆDOM0çº§æˆ–DOM2çº§ï¼‰ï¼Œéƒ½ä¼šä¼ å…¥eventå¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(event.type)   <span class="comment">//click</span></span><br><span class="line">&#125;</span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(event.type)   <span class="comment">//click</span></span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>

<p>åœ¨é€šè¿‡HTMLç‰¹å®šå®šä¹‰äº‹ä»¶å¤„ç†ç¨‹åºæ˜¯ï¼Œå˜é‡eventä¸­ä¿å­˜ç€eventå¯¹è±¡ã€‚ä»¥è¿™ç§æ–¹å¼æä¾›eventå¯¹è±¡ï¼Œå¯ä»¥è®©HTMLç‰¹æ€§äº‹ä»¶å¤„ç†ç¨‹åºä¸JavaScriptå‡½æ•°æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚<br>è¦é˜»æ­¢ç‰¹å®šäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨preventDefault()æ–¹æ³•ã€‚ä¾‹å¦‚é“¾æ¥çš„é»˜è®¤è¡Œä¸ºå°±æ˜¯åœ¨è¢«å•å‡»æ˜¯ä¼šå¯¼èˆªåˆ°å…¶hrefç‰¹æ€§æŒ‡å®šçš„URLã€‚å¦‚æœæƒ³é˜»æ­¢è¿æ¥å¯¼èˆªè¿™ä¸€é»˜è®¤è¡Œä¸ºï¼Œé‚£ä¹ˆé€šè¿‡é“¾æ¥çš„onclickäº‹ä»¶å¤„ç†ç¨‹åºå¯ä»¥å–æ¶ˆå®ƒã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> link = <span class="built_in">document</span>.getElementById(<span class="string">'myLink'</span>)</span><br><span class="line">link.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    event.preventDefault()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦å¤–ï¼ŒstopPropagation()æ–¹æ³•ç”¨äºç«‹å³åœæ­¢äº‹ä»¶åœ¨DOMå±‚æ¬¡ä¸­çš„ä¼ æ’­ï¼Œå³å–æ¶ˆè¿›ä¸€æ­¥çš„äº‹ä»¶æ•è·æˆ–å†’æ³¡ã€‚ä¾‹å¦‚ï¼Œç›´æ¥æ·»åŠ åˆ°ä¸€ä¸ªæŒ‰é’®çš„äº‹ä»¶å¤„ç†ç¨‹åºå¯ä»¥è°ƒç”¨stopPropagation(),ä»è€Œé¿å…è§¦å‘æ³¨å†Œåœ¨document.bodyä¸Šé¢çš„äº‹ä»¶å¤„ç†ç¨‹åº</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'clicked'</span>)</span><br><span class="line">    event.stopPropagation()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'body clicked'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äº‹ä»¶å¯¹è±¡çš„eventPhaseå±æ€§ï¼Œå¯ä»¥ç”¨æ¥ç¡®å®šäº‹ä»¶å½“å‰æ­£ä½äºäº‹ä»¶æµçš„é‚£ä¸ªé˜¶æ®µã€‚å¦‚æœæ˜¯åœ¨æ•è·é˜¶æ®µè°ƒç”¨çš„äº‹ä»¶å¤„ç†ç¨‹åºï¼Œé‚£ä¹ˆeventPhaseç­‰äº1ï¼›å¦‚æœäº‹ä»¶å¤„ç†ç¨‹åºå¤„äºç›®æ ‡å¯¹è±¡ä¸Šï¼Œåˆ™eventPhaseç­‰äº2ï¼›å¦‚æœæ˜¯åœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨çš„äº‹ä»¶å¤„ç†ç¨‹åºï¼ŒeventPhaseç­‰äº3ã€‚å°½ç®¡â€œå¤„äºç›®æ ‡â€å‘ç”Ÿåœ¨å†’æ³¡é˜¶æ®µï¼Œä½†eventPhaseä»ç„¶ä¸€ç›´ç­‰äº2ï¼›</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(event.eventPhase)  <span class="comment">//2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(event.eventPhase) <span class="comment">//1</span></span><br><span class="line">&#125;, <span class="literal">true</span>)</span><br><span class="line"><span class="built_in">document</span>.body.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(event.eventPhase)   <span class="comment">//3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IEä¸­çš„äº‹ä»¶å¯¹è±¡"><a href="#IEä¸­çš„äº‹ä»¶å¯¹è±¡" class="headerlink" title="IEä¸­çš„äº‹ä»¶å¯¹è±¡"></a>IEä¸­çš„äº‹ä»¶å¯¹è±¡</h3><p>è®¿é—®DOMçš„eventå¯¹è±¡ä¸åŒï¼Œè¦è®¿é—®IEä¸­çš„eventå¯¹è±¡æœ‰å‡ ç§ä¸åŒæ–¹å¼ï¼Œå–å†³äºæŒ‡å®šæ—¶é—´å¤„ç†ç¨‹åºçš„æ–¹æ³•ã€‚åœ¨ä½¿ç”¨DOM0çº§æ–¹æ³•æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºæ—¶ï¼Œeventå¯¹è±¡ä½œä¸ºwindowå¯¹è±¡çš„ä¸€ä¸ªå±æ€§å­˜åœ¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> event = <span class="built_in">window</span>.event</span><br><span class="line">    alert(event.type)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœäº‹ä»¶å¤„ç†ç¨‹åºæ—¶ä½¿ç”¨attachEvent()æ·»åŠ çš„ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªeventå¯¹è±¡ä½œä¸ºå‚æ•°è¢«ä¼ å…¥äº‹ä»¶å¤„ç†ç¨‹åºå‡½æ•°ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.attachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(event.type)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨attachEvent()çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡windowå¯¹è±¡æ¥è®¿é—®eventå¯¹è±¡ï¼Œå°±åƒä½¿ç”¨DOM0çº§æ–¹æ³•ä¸€æ ·ã€‚<br>å¦‚æœæ˜¯é€šè¿‡HTMLç‰¹æ€§æŒ‡å®šçš„äº‹ä»¶å¤„ç†ç¨‹åºï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä¸€ä¸ªåå«eventçš„å˜é‡æ¥è®¿é—®eventå¯¹è±¡ï¼ˆä¸DOMä¸­çš„äº‹ä»¶æ¨¡å‹ç›¸åŒï¼‰ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"Click Me"</span> <span class="attr">onclick</span>=<span class="string">"alert(event.type)"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºäº‹ä»¶å¤„ç†ç¨‹åºçš„ä½œç”¨åŸŸæ˜¯æ ¹æ®æŒ‡å®šå®ƒçš„æ–¹å¼æ¥ç¡®å®šçš„ï¼Œæ‰€ä»¥ä¸èƒ½è®¤ä¸ºthisä¼šå§‹ç»ˆç­‰äºäº‹ä»¶ç›®æ ‡ã€‚æ•…è€Œï¼Œæœ€å¥½è¿˜æ˜¯ä½¿ç”¨event.srcElementæ¯”è¾ƒä¿é™©ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="built_in">window</span>.event.srcElement === <span class="keyword">this</span>)  <span class="comment">//true</span></span><br><span class="line">&#125;</span><br><span class="line">btn.attachEvent(<span class="string">"onclick"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(event.srcElement === <span class="keyword">this</span>)       <span class="comment">//false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨ç¬¬ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼ˆä½¿ç”¨DOM0çº§æ–¹æ³•æŒ‡å®šçš„ï¼‰ï¼ŒsrcElementå±æ€§ç­‰äºthisï¼Œä½†åœ¨ç¬¬äºŒä¸ªäº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œè¿™ä¸¤è€…çš„å€¼ä¸ç›¸åŒã€‚<br>returnValueå±æ€§ç›¸å½“äºDOMä¸­çš„preventDefault()æ–¹æ³•ï¼Œå®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯å–æ¶ˆç»™å®šäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºã€‚åªè¦å°†returnValueè®¾ç½®ä¸ºfalseï¼Œå°±å¯ä»¥é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚</p>
<h2 id="å†…å­˜å’Œæ€§èƒ½"><a href="#å†…å­˜å’Œæ€§èƒ½" class="headerlink" title="å†…å­˜å’Œæ€§èƒ½"></a>å†…å­˜å’Œæ€§èƒ½</h2><h3 id="äº‹ä»¶å§”æ‰˜"><a href="#äº‹ä»¶å§”æ‰˜" class="headerlink" title="äº‹ä»¶å§”æ‰˜"></a>äº‹ä»¶å§”æ‰˜</h3><p>å¯¹â€œäº‹ä»¶å¤„ç†ç¨‹åºè¿‡å¤šâ€é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯äº‹ä»¶å§”æ‰˜ã€‚äº‹ä»¶å§”æ‰˜åˆ©ç”¨äº†äº‹ä»¶å†’æ³¡ï¼ŒåªæŒ‡å®šä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå°±å¯ä»¥ç®¡ç†æŸä¸€ç±»å‹çš„æ‰€æœ‰æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œclickäº‹ä»¶ä¼šä¸€ç›´å†’æ³¡åˆ°documentå±‚æ¬¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ•´ä¸ªé¡µé¢æŒ‡å®šä¸€ä¸ªonclickäº‹ä»¶å¤„ç†ç¨‹åºï¼Œè€Œä¸å¿…ç»™æ¯ä¸ªå¯å•å‡»çš„å…ƒç´ åˆ†åˆ«æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p>
<h3 id="ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº"><a href="#ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº" class="headerlink" title="ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº"></a>ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åº</h3><p>æ¯å½“äº‹ä»¶å¤„ç†ç¨‹åºæŒ‡å®šç»™å…ƒç´ æ—¶ï¼Œè¿è¡Œä¸­çš„æµè§ˆå™¨ä»£ç ä¸æ”¯æŒé¡µé¢äº¤äº’çš„JavaScriptä»£ç ä¹‹é—´å°±ä¼šå»ºç«‹ä¸€ä¸ªè¿æ¥ã€‚è¿™ç§è¿æ¥è¶Šå¤šï¼Œé¡µé¢æ‰§è¡Œèµ·æ¥å°±è¶Šæ…¢ã€‚å¯ä»¥ä½¿ç”¨äº‹ä»¶å§”æ‰˜æŠ€æœ¯ï¼Œæ˜¾ç¤ºå»ºç«‹è¿æ¥æ•°é‡ã€‚å¦å¤–ï¼Œå†ä¸éœ€è¦çš„æ—¶å€™ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä¹Ÿæ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ¡ˆã€‚å†…å­˜ä¸­ç•™æœ‰é‚£äº›è¿‡æ—¶ä¸ç”¨çš„â€œç©ºäº‹ä»¶å¤„ç†ç¨‹åºâ€ï¼Œä¹Ÿæ˜¯é€ æˆWebåº”ç”¨ç¨‹åºå†…å­˜ä¸æ€§èƒ½é—®é¢˜çš„ä¸»è¦åŸå› ã€‚<br>ä¸¤ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šé€ æˆä¸Šè¿°é—®é¢˜ã€‚ç¬¬ä¸€ç§æƒ…å†µå°±æ˜¯ä»æ–‡æ¡£ä¸­ç§»é™¤å¸¦æœ‰æ—¶é—´å¤„ç†ç¨‹åºçš„å…ƒç´ æ—¶ã€‚å¯èƒ½æ˜¯é€šè¿‡çº¯ç²¹çš„DOMæ“ä½œï¼Œä¾‹å¦‚ä½¿ç”¨removeChild()å’ŒreplaceChild()æ–¹æ³•ï¼Œä½†æ›´å¤šåœ°æ˜¯å‘ç”Ÿåœ¨ä½¿ç”¨innerHTMLæ›¿æ¢é¡µé¢ä¸­æŸä¸€éƒ¨åˆ†ã€‚å¦‚æœå¸¦æœ‰æ—¶é—´å¤„ç†ç¨‹åºçš„å…ƒç´ è¢«innerHTMLåˆ é™¤äº†ï¼Œé‚£ä¹ˆåŸæ¥æ·»åŠ åˆ°å…ƒç´ ä¸­çš„äº‹ä»¶å¤„ç†ç¨‹åºææœ‰å¯èƒ½æ— æ³•è¢«å½“åšåƒåœ¾å›æ”¶ã€‚<br>è¿™ç§æƒ…å†µä¸‹ï¼Œå½“çŸ¥é“æŸä¸ªå…ƒç´ å³å°†è¢«ç§»é™¤ï¼Œæ‰‹åŠ¨ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn")</span></span><br><span class="line"><span class="string">btn.onclick = function() &#123;</span></span><br><span class="line"><span class="string">    btn.onclick = null</span></span><br><span class="line"><span class="string">    document.getElementById('</span>myDiv<span class="string">').innerHTML = '</span>Processing...<span class="string">'</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æƒ…å†µå°±æ˜¯å¸è½½é¡µé¢çš„æ—¶å€™ã€‚å¦‚æœé¡µé¢å¸è½½ä¹‹å‰æ²¡æœ‰æ¸…ç†å¹²å‡€äº‹ä»¶å¤„ç†ç¨‹åºï¼Œé‚£ä¹ˆå°±ä¼šæ»ç•™åœ¨å†…å­˜ä¸­ã€‚æ¯æ¬¡åŠ è½½å®Œé¡µé¢å†å¸è½½é¡µé¢æ—¶ï¼ˆå¯èƒ½æ˜¯åœ¨ä¸¤ä¸ªé¡µé¢é—´æ¥å›åˆ‡æ¢ï¼Œä¹Ÿå¯ä»¥æ˜¯å•å‡»äº†åˆ·æ–°æŒ‰é’®ï¼‰å†…å­˜ä¸­ç›´æµçš„å¯¹è±¡æ•°ç›®å°±ä¼šå¢åŠ ï¼Œå› ä¸ºäº‹ä»¶å¤„ç†ç¨‹åºå ç”¨çš„å†…å­˜å¹¶æ²¡æœ‰è¢«é‡Šæ”¾ã€‚<br>è¿™ç§æƒ…å†µæœ€å¥½çš„åšæ³•æ˜¯åœ¨é¡µé¢å¸è½½ä¹‹å‰ï¼Œé€šè¿‡onunloadäº‹ä»¶å¤„ç†ç¨‹åºç§»å¤„æ‰€æœ‰äº‹ä»¶å¤„ç†ç¨‹åºã€‚</p>
<h2 id="æ¨¡æ‹Ÿäº‹ä»¶"><a href="#æ¨¡æ‹Ÿäº‹ä»¶" class="headerlink" title="æ¨¡æ‹Ÿäº‹ä»¶"></a>æ¨¡æ‹Ÿäº‹ä»¶</h2><p>äº‹ä»¶ï¼Œå°±æ˜¯ç½‘é¡µä¸­æŸä¸ªç‰¹åˆ«å€¼å¾—å…³æ³¨çš„ç¬é—´ã€‚äº‹ä»¶ç»å¸¸ç”±ç”¨æˆ·æ“ä½œæˆ–é€šè¿‡å…¶ä»–æµè§ˆå™¨åŠŸèƒ½æ¥è§¦å‘ã€‚<br>äº‹å®ä¸Šï¼Œå¯ä»¥ä½¿ç”¨JavaScriptåœ¨ä»»æ„æ—¶åˆ»æ¥è§¦å‘ç‰¹å®šçš„äº‹ä»¶ï¼Œè€Œæ­¤æ—¶çš„äº‹ä»¶å°±å¦‚åŒæµè§ˆå™¨åˆ›å»ºçš„äº‹ä»¶ä¸€æ ·ã€‚ä¹Ÿå°±æ˜¯æ‰€ï¼Œè¿™äº›äº‹ä»¶é€šæµè§ˆå™¨åˆ›å»ºçš„äº‹ä»¶ä¸€æ ·å¯ä»¥å†’æ³¡ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šäº‹ä»¶å¤„ç†ç¨‹åºã€‚</p>
<h3 id="DOMä¸­çš„äº‹ä»¶æ¨¡æ‹Ÿ"><a href="#DOMä¸­çš„äº‹ä»¶æ¨¡æ‹Ÿ" class="headerlink" title="DOMä¸­çš„äº‹ä»¶æ¨¡æ‹Ÿ"></a>DOMä¸­çš„äº‹ä»¶æ¨¡æ‹Ÿ</h3><p>å¯ä»¥åœ¨documentå¯¹è±¡ä¸Šä½¿ç”¨creatEventæ–¹æ³•åˆ›å»ºeventå¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå³è¡¨ç¤ºè¦åˆ›å»ºçš„äº‹ä»¶ç±»å‹çš„å­—ç¬¦ä¸²ã€‚åœ¨DOM2çº§ä¸­ï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä¸²éƒ½ä½¿ç”¨è‹±æ–‡å¤æ•°å½¢å¼ï¼Œè€Œåœ¨DOM3çº§ä¸­éƒ½å˜æˆäº†å•æ•°ã€‚<br>è¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥æ˜¯ä¸‹åˆ—å‡ ä¸ªå­—ç¬¦ä¸²ä¹‹ä¸€ã€‚<br>1.UIEventsï¼šä¸€èˆ¬åŒ–UIäº‹ä»¶ã€‚é¼ æ ‡äº‹ä»¶å’Œé”®ç›˜äº‹ä»¶éƒ½ç»§æ‰¿UIäº‹ä»¶ã€‚<br>2.MouseEventsï¼šä¸€èˆ¬åŒ–çš„é¼ æ ‡äº‹ä»¶ã€‚<br>3.MutationEventsï¼šä¸€èˆ¬åŒ–çš„DOMå˜åŠ¨äº‹ä»¶<br>4.HTMLEventsï¼šä¸€èˆ¬åŒ–çš„HTMLäº‹ä»¶ å¦‚focusâ€¦</p>
<p>æ¨¡æ‹Ÿäº‹ä»¶æ­¥éª¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> domElement = <span class="built_in">document</span>.getElementById(<span class="string">'someId'</span>)</span><br><span class="line"><span class="keyword">var</span> event = <span class="built_in">document</span>.creatEvent(<span class="string">"MouseEvents"</span>)</span><br><span class="line">event.initMouseEvent(<span class="string">'props...'</span>)  <span class="comment">//ä¸åŒæ–¹æ³•äº‹ä»¶å‚æ•°ä¸ä¸€æ ·</span></span><br><span class="line">domElement.dispatchEvent(event)   <span class="comment">//ç­‰åŒäºè§¦å‘äº†initMouseEventä¸­typeè®¾ç½®çš„äº‹ä»¶</span></span><br></pre></td></tr></table></figure>

<p><strong>è‡ªå®šä¹‰DOMäº‹ä»¶</strong><br>DOM3çº§è¿˜å®šä¹‰äº†â€œè‡ªå®šä¹‰äº‹ä»¶â€ã€‚è‡ªå®šä¹‰äº‹ä»¶ä¸æ˜¯ç”±DOMåŸç”Ÿè§¦å‘çš„ï¼Œå®ƒçš„ç›®çš„æ˜¯è®©å¼€å‘äººå‘˜åˆ›å»ºè‡ªå·±çš„äº‹ä»¶ã€‚è¦åˆ›å»ºæ–°çš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œå¯ä»¥è°ƒç”¨createEvent(â€˜CustomEventâ€™)ã€‚è¿”å›çš„å¯¹è±¡æœ‰ä¸€ä¸ªåä¸ºinitCustomEvent()çš„æ–¹æ³•ï¼Œæ¥æ”¶å¦‚ä¸‹4ä¸ªå‚æ•°ã€‚<br>1.type(å­—ç¬¦ä¸²)ï¼šè§¦å‘çš„äº‹ä»¶ç±»å‹ï¼Œå¯å…¥â€œkeydownâ€<br>2.bubble(å¸ƒå°”å€¼)ï¼šè¡¨ç¤ºäº‹ä»¶æ˜¯å¦åº”è¯¥å†’æ³¡<br>3.cancelable(å¸ƒå°”å€¼)ï¼šè¡¨ç¤ºäº‹ä»¶æ˜¯å¦å¯ä»¥å–æ¶ˆ<br>4.detail(å¯¹è±¡)ï¼šä»»æ„å€¼ï¼Œä¿å­˜åœ¨eventå¯¹è±¡çš„detailå±æ€§ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">'myDiv'</span>)</span><br><span class="line"><span class="keyword">var</span> event;</span><br><span class="line">EventUtil.addHandler(div, <span class="string">'myevent'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'div:'</span> + event.detail)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(<span class="built_in">document</span>, <span class="string">'myevent'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'document:'</span> + event.detail)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.implementation.hasFeature(<span class="string">'CustomEvents'</span>, <span class="string">'3.0'</span>)) &#123;</span><br><span class="line">    event = <span class="built_in">document</span>.createEvent(<span class="string">'CustomEvent'</span>)</span><br><span class="line">    event.initCustomEvent(<span class="string">'myevent'</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="string">'hello world'</span>)</span><br><span class="line">    div.dispatchEvent(event)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­åˆ›å»ºäº†ä¸€ä¸ªå†’æ³¡äº‹ä»¶â€˜myeventâ€™ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB/" class="post-title-link" itemprop="url">è·¨åŸŸèµ„æºå…±äº«</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 10:04:36 / Modified: 15:57:58" itemprop="dateCreated datePublished" datetime="2020-04-26T10:04:36+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>é€šè¿‡XHRå®ç°Ajaxé€šä¿¡çš„ä¸€ä¸ªä¸»è¦é™åˆ¶ï¼Œæ¥æºäºè·¨åŸŸå®‰å…¨ç­–ç•¥ï¼ˆåŒæºç­–ç•¥ï¼‰ã€‚</p>
<h2 id="åŒæºçš„å®šä¹‰"><a href="#åŒæºçš„å®šä¹‰" class="headerlink" title="åŒæºçš„å®šä¹‰"></a>åŒæºçš„å®šä¹‰</h2><p>å¦‚æœä¸¤ä¸ªURLçš„åè®®ï¼ˆprotocolï¼‰ã€ç«¯å£ï¼ˆportï¼‰ï¼ˆå¦‚æœæœ‰æŒ‡å®šçš„è¯ï¼‰å’ŒåŸŸåï¼ˆhostï¼‰éƒ½ç›¸åŒçš„è¯ï¼Œåˆ™è¿™ä¸¤ä¸ªURLæ˜¯åŒæºã€‚è¿™ä¸ªæ–¹æ¡ˆä¹Ÿè¢«ç§°ä¸ºâ€˜åè®®/ä¸»æœº/ç«¯å£å…ƒç»„â€™ï¼Œæˆ–è€…ç›´æ¥æ˜¯â€˜å…ƒç»„â€™ã€‚ï¼ˆâ€˜å…ƒç»„â€™æ˜¯æŒ‡ä¸€ç»„é¡¹ç›®æ„æˆçš„æ•´ä½“ï¼Œâ€˜ä¸‰é‡/å››é‡/äº”é‡/ç­‰çš„é€šç”¨å½¢å¼ï¼‰ã€‚<br>ä¸€ä¸‹ç»™å‡ºäº†ä¸URL <a href="http://store.company.com/dir/page.htmlçš„æºè¿›è¡Œå¯¹æ¯”çš„ç¤ºä¾‹ã€‚" target="_blank" rel="noopener">http://store.company.com/dir/page.htmlçš„æºè¿›è¡Œå¯¹æ¯”çš„ç¤ºä¾‹ã€‚</a></p>
<p>1.<a href="http://store.company.com/dir2/other.html" target="_blank" rel="noopener">http://store.company.com/dir2/other.html</a><br>åŒæºï¼Œåªæœ‰è·¯å¾„ä¸åŒ<br>2.<a href="http://store.company.com/dir/inner/another.html" target="_blank" rel="noopener">http://store.company.com/dir/inner/another.html</a><br>åŒæºï¼Œåªæœ‰è·¯å¾„ä¸åŒ<br>3.<a href="https://store.company.com/secure.html" target="_blank" rel="noopener">https://store.company.com/secure.html</a><br>ä¸åŒæºï¼Œåè®®ä¸åŒ<br>4.<a href="http://store.company.com:81/dir/etc.html" target="_blank" rel="noopener">http://store.company.com:81/dir/etc.html</a><br>ä¸åŒæºï¼Œç«¯å£ä¸åŒï¼ˆhttpé»˜è®¤æ˜¯80ç«¯å£ï¼‰<br>5.<a href="http://news.company.com/dir/other.html" target="_blank" rel="noopener">http://news.company.com/dir/other.html</a><br>ä¸åŒæºï¼Œä¸»æœºï¼ˆåŸŸåï¼‰ä¸åŒ</p>
<h2 id="æºçš„ç»§æ‰¿"><a href="#æºçš„ç»§æ‰¿" class="headerlink" title="æºçš„ç»§æ‰¿"></a>æºçš„ç»§æ‰¿</h2><p>åœ¨é¡µé¢ä¸­é€šè¿‡ about:blank æˆ– javascript: URL æ‰§è¡Œçš„è„šæœ¬ä¼šç»§æ‰¿æ‰“å¼€è¯¥ URL çš„æ–‡æ¡£çš„æºï¼Œå› ä¸ºè¿™äº›ç±»å‹çš„ URLs æ²¡æœ‰åŒ…å«æºæœåŠ¡å™¨çš„ç›¸å…³ä¿¡æ¯ã€‚</p>
<p>ä¾‹å¦‚ï¼Œabout:blank é€šå¸¸ä½œä¸ºçˆ¶è„šæœ¬å†™å…¥å†…å®¹çš„æ–°çš„ç©ºç™½å¼¹å‡ºçª—å£çš„ URLï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡  Window.open()  ï¼‰ã€‚ å¦‚æœæ­¤å¼¹å‡ºçª—å£ä¹ŸåŒ…å« JavaScriptï¼Œåˆ™è¯¥è„šæœ¬å°†ä»åˆ›å»ºå®ƒçš„è„šæœ¬é‚£é‡Œç»§æ‰¿å¯¹åº”çš„æºã€‚</p>
<p>æ³¨æ„ï¼šåœ¨Gecko 6.0ä¹‹å‰ï¼Œå¦‚æœç”¨æˆ·åœ¨ä½ç½®æ ä¸­è¾“å…¥ data URLsï¼Œdata URLs å°†ç»§æ‰¿å½“å‰æµè§ˆå™¨çª—å£ä¸­ç½‘é¡µçš„å®‰å…¨ä¸Šä¸‹æ–‡ã€‚</p>
<p>dataï¼šURLs è·å¾—ä¸€ä¸ªæ–°çš„ï¼Œç©ºçš„å®‰å…¨ä¸Šä¸‹æ–‡ã€‚</p>
<h2 id="æºçš„æ›´æ”¹"><a href="#æºçš„æ›´æ”¹" class="headerlink" title="æºçš„æ›´æ”¹"></a>æºçš„æ›´æ”¹</h2><p>æ»¡è¶³æŸäº›é™åˆ¶æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œé¡µé¢æ˜¯å¯ä»¥ä¿®æ”¹å®ƒçš„æºã€‚è„šæœ¬å¯ä»¥å°†documet.domainçš„å€¼è®¾ç½®ä¸ºå…¶å½“å‰åŸŸçš„çˆ¶åŸŸã€‚å¦‚æœå°†å…¶è®¾ç½®ä¸ºå½“å‰åŸŸçš„çˆ¶åŸŸï¼Œåˆ™è¿™ä¸ªè¾ƒçŸ­çš„çˆ¶åŸŸå°†ç”¨äºåç»­æºæ£€æŸ¥ã€‚<br>ä¾‹å¦‚ï¼Œå‡è®¾http://<strong>store.company.com</strong>/dir/other.htmlæ–‡æ¡£ä¸­çš„ä¸€ä¸ªè„šæœ¬æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.domain = <span class="string">'company.com'</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ¡è¯­å¥æ‰§è¡Œä»¥åï¼Œé¡µé¢å°†ä¼šæˆåŠŸåœ°é€šè¿‡ä¸http://<strong>company.com</strong>/dir/page.htmlçš„åŒæºæ£€æµ‹ï¼ˆå‡è®¾<a href="http://company.com.dir/page.htmlå°†å…¶documentè®¾ç½®ä¸ºâ€œcompany.com&quot;,å·²è¡¨æ˜å®ƒå¸Œæœ›å…è®¸è¿™æ ·åšã€‚ç„¶è€Œï¼Œcompany.com" target="_blank" rel="noopener">http://company.com.dir/page.htmlå°†å…¶documentè®¾ç½®ä¸ºâ€œcompany.com&quot;,å·²è¡¨æ˜å®ƒå¸Œæœ›å…è®¸è¿™æ ·åšã€‚ç„¶è€Œï¼Œcompany.com</a> ä¸èƒ½è®¾ç½® document.domain ä¸º othercompany.comï¼Œå› ä¸ºå®ƒä¸æ˜¯ company.com çš„çˆ¶åŸŸã€‚</p>
<h2 id="è·¨åŸŸèµ„æºå…±äº«"><a href="#è·¨åŸŸèµ„æºå…±äº«" class="headerlink" title="è·¨åŸŸèµ„æºå…±äº«"></a>è·¨åŸŸèµ„æºå…±äº«</h2><p>é€šè¿‡XHRå®ç°Ajaxé€šä¿¡çš„ä¸€ä¸ªä¸»è¦é™åˆ¶ï¼Œæ¥æºäºè·¨åŸŸå®‰å…¨ç­–ç•¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒXHRå¯¹è±¡åªèƒ½è®¿é—®ä¸åŒ…å«å®ƒçš„é¡µé¢ä½äºåŒä¸€ä¸ªåŸŸä¸­çš„èµ„æºã€‚è¿™ç§å®‰å…¨ç­–ç•¥å¯ä»¥é¢„é˜²æŸäº›æ¶æ„è¡Œä¸ºã€‚<br>CORSï¼ˆCross-Origin Resource Sharingï¼Œè·¨æºèµ„æºå…±äº«ï¼‰ï¼Œå®šä¹‰äº†åœ¨å¿…é¡»è®¿é—®è·¨åŸŸèµ„æºæ—¶ï¼Œæµè§ˆå™¨ä¸æœåŠ¡å™¨åº”è¯¥å¦‚ä½•æ²Ÿé€šã€‚CORSèƒŒåçš„åŸºæœ¬æ€æƒ³ï¼Œå°±æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„HTTPå¤´éƒ¨è®©æµè§ˆå™¨ä¸æœåŠ¡å™¨è¿›è¡Œæ²Ÿé€šï¼Œä»è€Œå†³å®šè¯·æ±‚æˆ–ç›¸åº”åº”è¯¥æ˜¯æˆåŠŸï¼Œè¿˜æ˜¯å¤±è´¥ã€‚<br>æ¯”å¦‚ä¸€ä¸ªç®€å•çš„ä½¿ç”¨GETæˆ–POSTå‘é€çš„è¯·æ±‚ï¼Œå®ƒæ²¡æœ‰è‡ªå®šä¹‰çš„å¤´éƒ¨ï¼Œè€Œä¸»ä½“å†…å®¹æ˜¯text/plainã€‚åœ¨å‘é€è¯·æ±‚æ—¶ï¼Œéœ€è¦ç»™å®ƒé™„åŠ ä¸€ä¸ªé¢å¤–çš„Originå¤´éƒ¨ï¼Œå…¶ä¸­åŒ…å«æƒ…æ„Ÿæ±‚é¡µé¢çš„æºä¿¡æ¯ï¼ˆåè®®ã€åŸŸåå’Œç«¯å£ï¼‰ï¼Œä»¥ä¾¿æœåŠ¡å™¨è¿›è¡Œæ ¹æ®è¿™ä¸ªå¤´éƒ¨ä¿¡æ¯æ¥å†³å®šæ˜¯å¦ç»™äºˆå“åº”ã€‚<br>  Origin: <a href="http://www.nczonline.net" target="_blank" rel="noopener">http://www.nczonline.net</a><br>å¦‚æœæœåŠ¡å™¨è®¤ä¸ºè¿™ä¸ªè¯·æ±‚å¯ä»¥æ¥å—ï¼Œå°±åœ¨Access-Control-Allow-Originå¤´éƒ¨ä¸­å›å‘ç›¸åŒçš„æºä¿¡æ¯ï¼ˆå¦‚æœæ˜¯å…¬å…±èµ„æºï¼Œå¯ä»¥å›å‘<strong><em>ï¼‰<br>  Access-Control-Allow-Origin: <a href="http://www.nczonline.net" target="_blank" rel="noopener">http://www.nczonline.net</a><br>å¦‚æœæ²¡æœ‰è¿™ä¸ªå¤´éƒ¨ï¼Œæˆ–è€…æœ‰è¿™ä¸ªå¤´éƒ¨ä½†æºä¿¡æ¯ä¸åŒ¹é…ï¼Œæµè§ˆå™¨å°±ä¼šé©³å›è¯·æ±‚ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šå¤„ç†è¯·æ±‚ã€‚*</em></strong>æ³¨æ„ï¼Œè¯·æ±‚å’Œå“åº”éƒ½ä¸åŒ…å«cookieä¿¡æ¯ã€‚</p>
<h3 id="IEå¯¹CORSçš„å®ç°"><a href="#IEå¯¹CORSçš„å®ç°" class="headerlink" title="IEå¯¹CORSçš„å®ç°"></a>IEå¯¹CORSçš„å®ç°</h3><p>IE8ä¸­å¼•å…¥äº†XDRï¼ˆXDomainRequestï¼‰ç±»å‹ã€‚è¿™ä¸ªå¯¹è±¡ä¸XHRç±»ä¼¼ï¼Œä½†èƒ½å®ç°å®‰å…¨å¯é çš„è·¨åŸŸé€šä¿¡ã€‚XDRå¯¹è±¡çš„å®‰å…¨æœºåˆ¶éƒ¨åˆ†å®ç°äº†W3Cçš„CORSè§„èŒƒã€‚ä¸€ä¸‹æ˜¯XDRä¸XHRçš„ä¸€äº›ä¸åŒä¹‹å¤„ã€‚<br>1.cookieä¸ä¼šéšè¯·æ±‚å‘é€ï¼Œä¹Ÿä¸ä¼šéšå“åº”è¿”å›<br>2.åªèƒ½è®¾ç½®è¯·æ±‚å¤´éƒ¨ä¿¡æ¯çš„Content-Typeå­—æ®µ<br>3.ä¸èƒ½è®¿é—®å“åº”å¤´éƒ¨ä¿¡æ¯<br>4.åªæ”¯æŒGETå’ŒPOSTè¯·æ±‚ã€‚<br>è¿™äº›å˜åŒ–ä½¿CSRFï¼ˆCross-Site Request Forgeyï¼Œè·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ï¼‰å’ŒXSSï¼ˆCorss-Site Scriptingï¼Œè·¨ç«™ç‚¹è„šæœ¬ï¼‰çš„é—®é¢˜å¾—åˆ°äº†ç¼“è§£ã€‚è¢«è¯·æ±‚çš„èµ„æºå¯ä»¥æ ¹æ®å®ƒè®¤ä¸ºåˆé€‚çš„ä»»æ„æ•°æ®ï¼ˆç”¨æˆ·ä»£ç†ã€æ¥æºé¡µé¢ç­‰ï¼‰æ¥å†³å®šæ˜¯å¦è®¾ç½®Access-Control-Allow-Originå¤´éƒ¨ã€‚ä½œä¸ºè¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼ŒOriginå¤´éƒ¨çš„å€¼è¡¨ç¤ºè¯·æ±‚çš„æ¥æºåŸŸï¼Œä»¥ä¾¿è¿œç¨‹èµ„æºæ˜ç¡®åœ°è¯†åˆ«XDRè¯·æ±‚ã€‚<br>XDRå¯¹è±¡çš„ä½¿ç”¨æ–¹æ³•ä¸XHRå¯¹è±¡éå¸¸ç›¸ä¼¼ã€‚ä¹Ÿæ˜¯åˆ›å»ºä¸€ä¸ªXDomainRequestçš„å®ä¾‹ï¼Œè°ƒç”¨open()æ–¹æ³•ï¼Œå†è°ƒç”¨send()æ–¹æ³•ã€‚ä½†ä¸XHRå¯¹è±¡çš„open()æ–¹æ³•ä¸åŒï¼ŒXDRå¯¹è±¡çš„open()æ–¹æ³•åªæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šè¯·æ±‚çš„ç±»å‹å’ŒURLã€‚<br>æ‰€æœ‰XDRè¯·æ±‚éƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œä¸èƒ½ç”¨å®ƒæ¥åˆ›å»ºåŒæ­¥è¯·æ±‚ã€‚è¯·æ±‚è¿”å›åï¼Œä¼šè§¦å‘loadäº‹ä»¶ï¼Œå“åº”çš„æ•°æ®ä¹Ÿä¼šä¿å­˜åœ¨reponseTextå±æ€§ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xdr = <span class="keyword">new</span> XDomainRequest()</span><br><span class="line">xdr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(xdr.responseText)</span><br><span class="line">&#125;</span><br><span class="line">xdr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'error'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xdr.open(<span class="string">'get'</span>, <span class="string">'http://www.somewhere-else.com/page/'</span>)</span><br><span class="line">xdr.send(<span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<p>åœ¨è¯·æ±‚è¿”å›å‰è°ƒç”¨abort()æ–¹æ³•å¯ä»¥ç»ˆæ­¢è¯·æ±‚ï¼š<br>xdr.abort()   //ç»ˆæ­¢è¯·æ±‚</p>
<p>ä¸XHRä¸€æ ·XDRå¯¹è±¡ä¹Ÿæ”¯æŒtimeoutå±æ€§ä»¥åŠontimeoutäº‹ä»¶å¤„ç†ç¨‹åºã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xdr = <span class="keyword">new</span> XDomainRequest()</span><br><span class="line">xdr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(xdr.responseText)</span><br><span class="line">&#125;</span><br><span class="line">xdr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'error'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xdr.timeout = <span class="number">1000</span>;</span><br><span class="line">xdr.ontimeout = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'timeout'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xdr.open(<span class="string">'get'</span>,<span class="string">'url'</span>)</span><br><span class="line">xdr.send(<span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<p>ä¸ºæ”¯æŒPOSTè¯·æ±‚ï¼ŒXDRå¯¹è±¡æä¾›äº†contentTypeå±æ€§ï¼Œç”¨æ¥è¡¨ç¤ºå‘é€æ•°æ®çš„æ ¼å¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xdr = <span class="keyword">new</span> XDomainRequest()</span><br><span class="line">xdr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(xdr.responseText)</span><br><span class="line">&#125;</span><br><span class="line">xdr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'error'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xdr.timeout = <span class="number">1000</span>;</span><br><span class="line">xdr.ontimeout = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'timeout'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xdr.open(<span class="string">'post'</span>,<span class="string">'url'</span>)</span><br><span class="line">xdr.contentType = <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">xdr.send(<span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå±æ€§æ˜¯é€šè¿‡XDRå¯¹è±¡å½±å“å¤´éƒ¨ä¿¡æ¯çš„å”¯ä¸€æ–¹å¼</p>
<h3 id="å…¶ä»–æµè§ˆå™¨å¯¹CORSçš„å®ç°"><a href="#å…¶ä»–æµè§ˆå™¨å¯¹CORSçš„å®ç°" class="headerlink" title="å…¶ä»–æµè§ˆå™¨å¯¹CORSçš„å®ç°"></a>å…¶ä»–æµè§ˆå™¨å¯¹CORSçš„å®ç°</h3><p>å…¶ä»–æµè§ˆå™¨éƒ½é€šè¿‡XMLHttpRequestå¯¹è±¡å®ç°äº†å¯¹CORSçš„åŸç”Ÿæ”¯æŒã€‚åœ¨å°è¯•æ‰“å¼€ä¸åŒæ¥æºçš„èµ„æºæ—¶ï¼Œæ— éœ€é¢å¤–ç¼–å†™ä»£ç å°±å¯ä»¥è§¦å‘è¿™ä¸ªè¡Œä¸ºã€‚è¦è¯·æ±‚ä½äºå¦ä¸€ä¸ªåŸŸä¸­çš„èµ„æºï¼Œä½¿ç”¨æ ‡å‡†çš„XHRå¯¹è±¡å¹¶åœ¨open()æ–¹æ³•ä¸­ä¼ å…¥ç»å¯¹URLå³å¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = createXHR()</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span> || xhr.status == <span class="number">304</span>) &#123;</span><br><span class="line">            alert(xhr.responseText)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            alert(<span class="string">'error'</span> + xhr.status)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.open(<span class="string">'get'</span>, <span class="string">'http://www.somewhere-else.com/page/'</span>, <span class="literal">true</span>)</span><br><span class="line">xhr.send(<span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<p>ç”±äºæ— è®ºåŒæºè¯·æ±‚è¿˜æ˜¯è·¨æºè¯·æ±‚éƒ½ä½¿ç”¨ç›¸åŒçš„æ¥å£ï¼Œå› æ­¤å¯¹äºæœ¬åœ°èµ„æºï¼Œæœ€å¥½ä½¿ç”¨ç›¸å¯¹URLï¼Œåœ¨è®¿é—®è¿œç¨‹èµ„æºæ—¶å†ä½¿ç”¨ç»å¯¹URLã€‚è¿™æ ·åšèƒ½æ¶ˆé™¤æ­§ä¹‰ï¼Œé¿å…å‡ºç°é™åˆ¶è®¿é—®å¤´éƒ¨æˆ–æœ¬åœ°cookieä¿¡æ¯ç­‰é—®é¢˜ã€‚</p>
<h3 id="Preflighted-Requests"><a href="#Preflighted-Requests" class="headerlink" title="Preflighted Requests"></a>Preflighted Requests</h3><p>CORSé€šè¿‡ä¸€ç§å«åšPrefilghed Requestçš„é€æ˜æœåŠ¡å™¨éªŒè¯æœºåˆ¶æ”¯æŒå¼€å‘äººå‘˜ä½¿ç”¨è‡ªå®šä¹‰çš„å¤´éƒ¨ã€GETæˆ–POSTä¹‹å¤–çš„æ–¹æ³•ï¼Œä»¥åŠä¸åŒç±»å‹çš„ä¸»ä½“å†…å®¹ã€‚åœ¨ä½¿ç”¨ä¸‹åˆ—é«˜çº§é€‰é¡¹æ¥å‘é€è¯·æ±‚æ—¶ï¼Œå°±ä¼šåƒæœåŠ¡å™¨å‘é€ä¸€ä¸ªPreflightè¯·æ±‚ã€‚è¿™ç§è¯·æ±‚ä½¿ç”¨OPTIONSæ–¹æ³•ï¼Œå‘é€ä¸‹åˆ—å¤´éƒ¨ã€‚<br>1.Originï¼šä¸ç®€å•çš„è¯·æ±‚ç›¸åŒ<br>2.Access-Control-Request-Methodï¼šè¯·æ±‚è‡ªèº«ä½¿ç”¨çš„æ–¹æ³•ã€‚<br>3.Access-Control-Request-Headersï¼šï¼ˆå¯é€‰ï¼‰è‡ªå®šä¹‰çš„å¤´éƒ¨ä¿¡æ¯ï¼Œå¤šä¸ªå¤´éƒ¨ä»¥é€—å·åˆ†éš”ã€‚<br>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¸¦æœ‰è‡ªå®šä¹‰å¤´éƒ¨NCZçš„ä½¿ç”¨POSTæ–¹æ³•å‘é€çš„è¯·æ±‚ã€‚<br>Origin: <a href="http://www.nczonline.net" target="_blank" rel="noopener">http://www.nczonline.net</a><br>Access-Control-Request-Method: POST<br>Access-Control-Request-Headers: NCZ<br>å‘é€è¿™ä¸ªè¯·æ±‚åï¼ŒæœåŠ¡å™¨å¯ä»¥å†³å®šæ˜¯å¦å…è®¸è¿™ç§ç±»å‹çš„è¯·æ±‚ã€‚æœåŠ¡å™¨é€šè¿‡åœ¨å“åº”ä¸­å‘é€å¦‚ä¸‹å¤´éƒ¨ä¸æµè§ˆå™¨è¿›è¡Œæ²Ÿé€šã€‚<br>1.Access-Control-Allow-Originï¼šä¸ç®€å•çš„è¯·æ±‚ç›¸åŒã€‚<br>2.Access-Control-Allow-Methodsï¼šå…è®¸çš„æ–¹æ³•ï¼Œå¤šä¸ªæ–¹æ³•ä»¥é€—å·åˆ†éš”<br>3.Access-Control-Allow-Headersï¼šå…è®¸çš„å¤´éƒ¨ï¼Œå¤šä¸ªå¤´éƒ¨ä»¥é€—å·åˆ†éš”<br>4.Access-Control-Max-Ageï¼šåº”è¯¥è®²è¿™ä¸ªPreflightè¯·æ±‚ç¼“å­˜å¤šé•¿æ—¶é—´</p>
<p>ä¾‹å¦‚ï¼š<br>Access-Control-Allow-Origin: <a href="http://www.nczonline.net" target="_blank" rel="noopener">http://www.nczonline.net</a><br>Access-Control-Allow-Methods: POST, GET<br>Access-Control-Allow-Headers: NCZ<br>Access-Control-Max-Age: 172800<br>Preflightè¯·æ±‚ç»“æŸåï¼Œç»“æœå°†æŒ‰ç…§å“åº”ä¸­æŒ‡å®šçš„æ—¶é—´ç¼“å­˜èµ·æ¥</p>
<h3 id="å¸¦å‡­æ®çš„è¯·æ±‚"><a href="#å¸¦å‡­æ®çš„è¯·æ±‚" class="headerlink" title="å¸¦å‡­æ®çš„è¯·æ±‚"></a>å¸¦å‡­æ®çš„è¯·æ±‚</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¨åŸŸè¯·æ±‚ä¸æä¾›å‡­æ®ï¼ˆcookieã€HTTPè®¤è¯åŠå®¢æˆ·ç«¯SSLè¯æ˜ç­‰ï¼‰ã€‚é€šè¿‡å°†withCredentialså±æ€§è®¾ç½®ä¸ºtrueï¼Œå¯ä»¥æŒ‡å®šæŸä¸ªè¯·æ±‚åº”è¯¥å‘é€å‡­æ®ã€‚å¦‚æœæœåŠ¡å™¨æ¥æ”¶å¸¦å‡­æ®çš„è¯·æ±‚ï¼Œå°±ä¼šç”¨ä¸‹é¢çš„HTTPå¤´éƒ¨æ¥å“åº”ã€‚<br>Access-Control-Allow-Credentials: true<br>å¦‚æœå‘é€çš„æ˜¯å¸¦å‡­æ®çš„è¯·æ±‚ï¼Œå•æœåŠ¡å™¨çš„å“åº”ä¸­æ²¡æœ‰åŒ…å«è¿™ä¸ªå¤´éƒ¨ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¸ä¼šæŠŠå“åº”äº¤ç»™JavaScriptï¼ˆäºæ˜¯ï¼ŒresponseTextä¸­å°†æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œstatusçš„å€¼ä¸º0ï¼Œè€Œä¸”ä¼šè°ƒç”¨onerror()äº‹ä»¶å¤„ç†ç¨‹åºï¼‰ã€‚å¦å¤–æœåŠ¡å™¨è¿˜å¯ä»¥åœ¨Preflightå“åº”ä¸­å‘é€è¿™ä¸ªHTTPå¤´éƒ¨ï¼Œè¡¨ç¤ºå…è®¸æºå‘é€å¸¦å‡­æ®çš„è¯·æ±‚ã€‚</p>
<h2 id="å…¶ä»–è·¨åŸŸæŠ€æœ¯"><a href="#å…¶ä»–è·¨åŸŸæŠ€æœ¯" class="headerlink" title="å…¶ä»–è·¨åŸŸæŠ€æœ¯"></a>å…¶ä»–è·¨åŸŸæŠ€æœ¯</h2><p>åœ¨CORSå‡ºç°ä»¥å‰ï¼Œè¦å®ç°è·¨åŸŸAjaxé€šä¿¡ç ´è´¹ä¸€äº›å‘¨æŠ˜ã€‚å¼€å‘äººå‘˜æƒ³å‡ºäº†ä¸€äº›åŠæ³•ï¼Œåˆ©ç”¨DOMä¸­èƒ½å¤Ÿæ‰§è¡Œè·¨åŸŸè¯·æ±‚çš„åŠŸèƒ½ï¼Œåœ¨ä¸ä¾èµ–XHRå¯¹è±¡çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å‘é€æŸç§è¯·æ±‚ã€‚è™½ç„¶CORSæŠ€æœ¯å·²ç»æ— å¤„ä¸åœ¨ï¼Œä½†å¼€å‘äººå‘˜è‡ªå·±å‘æ˜çš„æŠ€æœ¯ä»ç„¶è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå› ä¸ºä¸éœ€è¦ä¿®æ”¹æœåŠ¡å™¨ç«¯ä»£ç ã€‚</p>
<h3 id="å­åŸŸå’Œçˆ¶åŸŸè·¨åŸŸ"><a href="#å­åŸŸå’Œçˆ¶åŸŸè·¨åŸŸ" class="headerlink" title="å­åŸŸå’Œçˆ¶åŸŸè·¨åŸŸ"></a>å­åŸŸå’Œçˆ¶åŸŸè·¨åŸŸ</h3><p>ä¿®æ”¹è„šæœ¬çš„documet.domainä¸ºåŒä¸€åŸŸåå®ç°è·¨åŸŸï¼ˆå¿…é¡»åœ¨åŒä¸€çˆ¶åŸŸä¸‹ï¼‰ã€‚</p>
<h3 id="å›¾åƒPing"><a href="#å›¾åƒPing" class="headerlink" title="å›¾åƒPing"></a>å›¾åƒPing</h3><p>ä¸Šè¿°ç¬¬ä¸€ç§è·¨åŸŸè¯·æ±‚æŠ€æœ¯æ˜¯ä½¿ç”¨<img>æ ‡ç­¾ã€‚ä¸€ä¸ªç½‘é¡µå¯ä»¥ä»ä»»ä½•ç½‘é¡µä¸­åŠ è½½å›¾åƒï¼Œä¸ç”¨æ‹…å¿ƒè·¨åŸŸä¸è·¨åŸŸã€‚è¿™ä¹Ÿæ˜¯åœ¨çº¿å¹¿å‘Šè·Ÿè¸ªæµè§ˆé‡çš„ä¸»è¦æ–¹å¼ã€‚ä¹Ÿå¯ä»¥åŠ¨æ€åœ°åˆ›å»ºå›¾åƒï¼Œä½¿ç”¨å®ƒä»¬çš„onloadå’Œonerroräº‹ä»¶å¤„ç†ç¨‹åºæ¥ç¡®å®šæ˜¯å¦æ¥æ”¶åˆ°äº†å“åº”ã€‚<br>åŠ¨æ€åˆ›å»ºå›¾åƒç»å¸¸ç”¨äºå›¾åƒPingã€‚å›¾åƒPingæ˜¯æœåŠ¡å™¨è¿›è¡Œç®€å•ã€å•å‘çš„è·¨åŸŸé€šä¿¡çš„ä¸€ç§æ–¹å¼ã€‚è¯·æ±‚çš„æ•°æ®æ˜¯é€šè¿‡æŸ¥è¯¢å­—ç¬¦å½¢å¼å‘é€çš„ï¼Œè€Œå“åº”å¯ä»¥æ˜¯ä»»æ„å†…å®¹ï¼Œä½†é€šå¸¸æ˜¯åƒç´ å›¾æˆ–204å“åº”ã€‚é€šè¿‡å›¾åƒPingï¼Œæµè§ˆå™¨å¾—ä¸åˆ°ä»»ä½•å…·ä½“çš„æ•°æ®ï¼Œä½†é€šè¿‡çœŸæŒºloadå’Œerroräº‹ä»¶ï¼Œèƒ½çŸ¥é“å“åº”æ˜¯ä»€ä¹ˆæ—¶å€™æ¥æ”¶åˆ°çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">img.onload = img.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'done'</span>)</span><br><span class="line">&#125;</span><br><span class="line">img.src = <span class="string">'http://www.example.com/test?name=Nicholas"</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªImageçš„å®ä¾‹ï¼Œç„¶åå°†onloadå’Œonerroräº‹ä»¶å¹ç¨‹åºæŒ‡å®šä¸ºåŒä¸€ä¸ªå‡½æ•°ã€‚è¿™æ ·æ— è®ºæ˜¯ä»€ä¹ˆå“åº”ï¼Œåªè¦è¯·æ±‚å®Œæˆï¼Œå°±èƒ½å¾—åˆ°é€šçŸ¥ã€‚**è¯·æ±‚ä»è®¾ç½®srcå±æ€§é‚£ä¸€åˆ»å¼€å§‹ï¼Œè€Œè¿™ä¸ªä¾‹å­åœ¨å•Šè¯·æ±‚ä¸­å‘é€äº†ä¸€ä¸ªnameå‚æ•°ã€‚<br>å›¾åƒPingæœ€å¸¸ç”¨äºè·Ÿè¸ªç”¨æˆ·ç‚¹å‡»é¡µé¢æ´»åŠ¨å¤ªå¹¿å‘Šæ›å…‰æ¬¡æ•°ã€‚å›¾åƒPingæœ‰ä¸¤ä¸ªä¸»è¦çš„ç¼ºç‚¹ï¼Œä¸€æ˜¯åªèƒ½å‘é€GETè¯·æ±‚ï¼ŒäºŒæ˜¯æ— æ³•è®¿é—®æœåŠ¡å™¨çš„å“åº”æ–‡æœ¬ã€‚å› æ­¤å›¾åƒPingåªèƒ½ç”¨äºæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´é¢å•å‘é€šä¿¡ã€‚</p>
<h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h3><p>JSONPæ˜¯JSON with paddingï¼ˆå¡«å……å¼JSONæˆ–å‚æ•°å¼JSONï¼‰çš„ç®€å†™ï¼Œæ˜¯åº”ç”¨JSONçš„ä¸€ç§æ–°æ–¹æ³•ï¼Œå†åæ¥çš„WebæœåŠ¡ä¸­éå¸¸æµè¡Œã€‚JSONPçœ‹èµ·æ¥ä¸JSONå·®ä¸å¤šï¼Œåªä¸è¿‡æ˜¯åŒ…å«åœ¨å‡½æ•°è°ƒç”¨ä¸­çš„JSONå°±åƒä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">callback(&#123;<span class="string">'name'</span>: <span class="string">'Nicholas'</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>JSONPç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå›è°ƒå‡½æ•°å’Œæ•°æ®ã€‚å›è°ƒå‡½æ•°æ˜¯å½“å“åº”åˆ°æ¥æ—¶åº”è¯¥åœ¨é¡µé¢ä¸­è°ƒç”¨çš„å‡½æ•°ã€‚å›è°ƒå‡½æ•°çš„åå­—ä¸€èˆ¬æ˜¯åœ¨è¯·æ±‚ä¸­æŒ‡å®šçš„ã€‚è€Œæ•°æ®å°±æ˜¯ä¼ å…¥å›è°ƒå‡½æ•°ä¸­çš„JSONæ•°æ®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„JSONPè¯·æ±‚<br><a href="http://freegeoip.net/json/?callback=handleResponse" target="_blank" rel="noopener">http://freegeoip.net/json/?callback=handleResponse</a><br>è¿™ä¸ªURLæ˜¯åœ¨è¯·æ±‚ä¸€ä¸ªJSONPåœ°ç†å®šä½æœåŠ¡ã€‚é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²æ¥æŒ‡å®šJSONPæœåŠ¡çš„å›è°ƒå‡½æ•°ï¼Œå°±åƒä¸Šé¢çš„URLæ‰€ç¤ºï¼Œè¿™é‡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°çš„åå­—å«handlerResponse()<br>JSONPæ˜¯é€šè¿‡åŠ¨æ€scriptæ ‡ç­¾æ¥ä½¿ç”¨ï¼Œä½¿ç”¨æ—¶å¯ä»¥ä¸ºsrcå±æ€§æŒ‡å®šä¸€ä¸ªè·¨åŸŸURLã€‚è¿™é‡Œçš„scriptå…ƒç´ ä¸imgå…ƒç´ ç±»ä¼¼ï¼Œéƒ½æœ‰èƒ½åŠ›ä¸å—é™åˆ¶çš„ä»å…¶ä»–åŸŸä¸­åŠ è½½èµ„æºã€‚å› ä¸ºJSONPæ˜¯æœ‰æ•ˆçš„JavaScriptä»£ç ï¼Œæ‰€ä»¥åœ¨è¯·æ±‚å®Œæˆåï¼Œå³åœ¨JSONPå“åº”åŠ è½½åˆ°é¡µé¢ä¸­ä»¥åï¼Œå°±ä¼šç«‹å³æ‰§è¡Œã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleResponse</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'you are at ip address'</span> + response.ip + <span class="string">'which is in'</span> resoponse.city + <span class="string">','</span> + response.region_name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</span><br><span class="line">script.src = <span class="string">'http://freegeoip.net/json/?callback=handleResponse'</span></span><br><span class="line"><span class="built_in">document</span>.body.insertBefore(script, documetn.body.firstChild)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­é€šè¿‡æŸ¥è¯¢åœ°ç†å®šä½æœåŠ¡æ¥æ˜¾ç¤ºIPåœ°å€å’Œä½ç½®ä¿¡æ¯ã€‚<br>JSONPä¹‹æ‰€ä»¥åœ¨å¼€å‘äººå‘˜ä¸­æä¸ºæµè¡Œï¼Œåªè¦åŸå› æ˜¯å®ƒéå¸¸ç®€å•æ˜“ç”¨ã€‚ä¸å›¾åƒPingç›¸æ¯”ï¼Œå®ƒçš„ä¼˜ç‚¹åœ¨äºèƒ½å¤Ÿç›´æ¥è®¿é—®å“åº”æ–‡æœ¬ï¼Œæ”¯æŒåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´åŒå‘é€šä¿¡ã€‚ä¸è¿‡ï¼ŒJSONPä¹Ÿæœ‰ä¸¤ç‚¹ä¸è¶³ã€‚<br>é¦–å…ˆï¼ŒJSONPæ˜¯ä»å…¶ä»–åŸŸä¸­åŠ è½½ä»£ç æ‰§è¡Œã€‚å¦‚æœå…¶ä»–åŸŸä¸å®‰å…¨ï¼Œå¾ˆå¯èƒ½ä¼šåœ¨å“åº”å¤¹å¸¦ä¸€äº›æ¶æ„ä»£ç ï¼Œè€Œæ­¤æ—¶é™¤äº†å®Œå…¨æ”¾å¼ƒJSONPè°ƒç”¨ä¹‹å¤–ï¼Œæ²¡æœ‰åŠæ³•è¿½ç©¶ã€‚<br>å…¶æ¬¡è¦ç¡®å®šJSONPè¯·æ±‚æ˜¯å¦å¤±è´¥å¹¶ä¸å®¹æ˜“ã€‚è™½ç„¶HTML5ç»™â€˜scriptâ€™å…ƒç´ æ–°å¢äº†ä¸€ä¸ªonerroräº‹ä»¶å¤„ç†ç¨‹åºï¼Œä½†ç›®å‰è¿˜æ²¡æœ‰å¾—åˆ°ä»»ä½•æµè§ˆå™¨æ”¯æŒã€‚ä¸ºæ­¤ï¼Œå¼€å‘äººå‘˜ä¸å¾—ä¸ä½¿ç”¨è®¡æ—¶å™¨æ£€æµ‹æŒ‡å®šæ—¶é—´å†…æ˜¯å¦æ¥æ”¶åˆ°äº†å“åº”ã€‚ä½†å°±ç®—è¿™æ ·ä¹Ÿä¸èƒ½å°½å¦‚äººæ„ï¼Œæ¯•ç«Ÿä¸æ˜¯æ¯ä¸ªç”¨æˆ·ä¸Šç½‘çš„é€Ÿåº¦å’Œå¸¦å®½éƒ½ä¸€æ ·ã€‚</p>
<h3 id="Comet"><a href="#Comet" class="headerlink" title="Comet"></a>Comet</h3><p>Cometå€¼å¾—æ˜¯ä¸€ç§æ›´é«˜çº§çš„AjaxæŠ€æœ¯ï¼ˆç»å¸¸ä¹Ÿæœ‰äººç§°ä¸ºâ€˜æœåŠ¡å™¨æ¨é€â€™ï¼‰ã€‚Ajaxæ˜¯ä¸€ç§ä»é¡µé¢å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®çš„æŠ€æœ¯ï¼Œè€ŒCometåˆ™æ˜¯ä¸€ç§æœåŠ¡å™¨å‘é¡µé¢æ¨é€æ•°æ®çš„æŠ€æœ¯ã€‚Cometèƒ½å¤Ÿè®©ä¿¡æ¯è¿‘ä¹å®æ—¶åœ°è¢«æ¨é€åˆ°é¡µé¢ä¸Šï¼Œéå¸¸é€‚åˆå¤„ç†ä½“è‚²æ¯”èµ›çš„åˆ†æ•°å’Œè‚¡ç¥¨æŠ¥ä»·ã€‚<br>æœ‰ä¸¤ç§å®ç°Cometçš„æ–¹å¼ï¼šé•¿è½®è¯¢å’Œæµã€‚é•¿è½®è¯¢æ˜¯ä¼ ç»Ÿè½®è¯¢ï¼ˆä¹Ÿç§°çŸ­è½®è¯¢ï¼‰çš„ä¸€ä¸ªç¿»ç‰ˆï¼Œå³æµè§ˆå™¨å®šæ—¶å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œçœ‹æœ‰æ²¡æœ‰æ›´æ–°çš„æ•°æ®ã€‚<br>é•¿è½®è¯¢æŠŠçŸ­è½®è¯¢é¢ å€’äº†ä¸€ä¸‹ã€‚é¡µé¢å‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨ä¸€ç›´ä¿æŒè¿æ¥æ‰“å¼€ï¼Œç›´åˆ°æœ‰æ•°æ®å¯ä»¥å‘é€ã€‚å‘é€å®Œæ•°æ®æ—¶å€™ï¼Œæµè§ˆå™¨å…³é—­è¿æ¥ï¼Œéšå³åˆå‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨çš„æ–°è¯·æ±‚ã€‚<br>æ— è®ºé•¿è½®è¯¢è¿˜æ˜¯çŸ­è½®è¯¢ï¼Œæµè§ˆå™¨éƒ½è¦åœ¨æ¥æ”¶æ•°æ®ä¹‹å‰ï¼Œå…ˆå‘èµ·å¯¹æœåŠ¡å™¨çš„é“¾æ¥ã€‚ä¸¤è€…æœ€å¤§çš„åŒºåˆ«åœ¨äºæœåŠ¡å™¨å¦‚ä½•å‘é€æ•°æ®ã€‚çŸ­è½®è¯¢æ˜¯æœåŠ¡å™¨ç«‹å³å‘é€å“åº”ï¼Œæ— è®ºæ•°æ®æ˜¯å¦æœ‰æ•ˆï¼Œè€Œé•¿è½®è¯¢åˆ™æ˜¯ç­‰å¾…å‘é€å“åº”ã€‚è½®è¯¢çš„ä¼˜åŠ¿æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒï¼Œå› ä¸ºä½¿ç”¨XHRå¯¹è±¡å’ŒsetTimeout()å°±èƒ½å®ç°ã€‚<br>ç¬¬äºŒç§æµè¡Œçš„Cometå®ç°æ˜¯HTTPæµã€‚æµä¸åŒäºä¸Šè¿°ä¸¤ç§è½®è¯¢æ–¹å¼ï¼Œå› ä¸ºå®ƒåœ¨é¡µé¢çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…åªæ˜¯ç”¨ä¸€ä¸ªHTTPé“¾æ¥ã€‚å…·ä½“æ¥è¯´å°±æ˜¯æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè€ŒæœåŠ¡å™¨ä¿æŒé“¾æ¥æ‰“å¼€ï¼Œç„¶åå‘¨æœŸæ€§çš„å‘æµè§ˆå™¨å‘é€æ•°æ®ã€‚<br>åœ¨Firefoxå’ŒChormeä¸­ï¼Œé€šè¿‡ä¾¦å¬readystatechangeäº‹ä»¶åŠreadyStateçš„å€¼æ˜¯å¦ä¸º3ï¼Œå°±å¯ä»¥åˆ©ç”¨XHRå¯¹è±¡å®ç°HTTPæµã€‚åœ¨ä¸Šè¿°è¿™äº›æµè§ˆå™¨ä¸­ï¼Œéšç€ä¸æ–­ä»æœåŠ¡å™¨æ¥æ”¶æ•°æ®ï¼ŒreadyStateçš„å€¼ä¼šå‘¨æœŸæ€§åœ°å˜ä¸º3.dangreadyStateå€¼å˜ä¸º3æ—¶ï¼ŒresponseTextå±æ€§ä¸­å°±ä¼šä¿å­˜æ¥æ”¶åˆ°çš„æ‰€æœ‰æ•°æ®ã€‚æ­¤æ—¶ï¼Œå°±éœ€è¦æ¯”è¾ƒæ­¤å‰æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå†³å®šä»ä»€ä¹ˆä½ç½®å¼€å§‹å–å¾—æœ€æ–°çš„æ•°æ®ã€‚ä½¿ç”¨XHRå¯¹è±¡å®ç°HTTPæµçš„å…¸å‹ä»£ç å¦‚ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createStreamingClinet</span>(<span class="params">url, progress, finished</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">    <span class="keyword">var</span> received = <span class="number">0</span>;</span><br><span class="line">    xhr.open(<span class="string">'get'</span>, url, <span class="literal">true</span>)</span><br><span class="line">    xrh.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> result;</span><br><span class="line">        <span class="keyword">if</span> (xhr.readyState == <span class="number">3</span>) &#123;</span><br><span class="line">            result = xhr.responseText.substring(received)</span><br><span class="line">            received +=result.length</span><br><span class="line">            progress(result)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">            finished(xhr.responseText)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.send(<span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">return</span> xhr</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> client = creatStreamingClient(<span class="string">'streaming.php'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'Received: '</span> + data)</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'done'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªcreateStreamingClient()å‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šè¦è¿æ¥çš„URLã€åœ¨æ¥æ”¶åˆ°æ•°æ®æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚æœ‰æ—¶å€™ï¼Œå½“è¿æ¥å…³é—­æ—¶ï¼Œå¾ˆæœ‰å¯èƒ½éœ€è¦é‡æ–°å»ºç«‹ï¼Œæ‰€ä»¥å…³æ³¨è¿æ¥ï¼Œæ‰€ä»¥å…³æ³¨è¿æ¥ä»€ä¹ˆæ—¶å€™å…³é—­è¿˜æ˜¯æœ‰å¿…è¦çš„ã€‚<br>åªè¦readystatechangeäº‹ä»¶å‘ç”Ÿï¼Œè€Œä¸”readyStateå€¼ä¸º3ï¼Œå°±å¯¹responseTextè¿›è¡Œåˆ†å‰²ä»¥å–å¾—æœ€æ–°æ•°æ®ã€‚è¿™é‡Œçš„receivedå˜é‡ç”¨äºè®°å½•å·²ç»å¤„ç†äº†å¤šå°‘ä¸ªå­—ç¬¦ï¼Œæ¯æ¬¡readyStateå€¼ä¸º3æ—¶éƒ½é€’å¢ã€‚ç„¶åï¼Œé€šè¿‡processå›è°ƒå‡½æ•°æ¥å¤„ç†ä¼ å…¥çš„æ–°æ•°æ®ã€‚è€Œå½“readyStateå€¼ä¸º4æ—¶åˆ™æ‰§è¡Œfinishedå›è°ƒå‡½æ•°ï¼Œä¼ å…¥å“åº”è¿”å›çš„å…¨éƒ¨å†…å®¹ã€‚</p>
<h3 id="æœåŠ¡å™¨å‘é€äº‹ä»¶"><a href="#æœåŠ¡å™¨å‘é€äº‹ä»¶" class="headerlink" title="æœåŠ¡å™¨å‘é€äº‹ä»¶"></a>æœåŠ¡å™¨å‘é€äº‹ä»¶</h3><p>SSEï¼ˆServe-Sent Eventsï¼ŒæœåŠ¡å™¨å‘é€äº‹ä»¶ï¼‰æ˜¯å›´ç»•åªè¯»Cometäº¤äº’æ¨å‡ºçš„APIæˆ–è€…æ¨¡å¼ã€‚SSEAPIç”¨äºåˆ›å»ºåˆ°æœåŠ¡å™¨çš„å•å‘è¿æ¥ï¼ŒæœåŠ¡å™¨é€šè¿‡è¿™ä¸ªé“¾æ¥å¯ä»¥å‘é€ä»»æ„æ•°é‡çš„æ•°æ®ã€‚æœåŠ¡å™¨å“åº”çš„MIMEç±»å‹å¿…é¡»æ˜¯text/event-stream,è€Œä¸”æ˜¯æµè§ˆå™¨ä¸­çš„JavaScript APIèƒ½è§£ææ ¼å¼è¾“å‡ºã€‚SSEæ”¯æŒçŸ­è½®è¯¢ã€é•¿è½®è¯¢å’ŒHTTPæµï¼Œè€Œä¸”èƒ½åœ¨æ–­å¼€è¿æ¥æ—¶è‡ªåŠ¨ç¡®å®šåˆé€‚é‡æ–°è¿æ¥ã€‚æœ‰äº†è¿™ä¹ˆç®€å•å®ç”¨çš„APIï¼Œå†å®ç°Cometå°±å®¹æ˜“å¤šäº†ã€‚</p>
<p>1.SSE API<br>SSEçš„JavaScript APIä¸å…¶ä»–ä¼ é€’æ¶ˆæ¯çš„JavaScript APIå¾ˆç›¸ä¼¼ã€‚è¦é¢„å®šæ–°çš„äº‹ä»¶æµï¼Œé¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªæ–°çš„EventSourceå¯¹è±¡ï¼Œå¹¶ä¼ è¿›ä¸€ä¸ªå…¥å£ç‚¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> source = <span class="keyword">new</span> EVENTSource(<span class="string">'myevents.php'</span>)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä¼ å…¥çš„URLå¿…é¡»ä¸åˆ›å»ºå¯¹è±¡çš„é¡µé¢åŒæºï¼ˆç›¸åŒçš„URLæ¨¡å¼ã€åŸŸä»¥åŠç«¯å£ï¼‰ã€‚EventSourceçš„å®ä¾‹æœ‰ä¸€ä¸ªreadyStateå±æ€§ï¼Œå€¼ä¸º0è¡¨ç¤ºæ­£è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œå€¼ä¸º1è¡¨ç¤ºæ‰“å¼€äº†è¿æ¥ï¼Œå€¼ä¸º2è¡¨ç¤ºå…³é—­äº†è¿æ¥ã€‚<br>å¦å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹ä¸‰ä¸ªäº‹ä»¶ã€‚<br>1.openï¼šåœ¨å»ºç«‹è¿æ¥æ—¶è§¦å‘<br>2.messageï¼šåœ¨ä»æœåŠ¡å™¨æ¥æ”¶åˆ°æ–°äº‹ä»¶æ—¶è§¦å‘ã€‚<br>3.errorï¼šåœ¨æ— æ³•å»ºç«‹è¿æ¥æ—¶è§¦å‘ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> data = event.data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœåŠ¡å™¨å‘å›çš„æ•°æ®ä»¥å­—ç¬¦ä¸²å½¢å¼ä¿å­˜åœ¨event.dataä¸­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œeventsourceå¯¹è±¡ä¼šä¿æŒä¸æœåŠ¡å™¨çš„æ´»åŠ¨è¿æ¥ã€‚å¦‚æœè¿æ¥æ–­å¼€ï¼Œè¿˜ä¼šé‡æ–°è¿æ¥ã€‚è¿™å°±æ„å‘³ç€SSEç¤¾å’Œé•¿è½®è¯¢å’ŒHTTPæµã€‚å¦‚æœæƒ³å¼ºåˆ¶ç«‹å³æ–­å¼€è¿æ¥å¹¶ä¸”ä¸å†é‡æ–°è¿æ¥ï¼Œå¯ä»¥è°ƒç”¨close()æ–¹æ³•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source.close()</span><br></pre></td></tr></table></figure>

<p>2.äº‹ä»¶æµ<br>æ‰€è°“çš„æœåŠ¡å™¨äº‹ä»¶ä¼šé€šè¿‡ä¸€ä¸ªæŒä¹…çš„HTTPå“åº”å‘é€ï¼Œè¿™ä¸ªå“åº”çš„MIMEç±»å‹ä¸ºtext/event-streamã€‚å“åº”çš„æ ¼å¼æ˜¯çº¯æ–‡æœ¬ï¼Œæœ€ç®€å•çš„æƒ…å†µæ˜¯æ¯ä¸ªæ•°æ®é¡¹éƒ½å¸¦æœ‰å‰ç¼€dataï¼šï¼Œä¾‹å¦‚<br>data: foo</p>
<p>data: bar</p>
<p>data: foo<br>data: bar<br>å¯¹äºä»¥ä¸Šå“åº”ï¼Œäº‹ä»¶æµä¸­çš„ç¬¬ä¸€ä¸ªmessageäº‹ä»¶è¿”å›çš„event.dataå€¼ä¸ºfooï¼Œç¬¬äºŒä¸ªmessageäº‹ä»¶è¿”å›çš„event.dataå€¼ä¸ºbarï¼Œç¬¬ä¸‰ä¸ªmessageäº‹ä»¶è¿”å›çš„event.dataå€¼ä¸ºfoo\nbarã€‚å¯¹äºå¤šä¸ªè¿ç»­çš„ä»¥data:å¼€å¤´çš„æ•°æ®è¡Œï¼Œå°†ä½œä¸ºå¤šç«¯æ•°æ®è§£æï¼Œæ¯ä¸ªå€¼ä¹‹é—´ä»¥ä¸€ä¸ªæ¢è¡Œç¬¦åˆ†éš”ã€‚åªæœ‰åœ¨åŒ…å«data:çš„æ•°æ®è¡Œåé¢æœ‰ç©ºè¡Œæ—¶ï¼Œæ‰ä¼šè§¦å‘messageäº‹ä»¶ï¼Œå› æ­¤åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆäº‹ä»¶æµæ—¶ä¸èƒ½å¿˜äº†å¤šæ·»åŠ è¿™ä¸€è¡Œã€‚<br>é€šè¿‡id:å‰ç¼€å¯ä»¥ç»™ç‰¹å®šçš„äº‹ä»¶æŒ‡å®šä¸€ä¸ªå…³è”çš„IDï¼Œè¿™ä¸ªIDè¡Œä½äºdata:è¡Œå‰é¢æˆ–åé¢<br>data: foo<br>id: 1<br>è®¾ç½®äº†IDåï¼ŒEventSourceå¯¹è±¡ä¸Šä¼šè·Ÿè¸ªä¸Šä¸€æ¬¡è§¦å‘çš„äº‹ä»¶ã€‚å¦‚æœè¿æ¥æ–­å¼€ï¼Œä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªåŒ…å«åä¸ºLast-Event-IDçš„ç‰¹æ®ŠHTTPå¤´éƒ¨çš„è¯·æ±‚ï¼Œä»¥ä¾¿æœåŠ¡å™¨çŸ¥é“ä¸‹æ¬¡è¯¥è§¦å‘å“ªä¸ªäº‹ä»¶ã€‚å†å¤šæ¬¡è¿æ¥çš„äº‹ä»¶æµä¸­ï¼Œè¿™ç§æœºåˆ¶å¯ä»¥ç¡®ä¿æµè§ˆå™¨ä»¥æ­£ç¡®çš„é¡ºåºæ¥æ”¶åˆ°è¿æ¥çš„æ•°æ®æ®µã€‚</p>
<h3 id="Web-Sockets"><a href="#Web-Sockets" class="headerlink" title="Web Sockets"></a>Web Sockets</h3><p>Web Socketsçš„ç›®æ ‡æ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„æŒä¹…è¿æ¥ä¸Šæä¾›å…¨åŒå·¥ã€åŒå‘é€šä¿¡ã€‚åœ¨JavaScriptä¸­åˆ›å»ºäº†Web Socketä¹‹åï¼Œä¼šæœ‰ä¸€ä¸ªHTTPè¯·æ±‚å‘é€åˆ°æµè§ˆå™¨ä»¥å‘èµ·è¿æ¥ã€‚åœ¨å–å¾—æœåŠ¡å™¨å“åº”ä¹‹åï¼Œå»ºç«‹çš„é“¾æ¥ä¼šä½¿ç”¨HTTPå‡çº§ä»HTTPåè®®äº¤æ¢ä¸ºWeb Socketåè®®ï¼Œå°±æ˜¯è¯´ï¼Œä½¿ç”¨æ ‡å‡†çš„HTTPæœåŠ¡å™¨æ— æ³•å®ç°Web Socketsï¼Œåªæœ‰æ”¯æŒè¿™ç§åè®®çš„ä¸“é—¨æœåŠ¡å™¨æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚<br>ç”±äºWeb Socketsä½¿ç”¨äº†è‡ªå®šä¹‰çš„åè®®ï¼Œæ‰€ä»¥URLæ¨¡å¼ä¹Ÿç•¥æœ‰ä¸åŒã€‚æœªåŠ å¯†çš„é“¾æ¥ä¸å†æ˜¯http://,è€Œæ˜¯ws://ã€‚åŠ å¯†çš„é“¾æ¥ä¹Ÿä¸æ˜¯https://,è€Œæ˜¯wss://ã€‚åœ¨ä½¿ç”¨Web Socket URLæ—¶ï¼Œå¿…é¡»å¸¦ç€è¿™ä¸ªæ¨¡å¼ï¼Œå› ä¸ºå°†æ¥è¿˜æœ‰å¯èƒ½æ”¯æŒå…¶ä»–æ¨¡å¼ã€‚<br>ä½¿ç”¨è‡ªå®šä¹‰åè®®è€ŒéHTTPåè®®çš„å¥½å¤„æ˜¯ï¼Œèƒ½å¤Ÿåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å‘é€éå¸¸å°‘é‡çš„æ•°æ®ï¼Œè€Œä¸å¿…æ‹…å¿ƒHTTPé‚£æ ·çš„å­—èŠ‚çº§çš„å¼€é”€ã€‚ç”±äºä¼ é€’çš„æ•°æ®åŒ…å¾ˆå°ï¼Œå› æ­¤Web Socketséå¸¸é€‚åˆç§»åŠ¨åº”ç”¨ã€‚æ¯•ç«Ÿå¯¹ç§»åŠ¨åº”ç”¨è€Œè¨€ï¼Œå¸¦å®½å’Œç½‘ç»œå»¶è¿Ÿéƒ½æ˜¯å…³é”®é—®é¢˜ã€‚ä½¿ç”¨è‡ªå®šä¹‰åè®®çš„ç¼ºç‚¹åœ¨äºï¼ŒæŒ‡å®šåè®®çš„æ—¶é—´æ¯”æŒ‡å®šJavaScript APIçš„æ—¶é—´è¿˜è¦é•¿ã€‚</p>
<p>1.Web Sockets API<br>è¦åˆ›å»ºWeb Socketï¼Œå…ˆå®ä¾‹åŒ–ä¸€ä¸ªWebSocketå¯¹è±¡å¹¶ä¼ å…¥è¦è¿æ¥çš„URL</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">'ws://www.example.com/server.php'</span>)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„å¿…é¡»ç»™WebSocketæ„é€ å‡½æ•°ä¼ å…¥ç»å¯¹URLã€‚åŒæºç­–ç•¥å¯¹Web Socketsä¸é€‚ç”¨ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å®ƒæ‰“å¼€åˆ°ä»»ä½•ç«™ç‚¹çš„é“¾æ¥ã€‚è‡³äºæ˜¯å¦ä¼šä¸æŸä¸ªåŸŸä¸­çš„é¡µé¢é€šä¿¡ï¼Œåˆ™å®Œå…¨å–å†³äºæœåŠ¡å™¨ã€‚ï¼ˆé€šè¿‡æ¡æ‰‹ä¿¡æ¯å°±å¯ä»¥çŸ¥é“è¯·æ±‚æ¥è‡ªä½•æ–¹ï¼‰</p>
<p>å®ä¾‹åŒ–äº†WebSocketå¯¹è±¡åï¼Œæµè§ˆå™¨å°±ä¼šé©¬ä¸Šå°è¯•åˆ›å»ºè¿æ¥ã€‚ä¸XHRç±»ä¼¼ï¼ŒWebSocketä¹Ÿæœ‰ä¸€ä¸ªè¡¨ç¤ºå½“å‰çŠ¶æ€çš„readyStateå±æ€§ï¼Œå–å€¼å¦‚ä¸‹ï¼š<br>WebSocket.OPENING(0):æ­£åœ¨å»ºç«‹è¿æ¥<br>WebSocket.OPEN(1)ï¼šå·²ç»å»ºç«‹è¿æ¥<br>WebSocket.CLOSING(2)ï¼šæ­£åœ¨å…³é—­è¿æ¥<br>WebSocket.CLOSE(3)ï¼šå·²ç»å…³é—­è¿æ¥</p>
<p>WebSocketæ²¡æœ‰readystatechangeäº‹ä»¶ï¼Œæ­¥æ­¥å“¦æœ‰å…¶ä»–äº‹ä»¶ï¼Œå¯¹åº”ç€ä¸åŒçš„çŠ¶æ€ã€‚readyStateçš„å€¼æ°¸è¿œä»0å¼€å§‹ã€‚<br>è¦å…³é—­Web Socketè¿æ¥ï¼Œå¯ä»¥ä»»ä½•æ—¶å€™è°ƒç”¨close()æ–¹æ³•ã€‚<br>socket.close()<br>è°ƒç”¨äº†close()ä¹‹åï¼ŒreadyStateçš„å€¼ç«‹å³å˜ä¸º2ï¼ˆæ­£åœ¨å…³é—­ï¼‰ï¼Œè€Œåœ¨å…³é—­è¿æ¥åå°±ä¼šå˜ä¸º3.</p>
<p>2.å‘é€å’Œæ¥æ”¶æ•°æ®<br>Web Socketæ‰“å¼€ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡é“¾æ¥å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚è¦å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œä½¿ç”¨send()æ–¹æ³•å¹¶ä¼ å…¥ä»»æ„å­—ç¬¦ä¸²</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">'ws://www.example.com/server.php'</span>)</span><br><span class="line">socket.send(<span class="string">'hello world'</span>)</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºWeb Socketåªèƒ½é€šè¿‡è¿æ¥å‘é€çº¯æ–‡æœ¬æ•°æ®ï¼Œæ‰€ä»¥å¯¹äºå¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨é€šè¿‡è¿æ¥å‘é€ä¹‹å‰ï¼Œå¿…é¡»è¿›è¡Œåºåˆ—åŒ–ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> message = &#123;</span><br><span class="line">    time: <span class="keyword">new</span> Data(),</span><br><span class="line">    text: <span class="string">'hello world'</span>,</span><br><span class="line">    clientId: <span class="string">'asdfp'</span></span><br><span class="line">&#125;</span><br><span class="line">socket.send(<span class="built_in">JSON</span>.stringify(message))</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼ŒæœåŠ¡å™¨è¦è¯»å–å…¶ä¸­çš„æ•°æ®ï¼Œå°±è¦è§£ææ¥æ”¶åˆ°çš„JSONå­—ç¬¦ä¸²ã€‚<br>å½“æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘æ¥æ¶ˆæ¯æ—¶ï¼ŒWebSocketå¯¹è±¡å°±ä¼šè§¦å‘messageäº‹ä»¶ã€‚è¿™ä¸ªmessageäº‹ä»¶ä¸æä»–äº§åœ°æ¶ˆæ¯çš„åè®®ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å§è¿”å›çš„æ•°æ®ä¿å­˜åœ¨event.dataå±æ€§ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">socket.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> data = event.data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸é€šè¿‡send()å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ä¸€æ ·ï¼Œevent.dataä¸­è¿”å›çš„æ•°æ®ä¹Ÿæ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦æ‰‹å·¥è§£æã€‚</p>
<p>3.å…¶ä»–äº‹ä»¶<br>WebSocketå¯¹è±¡è¿˜æœ‰å…¶ä»–ä¸‰ä¸ªäº‹ä»¶ï¼Œåœ¨è¿æ¥å£°æ˜è¿½çš„ä¸åŒé˜¶æ®µè§¦å‘<br>openï¼šåœ¨æˆåŠŸå»ºç«‹è¿æ¥æ—¶è§¦å‘<br>errorï¼šåœ¨å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ï¼Œè¿æ¥ä¸èƒ½æŒç»­<br>closeï¼šåœ¨è¿æ¥å…³é—­æ—¶è§¦å‘ã€‚<br>WevScketå¯¹è±¡ä¸æ”¯æŒDOM2çº§äº‹ä»¶ä¾¦å¬å™¨ï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨DOM0çº§è¯­æ³•åˆ†åˆ«å®šä¹‰æ¯ä¸ªäº‹ä»¶å¤„ç†ç¨‹åº</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">'wsurl'</span>)</span><br><span class="line">socket.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'connect on'</span>)</span><br><span class="line">&#125;</span><br><span class="line">socket.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'error'</span>)</span><br><span class="line">&#125;</span><br><span class="line">socket.onclose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'close'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="vueå¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼ä¸‹è·¨åŸŸ"><a href="#vueå¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼ä¸‹è·¨åŸŸ" class="headerlink" title="vueå¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼ä¸‹è·¨åŸŸ"></a>vueå¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼ä¸‹è·¨åŸŸ</h3><p>å¼€å‘æ¨¡å¼<br>æ‰¾åˆ°å¹¶æ‰“å¼€configæ–‡ä»¶å¤¹ä¸‹çš„index.js,åšå¦‚ä¸‹é…ç½®proxyTableï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">proxyTable: &#123;</span><br><span class="line">  <span class="string">'/api'</span>: &#123;</span><br><span class="line">    target: <span class="string">'http://xxxxxxxx.com/api'</span>,</span><br><span class="line">    changeOrigin: <span class="literal">true</span>,</span><br><span class="line">    pathRewrite: &#123;</span><br><span class="line">      <span class="string">'^/api'</span>: <span class="string">'/api'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¯´æ˜é…ç½®ä¸­çš„targetåé¢å†…å®¹ä¸ºåç«¯äººå‘˜æä¾›çš„æ•°æ®æ¥å£ã€‚</span></span><br><span class="line"><span class="comment">//åŸç†å°±æ˜¯ç±»ä¼¼vpnåšäº†ä¸€ä¸ªä¸­è½¬ï¼ŒNodeæ›¿ä½ å»æ¥å£è¯·æ±‚æ•°æ®è€Œå·²</span></span><br><span class="line"><span class="comment">//è°ƒç”¨</span></span><br><span class="line"><span class="keyword">this</span>.$http.get(<span class="string">'/api/login'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç”Ÿäº§æ¨¡å¼<br>å°†é¡¹ç›®éƒ¨ç½²åˆ°nginxæœåŠ¡å™¨ï¼Œåˆ©ç”¨nginxåšåå‘ä»£ç†è¿›è¡Œè·¨åŸŸï¼Œåªéœ€é…ç½®nginxæ–‡ä»¶<br>å‚è€ƒé“¾æ¥ <a href="https://www.cnblogs.com/web-record/p/9467258.html" target="_blank" rel="noopener">https://www.cnblogs.com/web-record/p/9467258.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/" class="post-title-link" itemprop="url">é˜²æŠ–ä¸èŠ‚æµ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 10:04:36 / Modified: 15:57:58" itemprop="dateCreated datePublished" datetime="2020-04-26T10:04:36+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ‰äº›æƒ…å†µä¸‹å‰ç«¯äº‹ä»¶è§¦å‘çš„å‡½æ•°æ‰§è¡Œè¿‡äºé¢‘ç¹ï¼Œå°†æµªè´¹æµè§ˆå™¨æ€§èƒ½ç”±æ­¤å¼•å‡ºé˜²æŠ–ã€‚<br><strong>é˜²æŠ–</strong><br>å®šä¹‰ï¼š<br>å¯¹äºçŸ­æ—¶é—´å†…è¿ç»­è§¦å‘çš„äº‹ä»¶ï¼Œé˜²æŠ–çš„å«ä¹‰æ˜¯è®©æŸä¸ªæ—¶é—´æœŸé™å†…ï¼Œæ—¶é—´å¤„ç†å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡ã€‚</p>
<p>æ€è·¯1ï¼š<br>åœ¨ç¬¬ä¸€æ¬¡è§¦å‘äº‹ä»¶æ—¶ï¼Œä¸åˆ©å·±æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯ç»™å‡ºä¸€ä¸ªæœŸé™ä¾‹å¦‚200msï¼Œ<br>å½“200mså†…æ²¡æœ‰åœ¨æ­¤è§¦å‘è¯¥äº‹ä»¶ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œå‡½æ•°<br>å½“200mså†…å†æ¬¡è§¦å‘è¯¥äº‹ä»¶ï¼Œå½“å‰è®¡æ—¶å–æ¶ˆï¼Œé‡æ–°å¼€å§‹è®¡æ—¶</p>
<p><strong>æ•ˆæœ</strong> çŸ­æ—¶é—´å¤§é‡è§¦å‘åŒä¸€äº‹ä»¶åªä¼šæ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚</p>
<p><strong>å®ç°</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éç«‹å³å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (timeout) clearTimeout(timeout);</span><br><span class="line">        </span><br><span class="line">        timeout = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            func.apply(context, args)</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç«‹å³å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func,wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (timeout) clearTimeout(timeout);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> callNow = !timeout;</span><br><span class="line">        timeout = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            timeout = <span class="literal">null</span>;</span><br><span class="line">        &#125;, wait)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (callNow) func.apply(context, args)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func,wait,immediate</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (timeout) clearTimeout(timeout);</span><br><span class="line">        <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">            <span class="keyword">var</span> callNow = !timeout;</span><br><span class="line">            timeout = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">            &#125;, wait)</span><br><span class="line">            <span class="keyword">if</span> (callNow) func.apply(context, args)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            timeout = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                func.apply(context, args)</span><br><span class="line">            &#125;, wait);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showTop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> scrollTop = <span class="built_in">document</span>.body.scrollTop || <span class="built_in">document</span>.documentElement.scrollTop</span><br><span class="line">    <span class="built_in">console</span>.log(scrollTop)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onscroll = debounce(showTop, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>æ­¤ä»£ç å®ç°åœæ­¢æ»šåŠ¨1ç§’åï¼Œæ‰ä¼šæ‰“å°æ»šåŠ¨æ¡ä½ç½®ã€‚<br><strong>é˜²æŠ–å‡½æ•°çš„ä»£ç ä½¿ç”¨è¿™ä¸¤è¡Œä»£ç æ¥è·å– this å’Œ å‚æ•°ï¼Œæ˜¯ä¸ºäº†è®© debounce å‡½æ•°æœ€ç»ˆè¿”å›çš„å‡½æ•° this æŒ‡å‘ä¸å˜ä»¥åŠä¾æ—§èƒ½æ¥å—åˆ° e å‚æ•°ã€‚</strong></p>
<p><strong>èŠ‚æµ</strong><br>é˜²æŠ–å­˜åœ¨çš„é—®é¢˜åœ¨äºï¼Œå½“åœ¨è§„å®šæ—¶é—´é—´éš”å†…ï¼ŒæŸäº‹ä»¶ä¸€ç›´è¢«è§¦å‘ï¼Œåˆ™å…¶ç»‘å®šçš„å‡½æ•°å°†æ— æ³•æ‰§è¡Œã€‚</p>
<p>æ•ˆæœï¼š å¦‚æœçŸ­æ—¶é—´å†…å¤§é‡è§¦å‘åŒä¸€äº‹ä»¶ï¼Œåœ¨å‡½æ•°æ‰§è¡Œä¸€æ¬¡åï¼Œè¯¥å‡½æ•°åœ¨æŒ‡å®šçš„äº‹ä»¶æœŸé™å†…ä¸å†å·¥ä½œï¼Œç›´è‡³è¿‡äº†è¿™æ®µæ—¶é—´æ‰é‡æ–°ç”Ÿæ•ˆã€‚</p>
<p>å®ç°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ—¶é—´æˆ³ç‰ˆæœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> previous = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">        <span class="keyword">if</span> (now - previous &gt; wait) &#123;</span><br><span class="line">            func.apply(context, args);</span><br><span class="line">            previous = now;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šæ—¶å™¨ç‰ˆæœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">        <span class="keyword">if</span> (!timeout) &#123;</span><br><span class="line">            timeout = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">                func.apply(context, args)</span><br><span class="line">            &#125;, wait)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showTop</span>  (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> scrollTop = <span class="built_in">document</span>.body.scrollTop || <span class="built_in">document</span>.documentElement.scrollTop;</span><br><span class="line">ã€€ã€€<span class="built_in">console</span>.log(scrollTop);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onscroll = throttle(showTop,<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>


<p><strong>æ—¶é—´æˆ³ç‰ˆå’Œå®šæ—¶å™¨ç‰ˆçš„èŠ‚æµå‡½æ•°çš„åŒºåˆ«å°±æ˜¯ï¼Œæ—¶é—´æˆ³ç‰ˆçš„å‡½æ•°è§¦å‘æ˜¯åœ¨æ—¶é—´æ®µå†…å¼€å§‹çš„æ—¶å€™ï¼Œè€Œå®šæ—¶å™¨ç‰ˆçš„å‡½æ•°è§¦å‘æ˜¯åœ¨æ—¶é—´æ®µå†…ç»“æŸçš„æ—¶å€™ã€‚</strong><br>ä»¥ä¸Šä»£ç ç»“æœï¼Œä¸€ç›´æ‹–åŠ¨æ»šåŠ¨æ¡è¿›è¡Œæ»šåŠ¨ï¼Œå°±ä¼šä»¥1ç§’çš„æ—¶é—´é—´éš”ï¼ŒæŒç»­è¾“å‡ºå½“å‰ä½ç½®å’Œé¡¶éƒ¨çš„è·ç¦»ã€‚</p>
<p><strong>å…¶ä»–åº”ç”¨åœºæ™¯</strong><br>1.æœç´¢æ¡†inputäº‹ä»¶ï¼Œä¾‹å¦‚è¦æ”¯æŒè¾“å…¥è¯•è¯•æœç´¢å¯ä»¥ä½¿ç”¨èŠ‚æµæ–¹æ¡ˆï¼ˆé—´éš”ä¸€æ®µæ—¶é—´å°±å¿…é¡»æŸ¥è¯¢ç›¸å…³å†…å®¹ï¼‰ï¼Œæˆ–å®ç°è¾“å…¥é—´éš”å¤§äºæŸä¸ªå€¼ï¼Œå°±å½“åšç”¨æˆ·è¾“å…¥å®Œæˆã€‚<br>2.é¡µé¢resizeäº‹ä»¶ï¼Œå¸¸è§äºè¦åšé¡µé¢é€‚é…çš„æ—¶å€™ï¼Œéœ€è¦æ ¹æ®æœ€ç»ˆå‘ˆç°çš„é¡µé¢è¿›è¡Œdomæ¸²æŸ“ï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯ä½¿ç”¨é˜²æŠ–ï¼Œå› ä¸ºåªéœ€è¦åˆ¤æ–­æœ€åä¸€æ¬¡å˜åŒ–æƒ…å†µï¼‰</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0/" class="post-title-link" itemprop="url">å®šä½å…ƒç´ </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 10:04:36 / Modified: 11:14:43" itemprop="dateCreated datePublished" datetime="2020-04-26T10:04:36+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>è¿™éƒ¨åˆ†ä»‹ç»ç›’æ¨¡å‹ï¼Œpositionå’Œdisplayå±æ€§ä»¥åŠå¦‚ä½•æµ®åŠ¨ï¼ˆfloatï¼‰å’Œæ¸…é™¤ï¼ˆclearï¼‰å…ƒç´ ã€‚ä»¥åŠflexå±æ€§ã€‚<br>æ‰€è°“ç›’æ¨¡å‹ï¼Œå°±æ˜¯æµè§ˆå™¨ä¸ºé¡µé¢ä¸­çš„æ¯ä¸ªHTMLå…ƒç´ ç”Ÿæˆçš„çŸ©å½¢ç›’å­ã€‚è¿™äº›ç›’å­éƒ½è¦æŒ‰ç…§è¯¾ä»¶ç‰ˆå¼æ¨¡å‹ï¼ˆvisual formatting modelï¼‰åœ¨é¡µé¢ä¸Šæ’å¸ƒã€‚å¯è§çš„é¡µé¢ç‰ˆå¼ä¸»è¦ç”±ä¸‰ä¸ªå±æ€§æ§åˆ¶ï¼špositionå±æ€§ã€displayå±æ€§å’Œfloatå±æ€§ã€‚å…¶ä¸­positionå±æ€§æ§åˆ¶é¡µé¢ä¸Šå…ƒç´ é—´çš„ä½ç½®å…³ç³»ï¼Œdisplayå±æ€§æ§åˆ¶å…ƒç´ æ˜¯å †å å¹¶æ’è¿˜æ˜¯æ ¹æœ¬ä¸åœ¨é¡µé¢ä¸Šå‡ºç°ï¼Œfloatå±æ€§æä¾›æ§åˆ¶çš„æ–¹å¼ï¼Œä»¥ä¾¿æŠŠå…ƒç´ ç»„æˆæˆå¤šæ å¸ƒå±€ã€‚</p>
<h2 id="ç†è§£ç›’æ¨¡å‹"><a href="#ç†è§£ç›’æ¨¡å‹" class="headerlink" title="ç†è§£ç›’æ¨¡å‹"></a>ç†è§£ç›’æ¨¡å‹</h2><p>æ¯ä¸ªå…ƒç´ éƒ½ä¼šåœ¨é¡µé¢ä¸Šç”Ÿæˆä¸€ä¸ªç›’å­ã€‚å› æ­¤HTMLé¡µé¢å®é™…ä¸Šå°±æ˜¯ç”±ä¸€å †ç›’å­ç»„æˆçš„ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªç›’å­çš„è¾¹æ¡†ä¸å¯è§ï¼ŒèƒŒæ™¯ä¹Ÿæ˜¯é€æ˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥çœ‹åˆ°é¡µé¢ä¸­ç›’å­çš„ç»“æ„ã€‚<br>æ¯ä¸ªå…ƒç´ ç›’å­çš„å±æ€§å¯ä»¥åˆ†æˆä¸‰ç»„ï¼š<br>1.è¾¹æ¡†ï¼ˆborderï¼‰ï¼šå¯ä»¥è®¾ç½®è¾¹æ¡†çš„å®½çª„ï¼Œæ ·å¼å’Œé¢œè‰²ã€‚<br>2.å†…è¾¹æ¡†ï¼ˆpaddingï¼‰ï¼šå¯ä»¥è®¾ç½®ç›’å­å†…å®¹åŒºä¸è¾¹æ¡†çš„é—´è·ã€‚<br>3.å¤–è¾¹è·ï¼ˆmarginï¼‰ï¼šå¯ä»¥è®¾ç½®ç›’å­ä¸ç›¸é‚»å…ƒç´ çš„é—´è·ã€‚<br>ç›’å­çš„è¾¹æ¡†å†…è¾¹è·å’Œå¤–è¾¹è·ç›¸å…³çš„å±æ€§æœ‰4ä¸ªï¼Œåˆ†åˆ«æ˜¯ä¸Šï¼ˆtopï¼‰ï¼Œå³ï¼ˆrightï¼‰ï¼Œä¸‹ï¼ˆbottomï¼‰ï¼Œå·¦ï¼ˆleftï¼‰ã€‚</p>
<h3 id="ç›’å­è¾¹æ¡†"><a href="#ç›’å­è¾¹æ¡†" class="headerlink" title="ç›’å­è¾¹æ¡†"></a>ç›’å­è¾¹æ¡†</h3><p>è¾¹æ¡†ï¼ˆborderï¼‰æœ‰ä¸‰ä¸ªç›¸å…³å±æ€§<br>1.å®½åº¦ï¼ˆborder-widthï¼‰ï¼šå¯ä»¥ä½¿ç”¨thinã€mediumã€å’Œthickç­‰æ–‡æœ¬å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é™¤ç™¾åˆ†æ¯”å’Œè´Ÿå€¼ä¹‹å¤–çš„ä»»ä½•ç»å¯¹å€¼ã€‚<br>2.æ ·å¼ï¼ˆborder-styleï¼‰ï¼šæœ‰noneã€hidderã€dashedã€solidã€doubleã€grooveã€ridgeã€insetå’Œoutsetç­‰æ–‡æœ¬å€¼ã€‚<br>3.é¢œè‰²ï¼ˆborder-colorï¼‰ï¼šå¯ä»¥ä½¿ç”¨ä»»æ„é¢œè‰²å€¼ï¼ŒåŒ…æ‹¬RGBã€HSLã€åå…­è¿›åˆ¶é¢œè‰²å€¼å’Œé¢œè‰²å…³é”®å­—ã€‚</p>
<h3 id="ç›’å­å†…è¾¹è·"><a href="#ç›’å­å†…è¾¹è·" class="headerlink" title="ç›’å­å†…è¾¹è·"></a>ç›’å­å†…è¾¹è·</h3><p>å†…è¾¹è·ï¼ˆpaddingï¼‰æ˜¯ç›’å­å†…å®¹åŒºå’Œç›’å­è¾¹æ¡†ä¹‹é—´çš„è·ç¦»ã€‚</p>
<h3 id="ç›’å­å¤–è¾¹è·"><a href="#ç›’å­å¤–è¾¹è·" class="headerlink" title="ç›’å­å¤–è¾¹è·"></a>ç›’å­å¤–è¾¹è·</h3><p>å¤–è¾¹è·ï¼ˆmarginï¼‰æ˜¯ç›’å­ä¹‹é—´çš„è·ç¦»ã€‚</p>
<h3 id="å åŠ å¤–è¾¹è·"><a href="#å åŠ å¤–è¾¹è·" class="headerlink" title="å åŠ å¤–è¾¹è·"></a>å åŠ å¤–è¾¹è·</h3><p><strong>å‚ç›´æ–¹å‘ä¸Šçš„å¤–è¾¹è·ä¼šå åŠ </strong>ï¼Œå‡è®¾æœ‰ä¸‰ä¸ªæ®µè½ï¼Œå‰åç›¸æ¥ï¼Œè€Œä¸”éƒ½åº”ç”¨ä»¥ä¸‹è§„åˆ™ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">height</span>:<span class="number">50px</span>; <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#000</span>; <span class="attribute">backgroundcolor</span>:<span class="number">#fff</span>; <span class="attribute">margin-top</span>:<span class="number">50px</span>; <span class="attribute">margin-bottom</span>:<span class="number">30px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€æ®µå’Œç¬¬äºŒæ®µä¹‹é—´çš„å®é™…é—´è·æ˜¯50pxã€‚åƒè¿™æ ·ä¸Šä¸‹å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå°±ä¼šç›¸äº’é‡å ï¼Œç›´è‡³ä¸€ä¸ªå¤–è¾¹è·ç¢°åˆ°å¦ä¸€ä¸ªå…ƒç´ çš„è¾¹æ¡†ã€‚<br><strong>æ³¨æ„ï¼Œå åŠ çš„åªæ˜¯å‚ç›´å¤–è¾¹è·ï¼Œæ°´å¹³å¤–è¾¹è·ä¸å åŠ ã€‚å¯¹äºæ°´å¹³ç›¸é‚»çš„å…ƒç´ ï¼Œå®ƒä»¬çš„æ°´å¹³é—´è·æ˜¯ç›¸é‚»å¤–è¾¹è·ä¹‹å’Œã€‚</strong></p>
<h2 id="ç›’å­æœ‰å¤šå¤§"><a href="#ç›’å­æœ‰å¤šå¤§" class="headerlink" title="ç›’å­æœ‰å¤šå¤§"></a>ç›’å­æœ‰å¤šå¤§</h2><p>1.æ²¡æœ‰å®½åº¦çš„ç›’å­<br>æ‰€è°“æ²¡æœ‰å®½åº¦çš„ç›’å­å°±æ˜¯æŒ‡æ²¡æœ‰æ˜¾ç¤ºåœ°è®¾ç½®å…ƒç´ çš„widthå±æ€§ã€‚å¦‚æœä¸è®¾ç½®å—çº§å…ƒç´ çš„widthå±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§çš„é»˜è®¤å€¼æ˜¯autoï¼Œç»“æœä¼šè®©å…ƒç´ çš„å®½åº¦æ‰©å±•åˆ°ä¸çˆ¶å…ƒç´ åŒå®½ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>This element's width property is not setâ€¦<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">font-family</span>:helvetica, arial, sans-serif; <span class="attribute">font-size</span>:<span class="number">1em</span>; <span class="attribute">margin</span>:<span class="number">0px</span>; </span><br><span class="line"><span class="attribute">background-color</span>:<span class="number">#caebff</span>;&#125; </span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">margin</span>:<span class="number">0</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>bodyå…ƒç´ ä¼šå¡«æ»¡æµè§ˆå™¨çª—å£ï¼Œè€Œæ®µè½ä¼šå¡«æ»¡bodyå…ƒç´ ã€‚<br>æ¥ä¸‹æ¥ç”¨å†…è¾¹è·ç»™æ–‡æœ¬ä¸¤ä¾§æ·»åŠ ä¸€äº›ç©ºç™½ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">margin</span>:<span class="number">0</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">padding</span>:<span class="number">0</span> <span class="number">20px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ äº†å†…è¾¹è·åï¼Œæ–‡æœ¬å—çš„å®½åº¦å˜æˆäº† 360 åƒç´ ï¼ˆä¸¤è¾¹å„åŠ äº† 20 åƒç´ å†…è¾¹è·ï¼‰ã€‚<br>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ç»™æ®µè½å·¦å³ä¸¤è¾¹å„æ·»åŠ  6 åƒç´ å®½çš„è¾¹æ¡†</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">margin</span>:<span class="number">0</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">padding</span>:<span class="number">0</span> <span class="number">20px</span>; </span><br><span class="line"><span class="attribute">border</span>:solid red; <span class="attribute">border-width</span>:<span class="number">0</span> <span class="number">6px</span> <span class="number">0</span> <span class="number">6px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºä¸¤è¾¹å„æ·»åŠ  6 åƒç´ çš„è¾¹æ¡†å’Œ 20 åƒç´ çš„å†…è¾¹è·åï¼Œå†…å®¹åŒºå˜æˆäº† 348 åƒç´ <br>æœ€åï¼Œå†ç»™å·¦å³ä¸¤è¾¹å„åŠ ä¸€äº›å¤–è¾¹è·</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">margin</span>:<span class="number">0</span> <span class="number">30px</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">padding</span>:<span class="number">0</span> <span class="number">20px</span>; <span class="attribute">border</span>:solid red; <span class="attribute">border-width</span>:<span class="number">0</span> <span class="number">6px</span> <span class="number">0</span> <span class="number">6px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>å¤–è¾¹è·åœ¨å…ƒç´ ç›’å­ä¸çª—å£ä¹‹é—´åˆ›é€ äº†ç©ºç™½ï¼Œæ­¤æ—¶å†…å®¹å®½åº¦å˜æˆäº† 288åƒç´ ï¼ˆ400 â€“ ( (20 + 6 + 30)Ã— 2)ï¼‰ã€‚è€Œå…ƒç´ å£°æ˜çš„æ€»å®½åº¦å¹¶æ²¡æœ‰å˜ï¼Œä»ç„¶æ˜¯400åƒç´ ã€‚<br><strong>ç›’æ¨¡å‹ç»“è®ºä¸€ï¼šæ²¡æœ‰ï¼ˆå°±æ˜¯æ²¡æœ‰è®¾ç½® width çš„ï¼‰å®½åº¦çš„å…ƒç´ å§‹ç»ˆä¼šæ‰©å±•åˆ°å¡«æ»¡å…¶çˆ¶å…ƒç´ çš„å®½åº¦ä¸ºæ­¢ã€‚æ·»åŠ æ°´å¹³è¾¹æ¡†ã€å†…è¾¹è·å’Œå¤–è¾¹è·ï¼Œä¼šå¯¼è‡´å†…å®¹å®½åº¦å‡å°‘ï¼Œå‡å°‘é‡ç­‰äºæ°´å¹³è¾¹æ¡†ã€å†…è¾¹è·å’Œå¤–è¾¹è·çš„å’Œã€‚</strong><br>2.æœ‰å®½åº¦çš„ç›’å­</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">width</span>:<span class="number">400px</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">margin</span>:<span class="number">0</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>æ®µè½æœ‰äº†å›ºå®šçš„å®½åº¦400åƒç´ ã€‚åœ¨æ²¡æœ‰å†…è¾¹è·çš„æƒ…å†µä¸‹ï¼Œå†…å®¹åŒºä¹Ÿæ˜¯ç”Ÿå‘½çš„å®½åº¦ï¼Œå› æ­¤æ–‡æœ¬ä¸ç›’å­æ¥è§¦ã€‚ä¸‹é¢ç»™è¿™ä¸ªå…ƒç´ æ·»åŠ 20åƒç´ çš„å†…è¾¹è·ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">width</span>:<span class="number">400px</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">margin</span>:<span class="number">0</span>; <span class="attribute">padding</span>:<span class="number">0</span> <span class="number">20px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ç»™ç›’å­è®¾å®šå®½åº¦åï¼Œæ·»åŠ å†…è¾¹è·ä¼šå¯¼è‡´å…ƒç´ æ¯”åŸæ¥å®½äº† 40 åƒç´ <br>å†ç»™ç›’å­ä¸¤è¾¹å„æ·»åŠ  6 åƒç´ çš„è¾¹æ¡†</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">width</span>:<span class="number">400px</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">margin</span>:<span class="number">0</span>;<span class="attribute">padding</span>:<span class="number">0</span> <span class="number">20px</span>; <span class="attribute">border</span>:solid red; <span class="attribute">border-width</span>:<span class="number">0</span> <span class="number">6px</span> <span class="number">0</span> <span class="number">6px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>ç›’å­æ¯”åˆšæ‰åˆå®½äº† 12 åƒç´ <br>æœ€åï¼Œå†ç»™å…ƒç´ å·¦ã€å³ä¸¤è¾¹æ·»åŠ ä¸€äº›å¤–è¾¹è·</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">width</span>:<span class="number">400px</span>; <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">30px</span>; <span class="attribute">padding</span>:<span class="number">0</span> <span class="number">20px</span>; <span class="attribute">border</span>:solid red; <span class="attribute">border-width</span>:<span class="number">0</span> <span class="number">6px</span> <span class="number">0</span> <span class="number">6px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ çš„è¿™ 30 åƒç´ å¤–è¾¹è·ï¼Œè¿›ä¸€æ­¥å¢å¤§äº†å…ƒç´ å æ®çš„ç©ºé—´ï¼Œç›®å‰æ€»å®½åº¦å·²è¾¾åˆ° 512 åƒç´ ï¼ˆ30 + 6 + 20 + 400 + 20 + 6 + 30 = 512ï¼‰ã€‚<br><strong>ç›’æ¨¡å‹ç»“è®ºäºŒï¼šä¸ºè®¾å®šäº†å®½åº¦çš„ç›’å­æ·»åŠ è¾¹æ¡†ã€å†…è¾¹è·å’Œå¤–è¾¹è·ï¼Œä¼šå¯¼è‡´ç›’å­æ‰©å±•å¾—æ›´å®½ã€‚å®é™…ä¸Šï¼Œç›’å­çš„ width å±æ€§è®¾å®šçš„åªæ˜¯ç›’å­å†…å®¹åŒºçš„å®½åº¦ï¼Œè€Œéç›’å­è¦å æ®çš„æ°´å¹³å®½åº¦ã€‚</strong></p>
<h2 id="æµ®åŠ¨ä¸æ¸…é™¤"><a href="#æµ®åŠ¨ä¸æ¸…é™¤" class="headerlink" title="æµ®åŠ¨ä¸æ¸…é™¤"></a>æµ®åŠ¨ä¸æ¸…é™¤</h2><p>æµ®åŠ¨å°±æ˜¯æŠŠå…ƒç´ ä»å¸¸è§„æ–‡æ¡£æµä¸­æ‹¿å‡ºæ¥ã€‚æµ®åŠ¨å…ƒç´ è„±ç¦»äº†å¸¸è§„æ–‡æ¡£æµä¹‹åï¼ŒåŸæ¥ç´§è·Ÿå…¶åçš„å…ƒç´ å°±ä¼šåœ¨ç©ºé—´å…è®¸çš„æƒ…å†µä¸‹ï¼Œå‘ä¸Šæå‡åˆ°ä¸æµ®åŠ¨å…ƒç´ å¹³èµ·å¹³åã€‚<br>å¦‚æœæµ®åŠ¨å…ƒç´ åé¢æœ‰ä¸¤ä¸ªæ®µè½ï¼Œè€Œä¹‹ä¹¡è®©ç¬¬ä¸€æ®µä¸æµ®åŠ¨å…ƒç´ å¹¶åˆ—ã€‚è¿™æ—¶å€™ä½¿ç”¨clearå±æ€§æ¥â€œæ¸…é™¤â€ç¬¬äºŒæ®µï¼Œç„¶åé’™å…ƒç´ å°±åœ¨æµ®åŠ¨å…ƒç´ ä¸‹é¢ã€‚</p>
<h3 id="æµ®åŠ¨"><a href="#æµ®åŠ¨" class="headerlink" title="æµ®åŠ¨"></a>æµ®åŠ¨</h3><p>CSSè®¾è®¡floatå±æ€§çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯ä¸ºäº†å®ç°æ–‡æœ¬ç»•æ’å›¾ç‰‡çš„æ•ˆæœã€‚ç„¶è€Œï¼Œè¿™ä¸ªå±æ€§ä¹Ÿæˆäº†åˆ›å»ºå¤šå…°å¸ƒå±€æœ€ç®€å•çš„æ–¹å¼ã€‚<br>1.æ–‡æœ¬ç»•æ’å›¾ç‰‡<br>ä¸ºäº†å®ç°æ–‡æœ¬ç»•æ’å›¾ç‰‡çš„æµ®åŠ¨æ•ˆæœï¼Œå¿…é¡»åœ¨æ ‡è®°ä¸­å…ˆå†™å›¾ç‰‡ï¼Œç„¶ååœ¨å†™ç¯ç»•å®ƒçš„æ–‡æœ¬ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">...</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>the paragraph text ...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">margin</span>:<span class="number">0</span>; <span class="attribute">border</span>: <span class="number">1px</span> solid red;&#125;</span><br><span class="line"><span class="selector-tag">img</span>&#123;<span class="attribute">float</span>:left; <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">4px</span> <span class="number">4px</span> <span class="number">0</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šè§„åˆ™ä¼šè®©å›¾ç‰‡æµ®åŠ¨åˆ°å·¦ä¾§ï¼Œè€Œè®©æ–‡æœ¬ç»•æ’åˆ°å³ä¾§ã€‚<br>2.åˆ›å»ºåˆ†æ <br>åœ¨ä¸Šä¸€éƒ¨åˆ†çš„åŸºç¡€ä¸Šåˆ›å»ºå¤šæ ï¼Œåªè¦å†ç”¨ä¸€æ¬¡floatå±æ€§ï¼Œåªè¦ç»™æ®µè½è®¾å®šå®½åº¦ç„¶åä¹Ÿæµ®åŠ¨å®ƒå³å¯ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left; <span class="attribute">margin</span>: <span class="number">0</span>; <span class="attribute">weidth</span>: <span class="number">200px</span>; <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;<span class="attribute">margin</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">4px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>è¿™æ ·åŒæ—¶æµ®åŠ¨å›¾ç‰‡å’Œâ€œæœ‰å®½åº¦çš„â€æ®µè½ï¼Œä¼šå¯¼è‡´æ®µè½çš„æ–‡æœ¬ç»•æ’æ•ˆæœæ¶ˆå¤±ï¼Œè€Œæµ®åŠ¨çš„æ®µè½ä¹Ÿä¼šå°½å¯èƒ½å‘å·¦å‘ä¸Šç§»åŠ¨ã€‚å°±è¿™æ ·ï¼Œè¿™ä¸ªæ®µè½å°±æ„æˆäº†ç´§æŒ¨ç€å›¾ç‰‡çš„ä¸€æ ã€‚è¿™å°±æ˜¯ä½¿ç”¨ float å±æ€§åˆ›å»ºå¤šæ å¸ƒå±€çš„åŸç†ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœå‡ ä¸ªç›¸é‚»çš„å…ƒç´ éƒ½å…·æœ‰è®¾å®šçš„å®½åº¦ï¼Œéƒ½æ˜¯æµ®åŠ¨çš„ï¼Œè€Œä¸”æ°´å¹³ç©ºé—´ä¹Ÿè¶³ä»¥å®¹çº³å®ƒä»¬ï¼Œå®ƒä»¬å°±ä¼šå¹¶åˆ—æ’åœ¨ä¸€è¡Œã€‚</em></p>
<h4 id="å›´ä½æµ®åŠ¨å…ƒç´ çš„ä¸‰ç§æ–¹æ³•"><a href="#å›´ä½æµ®åŠ¨å…ƒç´ çš„ä¸‰ç§æ–¹æ³•" class="headerlink" title="å›´ä½æµ®åŠ¨å…ƒç´ çš„ä¸‰ç§æ–¹æ³•"></a>å›´ä½æµ®åŠ¨å…ƒç´ çš„ä¸‰ç§æ–¹æ³•</h4><p>æµ®åŠ¨å…ƒç´ è„±ç¦»äº†æ–‡æ¡£æµï¼Œå…¶çˆ¶å…ƒç´ ä¹Ÿçœ‹ä¸åˆ°å®ƒï¼Œå› è€Œä¹Ÿä¸ä¼šåŒ…å›´å®ƒã€‚è¿™ç§æƒ…å†µæœ‰æ—¶å€™å¹¶éæˆ‘ä»¬æƒ³è¦çš„ã€‚<br>ä¸ºäº†æ¼”ç¤ºæµ®åŠ¨å…ƒç´ çš„è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºå¯¹å¸ƒå±€ä¼šäº§ç”Ÿä»€ä¹ˆå½±å“ï¼Œä»¥åŠè§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸‰ç§æ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ä»ä¸€å¼ å¸¦æ ‡é¢˜çš„å›¾ç‰‡å¼€å§‹ã€‚å›¾ç‰‡å’Œæ ‡ç­¾åŒ…å«åœ¨ä¸€ä¸ª sectionå…ƒç´ ä¸­ï¼Œè€Œ section å…ƒç´ åé¢è·Ÿç€ä¸€ä¸ª footer å…ƒç´ ã€‚å¯ä»¥æŠŠè¿™ä¸ª footer å…ƒç´ æƒ³è±¡æˆå¾ˆå¤šç½‘é¡µåº•éƒ¨éƒ½ä¼šæœ‰çš„ä¸é¡µé¢åŒå®½çš„é¡µè„šã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/rubber_duck2.jpg"</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>It's fun to float.<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span> Here is the footer element that runs across the bottom of the </span><br><span class="line">page.<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid blue; <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span>;&#125;</span><br><span class="line">p &#123;margin 0;&#125;</span><br><span class="line"><span class="selector-tag">footer</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid red;&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬çœ‹åˆ°çš„æ˜¯å¸¸è§„æ–‡æ¡£æµï¼Œå³å—çº§å…ƒç´ åŒ…å›´ç€æ‰€æœ‰å­å…ƒç´ ï¼Œè€Œä¸”åœ¨é¡µé¢ä¸­è‡ªä¸Šè€Œä¸‹ç›¸äº’å †å åœ¨ä¸€èµ·ã€‚<br>ä½¿ç”¨æµ®åŠ¨å±æ€§åº”ç”¨äºå›¾ç‰‡</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid blue; <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span>;&#125; </span><br><span class="line"><span class="selector-tag">img</span> &#123;<span class="attribute">float</span>:left;&#125; </span><br><span class="line"><span class="selector-tag">footer</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid red;&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å°†ä¼šå¯¼è‡´å›¾ç‰‡è„±ç¦»sectionçš„åŒ…å›´ï¼Œçˆ¶å…ƒç´ sectionæ”¶ç¼©åˆ°åªåŒ…å«æ–‡æœ¬çš„é«˜åº¦ã€‚ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼š<br>æ–¹æ³•ä¸€ï¼šä¸ºçˆ¶å…ƒç´ æ·»åŠ overflowï¼šhidden<br>è¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œç¼ºç‚¹æ˜¯ä¸å¤ªç›´è§‚ï¼Œå³ä¸ºçˆ¶å…ƒç´ åº”ç”¨overflowï¼šhiddenï¼Œä»¥å¼ºåˆ¶å®ƒåŒ…å›´æµ®åŠ¨å…ƒç´ ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid blue; <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span>; <span class="attribute">overflow</span>:hidden;&#125; </span><br><span class="line"><span class="selector-tag">img</span> &#123;<span class="attribute">float</span>:left;&#125; </span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid red;&#125;</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šï¼Œoverflow:hidden å£°æ˜çš„çœŸæ­£ç”¨é€”æ˜¯é˜²æ­¢åŒ…å«å…ƒç´ è¢«è¶…å¤§å†…å®¹æ’‘å¤§ã€‚åº”ç”¨overflow:hidden ä¹‹åï¼ŒåŒ…å«å…ƒç´ ä¾ç„¶ä¿æŒå…¶è®¾å®šçš„å®½åº¦ï¼Œè€Œè¶…å¤§çš„å­å†…å®¹åˆ™ä¼šè¢«å®¹å™¨å‰ªåˆ‡æ‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œoverflow:hidden è¿˜æœ‰å¦ä¸€ä¸ªä½œç”¨ï¼Œå³å®ƒèƒ½å¯é åœ°è¿«ä½¿çˆ¶å…ƒç´ åŒ…å«å…¶æµ®åŠ¨çš„å­å…ƒç´ ã€‚<br>æ–¹æ³•äºŒï¼šåŒæ—¶æµ®åŠ¨çˆ¶å…ƒç´ <br>ç¬¬äºŒç§æ–¹æ³•ä¿ƒä½¿çˆ¶å…ƒç´ åŒ…å›´å…¶æµ®åŠ¨å…ƒç´ çš„æ–¹æ³•ï¼Œæ˜¯è®©çˆ¶å…ƒç´ ä¹Ÿæµ®åŠ¨èµ·æ¥ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid blue; <span class="attribute">float</span>:left; <span class="attribute">width</span>:<span class="number">100%</span>;&#125; </span><br><span class="line"><span class="selector-tag">img</span> &#123;<span class="attribute">float</span>:left;&#125; </span><br><span class="line"><span class="selector-tag">footer</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid red; <span class="attribute">clear</span>:left;&#125;</span><br></pre></td></tr></table></figure>
<p>æµ®åŠ¨sectionä»¥åï¼Œä¸ç®¡å…¶å­å…ƒç´ æ˜¯å¦æµ®åŠ¨ï¼Œä»–éƒ½ä¼šä»…ä»…åœ°åŒ…å›´ï¼ˆä¹Ÿç§°æ”¶ç¼©åŒ…è£¹ï¼‰ä½å®ƒçš„å­å…ƒç´ ã€‚å› æ­¤éœ€è¦ç”¨width:100%å†è®©sectionå’Œæµè§ˆå™¨å®¹å™¨åŒå®½ã€‚å¦å¤–ç”±äºsectionç°åœ¨ä¹Ÿæµ®åŠ¨äº†ã€‚æ‰€ä»¥footerä¼šåŠªåŠ›æŒ¤åˆ°å®ƒæ—è¾¹å»ã€‚ä¸ºäº†å¼ºåˆ¶footerä¾ç„¶å¾…åœ¨sectionä¸‹æ–¹ï¼Œè¦ç»™footeråº”ç”¨clear:leftã€‚è¢«æ¸…é™¤çš„å…ƒç´ ä¸ä¼šæå‡åˆ°æµ®åŠ¨å…ƒç´ çš„æ—è¾¹ã€‚<br>æ–¹æ³•ä¸‰ï¼šæ·»åŠ é£æµ®åŠ¨çš„æ¸…æ¥šå…ƒç´ <br>ç¬¬ä¸‰ç§å¼ºåˆ¶çˆ¶å…ƒç´ åŒ…å«å…¶æµ®åŠ¨å­å…ƒç´ çš„æ–¹æ³•å°±æ˜¯ç»™çˆ¶å…ƒç´ çš„æœ€åæ·»åŠ ä¸€ä¸ªéæµ®åŠ¨çš„å­å…ƒç´ ï¼Œç„¶åæ¸…é™¤è¯¥å­å…ƒç´ ã€‚ç”±äºåŒ…å«å…ƒç´ ä¸€å®šä¼šåŒ…å›´éæµ®åŠ¨çš„å­å…ƒç´ ï¼Œè€Œä¸”æ¸…é™¤ä¼šè®©è¿™ä¸ªå­å…ƒç´ ä½äºï¼ˆæ¸…é™¤ä¸€ä¾§ï¼‰é™„é€å…ƒç´ çš„ä¸‹æ–¹ï¼Œå› æ­¤åŒ…å«å…ƒç´ ä¸€å®šä¼šåŒ…å«è¿™ä¸ªå­å…ƒç´ -ä»¥åŠå‰æ°‘çš„æµ®åŠ¨å…ƒç´ ã€‚åŒ…å«å…ƒç´ æœ€åæ·»åŠ å­å…ƒç´ ä½œä¸ºæ¸…é™¤å…ƒç´ çš„æ–¹å¼æœ‰ä¸¤ç§ã€‚<br>ç¬¬ä¸€ç§æ–¹å¼:åœ¨ HTML æ ‡è®°ä¸­æ·»åŠ ä¸€ä¸ªå­å…ƒç´ ï¼Œå¹¶ç»™å®ƒåº”ç”¨<br>clear å±æ€§ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/rubber_duck.jpg"</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>It's fun to float.<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"clear_me"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span> Here is the footer elementâ€¦<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid blue;&#125; </span><br><span class="line"><span class="selector-tag">img</span> &#123;<span class="attribute">float</span>:left;&#125; </span><br><span class="line"><span class="selector-class">.clear_me</span> &#123;<span class="attribute">clear</span>:left;&#125; </span><br><span class="line"><span class="selector-tag">footer</span> &#123;<span class="attribute">border</span>:<span class="number">1px</span> solid red;&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ–¹å¼:ç”¨ CSS æ¥æ·»åŠ è¿™ä¸ªæ¸…é™¤å…ƒç´ çš„æ–¹æ³•,ä½¿ç”¨clearfix è§„åˆ™</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"clearfix"</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/rubber_duck.jpg"</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>It's fun to float.<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span> Here is the footer elementâ€¦<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123; </span><br><span class="line"> <span class="attribute">content</span>:<span class="string">"."</span>; </span><br><span class="line"> <span class="attribute">display</span>:block; </span><br><span class="line"> <span class="attribute">height</span>:<span class="number">0</span>; </span><br><span class="line"> <span class="attribute">visibility</span>:hidden; </span><br><span class="line"> <span class="attribute">clear</span>:both; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®šä½"><a href="#å®šä½" class="headerlink" title="å®šä½"></a>å®šä½</h2><p>CSSå¸ƒå±€çš„æ ¸å¿ƒæ˜¯positionå±æ€§ï¼Œå¯¹å…ƒç´ ç›’å­åº”ç”¨è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥ç›¸å¯¹äºå®ƒå¸¸è§„æ–‡æ¡£å…­ä¸­çš„ä½ç½®é‡æ–°å®šä½ã€‚positionå±æ€§æœ‰å››ä¸ªå€¼ï¼šstaticã€relativeã€absoluteã€fixedï¼Œé»˜è®¤å€¼ä¸ºstaticã€‚</p>
<h3 id="é™æ€å®šä½"><a href="#é™æ€å®šä½" class="headerlink" title="é™æ€å®šä½"></a>é™æ€å®šä½</h3><p>position:staticã€‚é™æ€å®šä½çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå…ƒç´ å¤„åœ¨å¸¸è§„æ–‡æ¡£æµä¸­ã€‚å®ƒä»¬éƒ½æ˜¯å—çº§å…ƒç´ ï¼Œæ‰€ä»¥é…’ä¼šåœ¨é¡µé¢ä¸­è‡ªä¸Šè€Œä¸‹åœ°å †å èµ·æ¥ã€‚</p>
<h3 id="ç›¸å¯¹å®šä½"><a href="#ç›¸å¯¹å®šä½" class="headerlink" title="ç›¸å¯¹å®šä½"></a>ç›¸å¯¹å®šä½</h3><p>position:relativeã€‚ç›¸å¯¹æ˜¯ç›¸å¯¹çš„å®ƒåŸæ¥åœ¨æ–‡æ¡£æµä¸­çš„ä½ç½®ï¼ˆæˆ–è€…é»˜è®¤ä½ç½®ï¼‰ã€‚é€šè¿‡è®¾ç½®topå’Œleftå°±å¯ä»¥å®ç°ä½ç½®çš„ç§»åŠ¨ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-id">#specialpara</span> &#123;<span class="attribute">position</span>:relative; <span class="attribute">top</span>:<span class="number">25px</span>; <span class="attribute">left</span>:<span class="number">30px</span>;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»å¯¹å®šä½"><a href="#ç»å¯¹å®šä½" class="headerlink" title="ç»å¯¹å®šä½"></a>ç»å¯¹å®šä½</h3><p>position: absoluteã€‚ç»å¯¹å®šä½è·Ÿé™æ€å®šä½å’Œç›¸å¯¹å®šä½æ¯”ï¼Œç»å¯¹ä¸ä¸€æ ·ã€‚å› ä¸ºç»å¯¹å®šä½ä¼šæŠŠå…ƒç´ å½»åº•ä»æ–‡æ¡£æµä¸­æ‹¿å‡ºæ¥ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-id">#specialpara</span> &#123;<span class="attribute">position</span>:absolute; <span class="attribute">top</span>:<span class="number">25px</span>; <span class="attribute">left</span>:<span class="number">30px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>å…³äºå®šä½ä¸Šä¸‹æ–‡ï¼Œé¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ç»å¯¹å®šä½å…ƒç´ é»˜è®¤çš„å®šä½ä¸Šä¸‹æ–‡æ˜¯ body å…ƒç´ ã€‚é€šè¿‡ top å’Œ left è®¾å®šçš„åç§»å€¼ï¼Œå†³å®šäº†å…ƒç´ ç›¸å¯¹äº body å…ƒç´ ï¼ˆæ ‡è®°å±‚æ¬¡ä¸­çš„ç¥–å…ˆå®¹å™¨ï¼‰ï¼Œè€Œä¸æ˜¯ç›¸å¯¹äºå®ƒåœ¨æ–‡æ¡£æµä¸­çš„ä½ç½®åç§»å¤šè¿œâ€”â€”è¿™ä¸€ç‚¹ä¸ç›¸å¯¹<br>å®šä½çš„å…ƒç´ ä¸åŒã€‚<br>ç”±äºç»å¯¹å®šä½å…ƒç´ çš„å®šä½ä¸Šä¸‹æ–‡æ˜¯ bodyï¼Œæ‰€ä»¥åœ¨é¡µé¢æ»šåŠ¨çš„æ—¶å€™ï¼Œä¸ºäº†ç»´æŠ¤ä¸ bodyå…ƒç´ çš„ç›¸å¯¹ä½ç½®å…³ç³»ï¼Œå®ƒä¹Ÿä¼šç›¸åº”åœ°ç§»åŠ¨ã€‚</p>
<h3 id="å›ºå®šå®šä½"><a href="#å›ºå®šå®šä½" class="headerlink" title="å›ºå®šå®šä½"></a>å›ºå®šå®šä½</h3><p>position: fixedã€‚ä»å®Œå…¨ç§»å‡ºæ–‡æ¡£æµçš„è§’åº¦è¯´ï¼Œå›ºå®šå®šä½ä¸ç»å¯¹å®šä½ç±»ä¼¼ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-id">#specialpara</span> &#123;<span class="attribute">position</span>:fixed; <span class="attribute">top</span>:<span class="number">30px</span>; <span class="attribute">left</span>:<span class="number">20px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†ä¸åŒä¹‹å¤„åœ¨äºï¼Œå›ºå®šå®šä½å…ƒç´ çš„å®šä½ä¸Šä¸‹æ–‡æ˜¯è§†å£ï¼ˆæµè§ˆå™¨çª—å£æˆ–æ‰‹æŒè®¾å¤‡çš„å±å¹•ï¼‰ï¼Œå› æ­¤å®ƒä¸ä¼šéšé¡µé¢æ»šåŠ¨è€Œç§»åŠ¨ã€‚</p>
<h3 id="å®šä½ä¸Šä¸‹æ–‡"><a href="#å®šä½ä¸Šä¸‹æ–‡" class="headerlink" title="å®šä½ä¸Šä¸‹æ–‡"></a>å®šä½ä¸Šä¸‹æ–‡</h3><p>æŠŠå…ƒç´ çš„ position å±æ€§è®¾å®šä¸º relativeã€absolute æˆ– fixed åï¼Œç»§è€Œå¯ä»¥ä½¿ç”¨ topã€rightã€bottom å’Œ left å±æ€§ï¼Œç›¸å¯¹äºå¦ä¸€ä¸ªå…ƒç´ ç§»åŠ¨è¯¥å…ƒç´ çš„ä½ç½®ã€‚è¿™é‡Œçš„â€œå¦ä¸€ä¸ªå…ƒç´ â€ï¼Œå°±æ˜¯è¯¥å…ƒç´ çš„å®šä½ä¸Šä¸‹æ–‡ã€‚<br>åœ¨è®²ç»å¯¹å®šä½çš„æ—¶å€™ï¼Œæˆ‘ä»¬çŸ¥é“ç»å¯¹å®šä½å…ƒç´ é»˜è®¤çš„å®šä½ä¸Šä¸‹æ–‡æ˜¯ bodyã€‚è¿™æ˜¯å› ä¸ºbody æ˜¯æ ‡è®°ä¸­æ‰€æœ‰å…ƒç´ å”¯ä¸€çš„ç¥–å…ˆå…ƒç´ ã€‚è€Œå®é™…ä¸Šï¼Œç»å¯¹å®šä½å…ƒç´ çš„ä»»ä½•ç¥–å…ˆå…ƒç´ éƒ½å¯ä»¥æˆä¸ºå®ƒçš„å®šä½ä¸Šä¸‹æ–‡ï¼Œåªè¦ä½ æŠŠç›¸åº”ç¥–å…ˆå…ƒç´ çš„ position è®¾å®šä¸º relative å³å¯ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"outer"</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"inner"</span>&gt;</span>This is textâ€¦<span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-id">#outer</span> &#123;<span class="attribute">position</span>:relative; <span class="attribute">width</span>:<span class="number">250px</span>; <span class="attribute">margin</span>:<span class="number">50px</span> <span class="number">40px</span>; <span class="attribute">border-top</span>:<span class="number">3px</span> solid red;&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#inner</span> &#123;<span class="attribute">top</span>:<span class="number">10px</span>; <span class="attribute">left</span>:<span class="number">20px</span>; <span class="attribute">background</span>:<span class="number">#ccc</span>;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ˜¾ç¤ºå±æ€§"><a href="#æ˜¾ç¤ºå±æ€§" class="headerlink" title="æ˜¾ç¤ºå±æ€§"></a>æ˜¾ç¤ºå±æ€§</h2><p>æ­£å¦‚æ‰€æœ‰å…ƒç´ éƒ½æœ‰positionå±æ€§ï¼Œæ‰€æœ‰å…ƒç´ ä¹Ÿéƒ½æœ‰displayå±æ€§ã€‚å°½ç®¡displayå±æ€§çš„å€¼æœ‰å¾ˆå¤šï¼Œä½†å¤§å¤šæ•°å…ƒç´ displayå±æ€§çš„é»˜è®¤å€¼ä¸æ˜¯blockï¼Œå°±æ˜¯inlineã€‚<br>å—çº§å…ƒç´ ï¼ˆblockï¼‰ï¼Œæ¯”å¦‚æ®µè½ï¼Œæ ‡é¢˜ï¼Œåˆ—è¡¨ç­‰åœ¨æµè§ˆå™¨ä¸­ä¸Šä¸‹å †å æ˜¾ç¤ºã€‚<br>è¡Œå†…å…ƒç´ ï¼ˆinlineï¼‰ï¼Œæ¯”å¦‚aã€spanå’Œimgï¼Œåœ¨æµè§ˆå™¨ä¸­åšé±¼å¹¶æ’æ˜¾ç¤ºï¼Œåªæœ‰å‰ä¸€è¡Œæ²¡æœ‰ç©ºé—´æ—¶æ‰ä¼šæ˜¾ç¤ºåˆ°ä¸‹ä¸€è¡Œã€‚<br>æŠŠå—çº§å…ƒç´ å˜æˆè¡Œå†…å…ƒç´ ï¼ˆæˆ–è€…ç›¸åï¼‰çš„æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*é»˜è®¤æ˜¯block  */</span></span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">display</span>: inline&#125;</span><br><span class="line"><span class="comment">/*é»˜è®¤æ˜¯inline  */</span></span><br><span class="line"><span class="selector-tag">a</span> &#123;<span class="attribute">display</span>: block&#125;</span><br></pre></td></tr></table></figure>
<p>display å±æ€§è¿˜æœ‰ä¸€ä¸ªå€¼æœ‰å¿…è¦æä¸€ä¸‹ï¼Œå°±æ˜¯ noneã€‚æŠŠå…ƒç´ çš„ display è®¾å®šä¸º noneï¼Œè¯¥å…ƒç´ åŠæ‰€æœ‰åŒ…å«åœ¨å…¶ä¸­çš„å…ƒç´ ï¼Œéƒ½ä¸ä¼šåœ¨é¡µé¢ä¸­æ˜¾ç¤ºã€‚å®ƒä»¬åŸå…ˆå æ®çš„æ‰€æœ‰ç©ºé—´ä¹Ÿéƒ½ä¼šè¢«â€œå›æ”¶â€ï¼Œå°±å¥½åƒç›¸å…³çš„æ ‡è®°æ ¹æœ¬ä¸å­˜åœ¨ä¸€æ ·ã€‚ä¸æ­¤ç›¸å¯¹çš„æ˜¯ visibilityå±æ€§ï¼Œè¿™ä¸ªå±æ€§æœ€å¸¸ç”¨çš„ä¸¤ä¸ªç›¸å¯¹çš„å€¼æ˜¯ visibleï¼ˆé»˜è®¤å€¼ï¼‰å’Œ hiddenã€‚æŠŠå…ƒç´ çš„visibility è®¾å®šä¸º hiddenï¼Œå…ƒç´ ä¼šéšè—ï¼Œä½†å®ƒå æ®çš„é¡µé¢ç©ºé—´ä»ç„¶â€œè™šä½ä»¥å¾…â€ã€‚</p>
<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>èƒŒæ™¯æ”¯æŒä¸ºå…ƒç´ æ·»åŠ èƒŒæ™¯é¢œè‰²å’ŒèƒŒæ™¯å›¾ç‰‡ã€‚CSSé‡Œæ¯ä¸ªå…ƒç´ ç›’å­éƒ½å¯ä»¥æƒ³è±¡æˆç”±ä¸¤ä¸ªå›¾å±‚ç»„æˆã€‚å…ƒç´ çš„å‰æ™¯å±‚åŒ…å«å†…å®¹ï¼ˆå¦‚æ–‡æœ¬æˆ–å›¾ç‰‡ï¼‰å’Œè¾¹æ¡†ï¼Œå…ƒç´ çš„èƒŒæ™¯å±‚å¯ä»¥ç”¨è¯•è‰²å¡«å……ï¼ˆä½¿ç”¨background-colorå±æ€§ï¼‰ï¼Œä¹Ÿå¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèƒŒæ™¯å›¾ç‰‡ï¼ˆä½¿ç”¨background-imageå±æ€§ï¼‰ï¼ŒèƒŒæ™¯å›¾ç‰‡å åŠ åœ¨èƒŒæ™¯é¢œè‰²ä¹‹ä¸Šã€‚<br>åœ¨CSS3è¢«æµè§ˆå™¨å®ç°ä¹‹å‰ï¼Œåªèƒ½åœ¨èƒŒæ™¯é¢œè‰²ä¸Šæ·»åŠ ä¸€å¼ èƒŒæ™¯å›¾ç‰‡ã€‚è€Œç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºèƒŒæ™¯å›¾å±‚æ·»åŠ å¤šå¼ å›¾ç‰‡ï¼ˆä»¥åŠCSS3æ¸å˜ï¼‰ã€‚</p>
<h3 id="CSSèƒŒæ™¯å±æ€§"><a href="#CSSèƒŒæ™¯å±æ€§" class="headerlink" title="CSSèƒŒæ™¯å±æ€§"></a>CSSèƒŒæ™¯å±æ€§</h3><p>cssè§„å®šä¸€ä¸‹ä¸èƒŒæ™¯ç›¸å…³å±æ€§ã€‚<br>background-colorã€background-imageã€background-repeatã€background-positionã€background-sizeã€background-attachmentã€backgroundï¼ˆç®€å†™å±æ€§ï¼‰ä»¥åŠæœªè¢«å¹¿æ³›æ”¯æŒçš„background-clipã€background-originã€background-breakã€‚</p>
<h3 id="èƒŒæ™¯é¢œè‰²"><a href="#èƒŒæ™¯é¢œè‰²" class="headerlink" title="èƒŒæ™¯é¢œè‰²"></a>èƒŒæ™¯é¢œè‰²</h3><p>background-coloræ˜¯åŒ—äº¬å±æ€§ä¸­æœ€ç®€å•çš„ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¾å®šå…ƒç´ çš„é¢œè‰²ã€‚ç„¶åå…ƒç´ å°±ä¼šä»¥è®¾å®šçš„é¢œè‰²å¡«å……èƒŒæ™¯å›¾å±‚ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">background-color</span>:<span class="number">#caebff</span>;&#125; </span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="comment">/*ç›’å­å¸ƒå±€æ ·å¼*/</span> </span><br><span class="line"> <span class="attribute">font-family</span>:helvetica, arial, sans-serif; <span class="attribute">font-size</span>:<span class="number">18px</span>; </span><br><span class="line"> <span class="attribute">width</span>:<span class="number">350px</span>; <span class="attribute">margin</span>:<span class="number">20px</span> auto; <span class="attribute">padding</span>:<span class="number">10px</span>; </span><br><span class="line"> <span class="comment">/*è¿™ä¸ªä¾‹å­ä¸­è®¨è®ºèƒŒæ™¯å’Œå‰æ™¯æ ·å¼*/</span> </span><br><span class="line"> <span class="attribute">background-color</span>:<span class="number">#fff</span>; <span class="attribute">color</span>:<span class="number">#666</span>; <span class="attribute">border</span>:<span class="number">4px</span> solid; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­é™¤äº†æ¼”ç¤ºæ€ä¹ˆç»™å…ƒç´ æ·»åŠ èƒŒæ™¯è‰²ï¼Œè¿˜æ¼”ç¤ºäº†å‰æ™¯è‰²çš„ä½œç”¨èŒƒå›´ï¼Œä¹Ÿå°±æ˜¯å‰æ™¯è‰²ä¼šå½±å“å…ƒç´ çš„å†…å®¹å’Œè¾¹æ¡†ã€‚å½“ç„¶ï¼Œæœ‰ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨ border è®¾å®šè¾¹æ¡†çš„æ ·å¼å’Œå®½åº¦ï¼Œè€Œæ²¡æœ‰è®¾å®šè¾¹æ¡†é¢œè‰²ï¼ˆæˆ–è€…æ²¡æœ‰ä½¿ç”¨ border-color å•ç‹¬è®¾å®šè¾¹æ¡†é¢œè‰²ï¼‰çš„æƒ…å†µä¸‹ï¼Œè¾¹æ¡†ä¼šä½¿ç”¨ color å±æ€§è®¾å®šçš„å­—ä½“é¢œè‰²ã€‚é»˜è®¤é¢œè‰²æ˜¯é»‘è‰²ã€‚å¦‚æœä½ æƒ³è®©è¾¹æ¡†çš„é¢œè‰²æœ‰åˆ«äºæ–‡æœ¬ï¼Œå°±éœ€è¦å•ç‹¬è®¾å®šã€‚</p>
<h3 id="èƒŒæ™¯å›¾ç‰‡"><a href="#èƒŒæ™¯å›¾ç‰‡" class="headerlink" title="èƒŒæ™¯å›¾ç‰‡"></a>èƒŒæ™¯å›¾ç‰‡</h3><p>é»˜è®¤æƒ…å†µä¸‹èƒŒæ™¯å›¾ç‰‡ä¼šä»¥å…ƒç´ å·¦ä¸Šè§’ä¸ºèµ·ç‚¹ï¼Œæ²¿æ°´å¹³å’Œå‚ç›´æ–¹å‘é‡å¤å‡ºç°ï¼Œæœ€ç»ˆå¡«æ»¡æ•´ä¸ªèƒŒæ™¯åŒºåŸŸã€‚æ­£æ˜¯å› ä¸ºä»¥å…ƒç´ å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼Œæ‰€ä»¥å…ƒç´ ç›’å­åº•éƒ¨å’Œå³ä¾§çš„åœ†å½¢å›¾æ¡ˆéƒ½åªæ˜¾ç¤ºäº†ä¸€éƒ¨åˆ†ã€‚è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‡å®šèƒŒæ™¯å›¾ç‰‡æ¥æºçš„æ–¹å¼ï¼Œä¸ imgæ ‡ç­¾ä¸­çš„æ–¹å¼ä¸åŒï¼Œè¦è¿™æ ·ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">background-image:url(å›¾ç‰‡è·¯å¾„/å›¾ç‰‡æ–‡ä»¶å)</span><br></pre></td></tr></table></figure>
<p>å›¾ç‰‡åœ°å€ä¸¤è¾¹ä¸ç”¨åŠ å¼•å·ï¼Œå½“ç„¶åŠ äº†ä¹Ÿæ²¡é—®é¢˜ã€‚<br>è¦æ”¹å˜é»˜è®¤çš„æ°´å¹³å’Œå‚ç›´é‡å¤æ•ˆæœï¼Œå¯ä»¥ä¿®æ”¹ background-repeat å±æ€§ï¼›è¦æ”¹å˜èƒŒæ™¯å›¾ç‰‡çš„èµ·ç‚¹ï¼Œå¯ä»¥ä¿®æ”¹ background-position å±æ€§ã€‚</p>
<h3 id="èƒŒæ™¯é‡å¤"><a href="#èƒŒæ™¯é‡å¤" class="headerlink" title="èƒŒæ™¯é‡å¤"></a>èƒŒæ™¯é‡å¤</h3><p>æ§åˆ¶èƒŒæ™¯é‡å¤çš„æ–¹å¼background-repeatå±æ€§æœ‰å››ä¸ªå€¼ã€‚é»˜è®¤å€¼æ˜¯repeatï¼Œæ•ˆæœå°±æ˜¯æŒ‰æ°´å¹³å’Œå‚ç›´æ–¹å‘éƒ½é‡å¤ï¼Œç›´è‡³å¡«æ»¡å…ƒç´ çš„èƒŒæ™¯åŒºåŸŸä¸ºæ­¢ã€‚å¦å¤–ä¸‰ä¸ªå€¼åˆ†åˆ«æ˜¯åªåœ¨æ°´å¹³æ–¹å‘é‡å¤çš„repeat-xã€åªåœ¨å‚ç›´æ–¹å‘ä¸Šé‡å¤çš„repeat-yå’Œåœ¨ä»»æ„æ–¹å‘ä¸Šéƒ½ä¸é‡å¤ï¼ˆæˆ–è€…è¯´åªè®©èƒŒæ™¯å›¾ç‰‡æ˜¾ç¤ºä¸€æ¬¡ï¼‰çš„no-repeatã€‚<br>ï¼ŒCSS3 è¿˜è§„å®šå¦å¤–ä¸¤ä¸ªå€¼ï¼ˆä½†å°šæœªå¾—åˆ°æµè§ˆå™¨æ”¯æŒï¼‰ï¼Œä»¥<br>æ§åˆ¶èƒŒæ™¯å›¾ç‰‡é‡å¤ç¡®åˆ‡çš„æ¬¡æ•°ï¼Œå³æ‰€æœ‰å›¾ç‰‡éƒ½æ˜¯å®Œæ•´çš„ï¼Œä¸ä¼šå‡ºç°åŠå¼ å›¾ç‰‡çš„ç°è±¡ã€‚<br>ï± background-repeat:roundï¼šä¸ºç¡®ä¿å›¾ç‰‡ä¸è¢«å‰ªåˆ‡ï¼Œé€šè¿‡è°ƒæ•´å›¾ç‰‡å¤§å°æ¥é€‚åº”èƒŒæ™¯<br>åŒºåŸŸã€‚<br>ï± background-repeat:spaceï¼Œä¸ºç¡®ä¿å›¾ç‰‡ä¸è¢«å‰ªåˆ‡ï¼Œé€šè¿‡åœ¨å›¾ç‰‡é—´æ·»åŠ ç©ºç™½æ¥é€‚åº”<br>èƒŒæ™¯åŒºåŸŸã€‚</p>
<h3 id="èƒŒæ™¯ä½ç½®"><a href="#èƒŒæ™¯ä½ç½®" class="headerlink" title="èƒŒæ™¯ä½ç½®"></a>èƒŒæ™¯ä½ç½®</h3><p>ç”¨äºæ§åˆ¶èƒŒæ™¯ä½ç½®çš„background-positionå±æ€§ï¼Œæ˜¯æ‰€æœ‰èƒŒæ™¯å±æ€§ä¸­æœ€å¤æ‚çš„ã€‚bancground-positionå±æ€§æœ‰5ä¸ªå…³é”®å€¼ï¼Œåˆ†åˆ«æ˜¯topã€leftã€bottomã€rightå’Œcenterï¼Œè¿™äº›å…³é”®å­—ä¸­çš„ä»»æ„æ‹æ­Œç»„åˆèµ·æ¥éƒ½å¯ä»¥ä½œä¸ºè¯¥å±æ€§çš„å€¼ã€‚æ¯”å¦‚ï¼Œtop right è¡¨ç¤ºæŠŠå›¾ç‰‡æ”¾åœ¨å…ƒç´ çš„å³ä¸Šè§’ä½ç½®ï¼Œcenter center æŠŠå›¾ç‰‡æ”¾åœ¨å…ƒç´ çš„ä¸­å¿ƒä½ç½®ã€‚<br>åƒä¸‡è¦æ³¨æ„ï¼Œbackground-position å±æ€§åŒæ—¶è®¾å®šå…ƒç´ å’Œå›¾ç‰‡çš„åŸç‚¹ã€‚åŸç‚¹å†³å®šäº†å…ƒç´ å’Œå›¾ç‰‡ä¸­æŸä¸€ç‚¹çš„æ°´å¹³å’Œå‚ç›´åæ ‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œbackground-position çš„åŸç‚¹ä½äºå·¦ä¸Šè§’ã€‚æ¢å¥è¯è¯´ï¼Œå…ƒç´ çš„å·¦ä¸Šè§’å’Œå›¾ç‰‡çš„å·¦ä¸Šè§’æ˜¯å¯¹é½çš„ï¼Œéšåå›¾ç‰‡å‘å„ä¸ªæ–¹å‘é‡å¤ï¼Œéƒ½æ˜¯ä»¥å·¦ä¸Šè§’ä¸ºèµ·ç‚¹ã€‚</p>
<p>èƒŒæ™¯ä½ç½®çš„å€¼<br>è®¾å®šèƒŒæ™¯ä½ç½®æ—¶å¯ä»¥ä½¿ç”¨ä¸‰ç§å€¼ï¼šå…³é”®å­—ã€ç™¾åˆ†æ¯”ã€ç»å¯¹æˆ–ç›¸å¯¹å•ä½çš„æ•°å€¼ã€‚å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå€¼åˆ†åˆ«è®¾å®šæ°´å¹³å’Œå‚ç›´ä½ç½®ã€‚<br>å…³é”®å­—æŒ‡çš„é¡ºåºä¸é‡è¦ï¼Œleft bottom å’Œ bottom left æ„æ€ç›¸åŒã€‚ä¸ºäº†è®¾å®šçš„å€¼åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­éƒ½æœ‰æ•ˆï¼Œæœ€å¥½ä¸è¦æ··ç”¨å…³é”®å­—å€¼ä¸æ•°å­—å€¼ã€‚<br>ä½¿ç”¨æ•°å€¼ï¼ˆæ¯”å¦‚ 40% 30%ï¼‰æ—¶ï¼Œç¬¬ä¸€ä¸ªå€¼è¡¨ç¤ºæ°´å¹³ä½ç½®ï¼Œç¬¬äºŒä¸ªå€¼è¡¨ç¤ºå‚ç›´ä½ç½®ã€‚è¦æ˜¯åªè®¾å®šä¸€ä¸ªå€¼ï¼Œåˆ™å°†å…¶ç”¨æ¥è®¾å®šæ°´å¹³ä½ç½®ï¼Œè€Œå‚ç›´ä½ç½®ä¼šè¢«è®¾ä¸º centerã€‚<br>åœ¨ä½¿ç”¨å…³é”®å­—å’Œç™¾åˆ†æ¯”å€¼çš„æƒ…å†µä¸‹ï¼Œè®¾å®šçš„å€¼åŒæ—¶åº”ç”¨äºå…ƒç´ å’Œå›¾ç‰‡ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœè®¾å®šäº†33% 33%ï¼Œåˆ™å›¾ç‰‡æ°´å¹³ 33%çš„ä½ç½®ä¸å…ƒç´ æ°´å¹³ 33%çš„ä½ç½®å¯¹é½ã€‚å‚ç›´æ–¹é¢ä¹Ÿä¸€æ ·ã€‚å›¾ 3-37 æ‰€ç¤ºä¹Ÿæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œé‚£æ˜¯é€šè¿‡ center center æŠŠå›¾ç‰‡çš„ä¸­å¿ƒç‚¹å®šä½åœ¨äº†å…ƒç´ çš„ä¸­å¿ƒç‚¹ã€‚<br>åƒç´ ä¹‹ç±»çš„ç»å¯¹å•ä½æ•°å€¼å°±ä¸ä¸€æ ·äº†ã€‚è¦æ˜¯ç”¨åƒç´ å•ä½æ¥è®¾å®šä½ç½®ï¼Œé‚£ä¹ˆå›¾ç‰‡çš„å·¦ä¸Šè§’ä¼šè¢«æ”¾åœ¨è·ç¦»å…ƒç´ å·¦ä¸Šè§’æŒ‡å®šä½ç½®çš„åœ°æ–¹ã€‚<br>æœ‰æ„æ€çš„æ˜¯ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è´Ÿå€¼ã€‚è¿™æ ·å°±å¯ä»¥æŠŠå›¾ç‰‡çš„å·¦ä¸Šè§’å®šä½åˆ°å…ƒç´ å¤–éƒ¨ï¼Œä»è€Œåœ¨å…ƒç´ ä¸­åªèƒ½çœ‹åˆ°éƒ¨åˆ†å›¾ç‰‡ã€‚å½“ç„¶ï¼Œç»™å›¾ç‰‡è®¾å®šè¶³å¤Ÿå¤§çš„æ­£å€¼ï¼Œä¹Ÿå¯ä»¥æŠŠå›¾ç‰‡çš„å³ä¸‹è§’æ¨åˆ°å…ƒç´ å¤–éƒ¨ï¼Œä»è€Œåœ¨å…ƒç´ ä¸­ä¹Ÿåªèƒ½çœ‹åˆ°éƒ¨åˆ†å›¾ç‰‡ã€‚ä½äºå…ƒç´ å¤–éƒ¨çš„é‚£éƒ¨åˆ†å›¾ç‰‡ä¸ä¼šæ˜¾ç¤ºã€‚</p>
<h3 id="èƒŒæ™¯å°ºå¯¸"><a href="#èƒŒæ™¯å°ºå¯¸" class="headerlink" title="èƒŒæ™¯å°ºå¯¸"></a>èƒŒæ™¯å°ºå¯¸</h3><p>background-sizeæ˜¯CSS3è§„å®šçš„å±æ€§ï¼Œä½†å´å¾—åˆ°äº†æµè§ˆå™¨å¾ˆå¥½çš„æ”¯æŒã€‚è¿™ä¸ªå±æ€§ç”¨æ¥æ§åˆ¶èƒŒæ™¯å›¾ç‰‡çš„å°ºå¯¸ï¼Œå¯ä»¥ç»™ä»–è®¾å®šçš„å€¼åŠå«ä¹‰å¦‚ä¸‹ã€‚<br>ï± 50%ï¼šç¼©æ”¾å›¾ç‰‡ï¼Œä½¿å…¶å¡«å……èƒŒæ™¯åŒºçš„ä¸€åŠã€‚<br>ï± 100px 50pxï¼šæŠŠå›¾ç‰‡è°ƒæ•´åˆ° 100 åƒç´ å®½ï¼Œ50 åƒç´ é«˜ã€‚<br>ï± coverï¼šæ‹‰å¤§å›¾ç‰‡ï¼Œä½¿å…¶å®Œå…¨å¡«æ»¡èƒŒæ™¯åŒºï¼›ä¿æŒå®½é«˜æ¯”ã€‚<br>ï± containï¼šç¼©æ”¾å›¾ç‰‡ï¼Œä½¿å…¶æ°å¥½é€‚åˆèƒŒæ™¯åŒºï¼›ä¿æŒå®½é«˜æ¯”ã€‚</p>
<h3 id="èƒŒæ™¯ç²˜é™„"><a href="#èƒŒæ™¯ç²˜é™„" class="headerlink" title="èƒŒæ™¯ç²˜é™„"></a>èƒŒæ™¯ç²˜é™„</h3><p>background-attachment å±æ€§æ§åˆ¶æ»šåŠ¨å…ƒç´ å†…çš„èƒŒæ™¯å›¾ç‰‡æ˜¯å¦éšå…ƒç´ æ»šåŠ¨è€Œç§»åŠ¨ã€‚è¿™ä¸ªå±æ€§çš„é»˜è®¤å€¼æ˜¯ scrollï¼Œå³èƒŒæ™¯å›¾ç‰‡éšå…ƒç´ ç§»åŠ¨ã€‚å¦‚æœæŠŠå®ƒçš„å€¼æ”¹ä¸º fixedï¼Œé‚£ä¹ˆèƒŒæ™¯å›¾ç‰‡ä¸ä¼šéšå…ƒç´ æ»šåŠ¨è€Œç§»åŠ¨ã€‚<br>background-attachment:fixed æœ€å¸¸ç”¨äºç»™ body å…ƒç´ ä¸­å¿ƒä½ç½®æ·»åŠ æ·¡è‰²æ°´å°ï¼Œè®©æ°´å°ä¸éšé¡µé¢æ»šåŠ¨è€Œç§»åŠ¨ã€‚</p>
<h3 id="ç®€å†™èƒŒæ™¯å±æ€§"><a href="#ç®€å†™èƒŒæ™¯å±æ€§" class="headerlink" title="ç®€å†™èƒŒæ™¯å±æ€§"></a>ç®€å†™èƒŒæ™¯å±æ€§</h3><p>background å±æ€§å¯ä»¥ç”¨æ¥è®¾å®šæ‰€æœ‰èƒŒæ™¯ç›¸å…³çš„å€¼ã€‚æ¯”å¦‚ï¼Œå‰é¢é‚£ä¸ª backgroundattachment çš„ä¾‹å­ä½¿ç”¨ç®€å†™çš„ background å±æ€§ï¼Œå¯ä»¥å†™æˆè¿™æ ·ä¸€æ¡è§„åˆ™ï¼šbody {background:url(images/watermark.png) center #fff no-repeat contain fixed;} å£°æ˜ä¸­å°‘å†™äº†å“ªä¸ªå±æ€§çš„å€¼ï¼ˆæ¯”å¦‚æ²¡å†™ no-repeatï¼‰ï¼Œå°±ä¼šä½¿ç”¨ç›¸åº”å±æ€§çš„é»˜è®¤å€¼ï¼ˆrepeatï¼‰ã€‚</p>
<h3 id="å¤šèƒŒæ™¯å›¾ç‰‡"><a href="#å¤šèƒŒæ™¯å›¾ç‰‡" class="headerlink" title="å¤šèƒŒæ™¯å›¾ç‰‡"></a>å¤šèƒŒæ™¯å›¾ç‰‡</h3><p>CSS3è¿˜å¯ä»¥ç»™å…ƒç´ èƒŒæ™¯æ·»åŠ å¤šä¸ªèƒŒæ™¯å›¾ç‰‡</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123; </span><br><span class="line"> <span class="attribute">height</span>:<span class="number">150px</span>; </span><br><span class="line"> <span class="attribute">width</span>:<span class="number">348px</span>; </span><br><span class="line"> <span class="attribute">border</span>:<span class="number">2px</span> solid <span class="number">#aaa</span>; </span><br><span class="line"> <span class="attribute">margin</span>:<span class="number">20px</span> auto; </span><br><span class="line"> <span class="attribute">font</span>:<span class="number">24px</span>/<span class="number">150px</span> helvetica, arial, sansserif; </span><br><span class="line"> <span class="attribute">text-align</span>:center; </span><br><span class="line"> <span class="attribute">background</span>: </span><br><span class="line"> <span class="built_in">url</span>(images/turq_spiral.png) <span class="number">30px</span> -<span class="number">10px</span> no-repeat, </span><br><span class="line"> <span class="built_in">url</span>(images/pink_spiral.png) <span class="number">145px</span> <span class="number">0px</span> no-repeat, </span><br><span class="line"> <span class="built_in">url</span>(images/gray_spiral.png) <span class="number">140px</span> -<span class="number">30px</span> no-repeat, <span class="number">#ffbd75</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ CSS ä¸­ï¼Œæˆ‘æŠŠæ¯å¼ å›¾ç‰‡çš„å£°æ˜éƒ½å•ç‹¬æ”¾åœ¨äº†ä¸€è¡Œé‡Œï¼Œä»¥é€—å·åˆ†éš”ï¼Œä»¥ä¾¿çœ‹æ¸…å®ƒä»¬çš„ä½ç½®ã€é‡å¤çš„è®¾å®šå€¼ã€‚ä¸ºäº†é˜²æ­¢å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶å…ƒç´ èƒŒæ™¯å¤„äºé»˜è®¤çš„é€æ˜çŠ¶æ€ï¼Œè¿™é‡Œä¹Ÿåœ¨æœ€åä¸€æ¡å£°æ˜ä¸­åŠ ä¸Šäº†èƒŒæ™¯é¢œè‰²ï¼ˆåŠ ç²—çš„å€¼ï¼‰ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œä»£ç ä¸­å…ˆåˆ—å‡ºçš„å›¾ç‰‡æ˜¾ç¤ºåœ¨ä¸Šæ–¹ï¼Œæˆ–è€…è¯´ï¼Œæ›´æ¥è¿‘å‰æ™¯ã€‚</p>
<h3 id="èƒŒæ™¯æ¸å˜"><a href="#èƒŒæ™¯æ¸å˜" class="headerlink" title="èƒŒæ™¯æ¸å˜"></a>èƒŒæ™¯æ¸å˜</h3><p>æ¸å˜å°±æ˜¯åœ¨ä¸€å®šé•¿åº¦å†…ä¸¤ç§æˆ–å¤šç§é¢œè‰²ä¹‹é—´è‡ªç„¶çš„è¿‡æ¸¡ã€‚æ¸å˜åˆ†ä¸¤ç§ï¼Œä¸€ç§çº¿æ€§æ¸å˜ï¼Œä¸€ç§æ”¾å°„æ€§æ¸å˜ã€‚çº¿æ€§æ¸å˜ä»å…ƒç´ çš„ä¸€ç«¯å»¶ä¼¸åˆ°å¦ä¸€ç«¯ï¼Œæ”¾å°„æ€§æ¸å˜åˆ™ä»å…ƒç´ å†…ä¸€ç‚¹å‘å››å‘¨å‘æ•£ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'gradient1'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'gradient2'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'gradient3'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*ä¸ºå…ƒç´ ç›’å­æ·»åŠ æ ·å¼*/</span> </span><br><span class="line"><span class="selector-tag">div</span> &#123; </span><br><span class="line"> <span class="attribute">height</span>:<span class="number">150px</span>; </span><br><span class="line"> <span class="attribute">width</span>:<span class="number">200px</span>; </span><br><span class="line"> <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#ccc</span>; </span><br><span class="line"> <span class="attribute">float</span>:left; </span><br><span class="line"> <span class="attribute">margin</span>:<span class="number">16px</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*ä¾‹ 1ï¼šé»˜è®¤ä¸ºä»ä¸Šåˆ°ä¸‹*/</span> </span><br><span class="line"><span class="selector-class">.gradient1</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>:<span class="built_in">linear-gradient</span>(#e86a43, #fff); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*ä¾‹ 2ï¼šä»å·¦åˆ°å³*/</span></span><br><span class="line"><span class="selector-class">.gradient2</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>:<span class="built_in">linear-gradient</span>(left, #<span class="number">64</span>d1dd, #fff); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*ä¾‹ 3ï¼šå·¦ä¸Šåˆ°å³ä¸‹*/</span> </span><br><span class="line"><span class="selector-class">.gradient3</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>:<span class="built_in">linear-gradient</span>(-<span class="number">45deg</span>, #e86a43, #fff); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.æ¸å˜ç‚¹<br>æ¸å˜ç‚¹å°±æ˜¯æ¸å˜æ–¹å‘ä¸Šçš„ç‚¹ï¼Œå¯ä»¥åœ¨è¿™äº›ç‚¹ä¸Šè®¾å®šé¢œè‰²å’Œä¸é€æ˜åº¦ã€‚é€šè¿‡è®¾å®šä¸‹ä¸€ä¸ªæ¸å˜ç‚¹çš„é¢œè‰²å€¼ï¼Œå°±å¯ä»¥æ§åˆ¶æ¸å˜çš„æ•ˆæœã€‚å¯ä»¥æ·»åŠ ä»»æ„å¤šä¸ªæ¸å˜ç‚¹ã€‚æ¸å˜ç‚¹çš„ä½ç½®ä¸€èˆ¬ä½¿ç”¨æ•´ä¸ªæ¸å˜å®½åº¦çš„ç™¾åˆ†æ¯”æ¥è¡¨ç¤ºã€‚å›¾ 3-41 å±•ç¤ºäº†ä½¿ç”¨æ¸å˜ç‚¹åçš„å››ç§æ¸å˜æ•ˆæœã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*ä¾‹ 1ï¼š50%å¤„æœ‰ä¸€ä¸ªæ¸å˜ç‚¹*/</span> </span><br><span class="line"><span class="selector-class">.gradient1</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>:<span class="built_in">linear-gradient</span>(#<span class="number">64</span>d1dd, #fff <span class="number">50%</span>, #<span class="number">64</span>d1dd); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*ä¾‹ 2ï¼š20%å’Œ 80%å¤„æœ‰ä¸¤ä¸ªæ¸å˜ç‚¹*/</span> </span><br><span class="line"><span class="selector-class">.gradient2</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>:<span class="built_in">linear-gradient</span>(#e86a43 <span class="number">20%</span>, #fff <span class="number">50%</span>, #e86a43 <span class="number">80%</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*ä¾‹ 3ï¼š25%ã€50%ã€75%å¤„æœ‰ä¸‰ä¸ªæ¸å˜ç‚¹*/</span> </span><br><span class="line"><span class="selector-class">.gradient3</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">linear-gradient</span>(#<span class="number">64</span>d1dd, #fff <span class="number">25%</span>, #<span class="number">64</span>d1dd <span class="number">50%</span>, #fff <span class="number">75%</span>, </span><br><span class="line">#<span class="number">64</span>d1dd); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*ä¾‹ 4ï¼šä¸ºåŒä¸€ä¸ªæ¸å˜ç‚¹è®¾å®šä¸¤ç§é¢œè‰²å¯ä»¥å¾—åˆ°çªå˜æ•ˆæœ*/</span> </span><br><span class="line"><span class="selector-class">.gradient4</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>:<span class="built_in">linear-gradient</span>(#e86a43, #fff <span class="number">25%</span>, #<span class="number">64</span>d1dd <span class="number">25%</span>, #<span class="number">64</span>d1dd <span class="number">75%</span>, </span><br><span class="line">#fff <span class="number">75%</span>, #e86a43); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å›¾ 3-41 ä¸­çš„ä¾‹ 1 åœ¨ 50%å¤„åŒ…å«ä¸€ä¸ªæ¸å˜ç‚¹ï¼Œå› æ­¤æ¸å˜æ•ˆæœæ˜¯ä»å¼€å§‹é¢œè‰²åˆ°æ¸å˜ç‚¹é¢œè‰²ï¼ˆç™½è‰²ï¼‰ï¼Œç„¶åå†ä»æ¸å˜ç‚¹é¢œè‰²åˆ°ç»“æŸé¢œè‰²ã€‚æ³¨æ„ï¼Œå¼€å§‹å’Œç»“æŸä½ç½®å¦‚æœæ²¡æœ‰å£°æ˜ï¼Œåˆ™é»˜è®¤ä¸º 0%å’Œ 100%ã€‚<br>å¦‚æœä¸æ˜¯ä½¿ç”¨ç™¾åˆ†æ¯”æˆ–å…¶ä»–å€¼å£°æ˜æ¸å˜ç‚¹çš„ä½ç½®ï¼Œåˆ™ä¸‰ç§é¢œè‰²ä¼šå‡åŒ€åˆ†å¸ƒäºæ•´ä¸ªæ¸å˜ï¼Œå…¶å®é™…ä½ç½®æ˜¯ 0%ã€50%å’Œ 100%ã€‚<br>ä¾‹ 2 æ¼”ç¤ºäº†èµ·ç‚¹å’Œç»ˆç‚¹ä¸æ˜¯ 0%å’Œ 100%æ—¶çš„æƒ…å½¢ã€‚æ­¤æ—¶ï¼Œåœ¨ç¬¬ä¸€ä¸ªæ¸å˜ç‚¹ï¼ˆ20%ï¼‰ä¹‹å‰ï¼Œæ˜¯ç¬¬ä¸€ä¸ªæ¸å˜ç‚¹å£°æ˜çš„å®è‰²ï¼Œè€Œåœ¨è¯¥ç‚¹ä¹‹åï¼Œåˆ™æ˜¯ä»è¯¥é¢œè‰²åˆ°ä¸‹ä¸€ä¸ªæ¸å˜ç‚¹é¢œè‰²çš„è¿‡æ¸¡ã€‚åŒæ ·ï¼Œåœ¨æœ€åä¸€ä¸ªæ¸å˜ç‚¹ï¼ˆ80%ï¼‰ä¹‹åï¼Œè¯¥æ¸å˜ç‚¹çš„é¢œè‰²ä¼šä»¥å®è‰²æ‰©å±•åˆ°å…ƒç´ ç»“æŸã€‚<br>ä¾‹ 3 ç®€å•å±•ç¤ºäº†ç›¸åŒé¢œè‰²åœ¨å‡ ä¸ªæ¸å˜ç‚¹ä¹‹é—´å˜æ¥å˜å»çš„æ•ˆæœã€‚ä¾‹ 4 å±•ç¤ºäº†åœ¨åŒä¸€ä¸ªæ¸å˜ç‚¹å£°æ˜ä¸¤ç§ä¸åŒçš„é¢œè‰²ï¼Œèƒ½å®ç°ä¸€ç§çªå˜çš„æ•ˆæœã€‚</p>
<p>2.æ”¾å°„æ€§æ¸å˜<br>æ”¾å°„æ€§æ¸å˜æ¯”çº¿æ€§æ¸å˜å¤æ‚é‚£ä¹ˆä¸€ç‚¹ç‚¹ï¼Œå› ä¸ºå¯ç”¨çš„æ§åˆ¶ç‚¹å¤šä¸€äº›ã€‚å¦‚æœä½ å†™è¿‡ç¨‹åºï¼Œä»å±æ€§å€¼ä¸­çš„æ‹¬å·å°±å¯ä»¥çœ‹å‡ºï¼Œæ¸å˜å±æ€§å…¶å®æ˜¯å‡½æ•°ã€‚ä»€ä¹ˆæ˜¯å‡½æ•°ï¼Ÿå‡½æ•°å¯ä»¥æ¥æ”¶å‚æ•°ï¼Œç„¶åæ ¹æ®è¿™äº›å‚æ•°æ¥ç”Ÿæˆæ¸å˜ã€‚åœ¨åˆ›å»ºæ”¾å°„æ€§æ¸å˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•°æŒ‡å®šå½¢çŠ¶ã€ä½ç½®ã€å°ºå¯¸ã€é¢œè‰²å’Œä¸é€æ˜åº¦ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.gradient1</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>: <span class="built_in">-webkit-radial-gradient</span>(#fff, #<span class="number">64</span>d1dd, #<span class="number">70</span>aa25); </span><br><span class="line">&#125; </span><br><span class="line"><span class="selector-class">.gradient2</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>: <span class="built_in">-webkit-radial-gradient</span>(circle, #fff, #<span class="number">64</span>d1dd, #e86a43); </span><br><span class="line">&#125; </span><br><span class="line"><span class="selector-class">.gradient3</span> &#123; </span><br><span class="line"> <span class="attribute">background</span>: <span class="built_in">-webkit-radial-gradient</span>(<span class="number">50px</span> <span class="number">30px</span>, circle, #fff, #<span class="number">64</span>d1dd, </span><br><span class="line">#<span class="number">4947</span>ba); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹ 2 è®¾å®šäº†å½¢çŠ¶å…³é”®å­— circleï¼Œäºæ˜¯æ¸å˜çš„å½¢çŠ¶å˜å¾—å‡åŒ€ï¼Œå¹¶åœ¨å…ƒç´ æœ€è¿‘çš„è¾¹è¾¾åˆ°äº†ç»ˆç‚¹ï¼Œå½¢æˆäº†åœ†å½¢æ¸å˜ã€‚è€Œé•¿è¾¹å‰©ä¸‹çš„åŒºåŸŸåˆ™å¡«å……äº†ç»ˆç‚¹çš„é¢œè‰²ã€‚ä¾‹ 3 ä¸­çš„ä½ç½®å‚æ•° 50px 30px æŠŠæ¸å˜çš„åœ†å¿ƒæ”¾åˆ°äº†é è¿‘å·¦ä¸Šè§’çš„ä½ç½®ã€‚</p>
<h3 id="flexå¸ƒå±€"><a href="#flexå¸ƒå±€" class="headerlink" title="flexå¸ƒå±€"></a>flexå¸ƒå±€</h3><p>flexæ˜¯flexible boxçš„ç¼©å†™ï¼Œæ„ä¸ºâ€œå¼¹æ€§å¸ƒå±€â€ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§ã€‚çƒ­å’Œä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºflexå¸ƒå±€ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¡Œå†…å…ƒç´ ä¹Ÿå¯ä»¥ä½¿ç”¨flexå¸ƒå±€ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-flex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>webkitå†…æ ¸çš„æµè§ˆå™¨ï¼Œå¿…é¡»åŠ ä¸Š-webkitå‰ç¼€ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-flex;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼Œè®¾ä¸ºflexå¸ƒå±€ä»¥åï¼Œå­å…ƒç´ floatã€clearå’Œveritical-alignå±æ€§å°†å¤±æ•ˆã€‚</strong></p>
<h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>é‡‡ç”¨flexå¸ƒå±€çš„å…ƒç´ ï¼Œæˆä¸ºflexå®¹å™¨ï¼ˆflex containerï¼‰ï¼Œç®€ç§°â€œå®¹å™¨â€ã€‚å®ƒæ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œç§°ä¸ºflexé¡¹ç›®ï¼ˆflex itemï¼‰ï¼Œç®€ç§°â€œé¡¹ç›®â€ã€‚<br>å®¹å™¨é»˜è®¤å­˜åœ¨ä¸¤æ ¹è½´ï¼šæ°´å¹³çš„ä¸»è½´ï¼ˆmain axisï¼‰å’Œå‚ç›´çš„äº¤å‰è½´ï¼ˆcross axisï¼‰ã€‚ä¸»è½´çš„å¼€å§‹ä½ç½®ï¼ˆä¸è¾¹æ¡†çš„äº¤å‰ç‚¹ï¼‰å«åšmain startï¼Œç»“æŸä½ç½®å«åšmain endï¼›äº¤å‰è½´çš„å¼€å§‹ä½ç½®å«åšcross startï¼Œç»“æŸä½ç½®å«åšcross endã€‚<br>é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æ’åˆ—ã€‚å•ä¸ªé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´å«åšmain sizeï¼Œå æ®çš„äº¤å‰è½´ç©ºé—´å«åšcross sizeã€‚</p>
<h3 id="å®¹å™¨çš„å±æ€§"><a href="#å®¹å™¨çš„å±æ€§" class="headerlink" title="å®¹å™¨çš„å±æ€§"></a>å®¹å™¨çš„å±æ€§</h3><p>ä¸€ä¸‹6ä¸ªå±æ€§è®¾ç½®åœ¨å®¹å™¨ä¸Šï¼š<br>1.flex-direction<br>2.flex-wrap<br>3.flex-flow<br>4.justify-content<br>5.align-items<br>6.align-content</p>
<h4 id="flex-directionå±æ€§"><a href="#flex-directionå±æ€§" class="headerlink" title="flex-directionå±æ€§"></a>flex-directionå±æ€§</h4><p>flex-directionå±æ€§å†³å®šæ ªæ´²çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æ’åˆ—æ–¹å‘ï¼‰ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row | row-reverse | column | column-reverse;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒå¯èƒ½æœ‰å››ä¸ªå€¼<br>1.rowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚<br>2.row-reverseï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚<br>3.columnï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚<br>4.column-reverseï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚</p>
<h4 id="flex-wrapå±æ€§"><a href="#flex-wrapå±æ€§" class="headerlink" title="flex-wrapå±æ€§"></a>flex-wrapå±æ€§</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡¹ç›®éƒ½æ’åœ¨ä¸€æ¡çº¿ï¼ˆåˆç§°â€œè½´çº¿â€ä¸Šï¼‰ã€‚flex-wrapå±æ€§å®šä¹‰ï¼Œå¦‚æœä¸€æ¡è½´çº¿æ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œ</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: nowrap | wrap | wrap-reverse;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒå¯èƒ½å–ä¸‰ä¸ªå€¼ï¼š<br>1.nowrapï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œã€‚<br>2.wrapï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹ã€‚<br>3.wrap-reverseï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ã€‚</p>
<h4 id="flex-flow"><a href="#flex-flow" class="headerlink" title="flex-flow"></a>flex-flow</h4><p>flex-flowå±æ€§æ˜¯flex-directionå±æ€§å’Œflex-wrapå±æ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸ºrow nowrapã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">flex-flow</span>: &lt;flex-direction&gt; || &lt;flex-wrap&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="justify-contentå±æ€§"><a href="#justify-contentå±æ€§" class="headerlink" title="justify-contentå±æ€§"></a>justify-contentå±æ€§</h4><p>justify-contentå±æ€§å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">justify-content</span>: flex-start | flex-end | center | space-between | space-around;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒå¯èƒ½å–5ä¸ªå€¼ï¼Œå…·ä½“å¯¹é½æ–¹å¼ä¸è½´çš„æ–¹å‘æœ‰å…³ã€‚ä¸‹é¢å‡è®¾ä¸»è½´ä¸ºä»å·¦åˆ°å³ã€‚<br>1.flex-startï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½<br>2.flex-endï¼šå³å¯¹é½<br>3.centerï¼š å±…ä¸­<br>4.space-betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚<br>5.space-aroundï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚</p>
<h4 id="align-itemså±æ€§"><a href="#align-itemså±æ€§" class="headerlink" title="align-itemså±æ€§"></a>align-itemså±æ€§</h4><p>align-itemså±æ€§å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">align-items</span>: flex-start | flex-end | center | baseline | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒå¯èƒ½å–5ä¸ªå€¼ã€‚å…·ä½“çš„å¯¹é½æ–¹å¼ä¸äº¤å‰è½´çš„æ–¹å‘æœ‰å…³ï¼Œä¸‹é¢å‡è®¾äº¤å‰è½´ä»ä¸Šåˆ°ä¸‹ã€‚</p>
<p>1.flex-startï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚<br>2.flex-endï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚<br>3.centerï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚<br>4.baseline: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚<br>5.stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚</p>
<h4 id="align-contentå±æ€§"><a href="#align-contentå±æ€§" class="headerlink" title="align-contentå±æ€§"></a>align-contentå±æ€§</h4><p>align-contentå±æ€§å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">align-content</span>: flex-start | flex-end | center | space-between | space-around | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¥å±æ€§å¯èƒ½å–6ä¸ªå€¼ã€‚</p>
<p>1.flex-startï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚<br>2.flex-endï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚<br>3.centerï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚<br>4.space-betweenï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚<br>5.space-aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚<br>6.stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚</p>
<h3 id="é¡¹ç›®çš„å±æ€§"><a href="#é¡¹ç›®çš„å±æ€§" class="headerlink" title="é¡¹ç›®çš„å±æ€§"></a>é¡¹ç›®çš„å±æ€§</h3><p>ä»¥ä¸‹6ä¸ªå±æ€§è®¾ç½®åœ¨é¡¹ç›®ä¸Š<br>1.order<br>2.flex-grow<br>3.flex-shrink<br>4.flex-basis<br>5.flex<br>6.align-self</p>
<h4 id="orderå±æ€§"><a href="#orderå±æ€§" class="headerlink" title="orderå±æ€§"></a>orderå±æ€§</h4><p>orderå±æ€§å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">order</span>: &lt;integer&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="flex-growå±æ€§"><a href="#flex-growå±æ€§" class="headerlink" title="flex-growå±æ€§"></a>flex-growå±æ€§</h4><p>flex-growå±æ€§å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: &lt;number&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„flex-growå±æ€§éƒ½ä¸º1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-growå±æ€§ä¸º2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ã€‚</p>
<h4 id="flex-shrinkå±æ€§"><a href="#flex-shrinkå±æ€§" class="headerlink" title="flex-shrinkå±æ€§"></a>flex-shrinkå±æ€§</h4><p>flex-shrinkå±æ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: &lt;number&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„flex-shrinkå±æ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±æ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚è´Ÿå€¼å¯¹è¯¥å±æ€§æ— æ•ˆã€‚</p>
<h4 id="flex-basiså±æ€§"><a href="#flex-basiså±æ€§" class="headerlink" title="flex-basiså±æ€§"></a>flex-basiså±æ€§</h4><p>flex-basiså±æ€§å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ï¼ˆmain sizeï¼‰ã€‚æµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±æ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®æœ¬æ¥çš„å¤§å°ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-basis</span>: &lt;length&gt; | auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒå¯ä»¥è®¾ä¸ºè·Ÿwidthæˆ–heightå±æ€§ä¸€æ ·çš„å€¼ï¼Œåˆ™é¡¹ç›®å°†å æ®å›ºå®šç©ºé—´ã€‚</p>
<h4 id="flexå±æ€§"><a href="#flexå±æ€§" class="headerlink" title="flexå±æ€§"></a>flexå±æ€§</h4><p>flexå±æ€§æ˜¯flex-grow, flex-shrink å’Œ flex-basisçš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚åä¸¤ä¸ªå±æ€§å¯é€‰ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Basic values */</span></span><br><span class="line"><span class="selector-tag">flex</span>: <span class="selector-tag">auto</span>;</span><br><span class="line"><span class="selector-tag">flex</span>: <span class="selector-tag">initial</span>;</span><br><span class="line"><span class="selector-tag">flex</span>: <span class="selector-tag">none</span>;</span><br><span class="line"><span class="selector-tag">flex</span>: 2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* One value, unitless number: flex-grow */</span></span><br><span class="line"><span class="selector-tag">flex</span>: 2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* One value, width/height: flex-basis */</span></span><br><span class="line"><span class="selector-tag">flex</span>: 10<span class="selector-tag">em</span>;</span><br><span class="line"><span class="selector-tag">flex</span>: 30<span class="selector-tag">px</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Two values: flex-grow| flex-basis */</span></span><br><span class="line"><span class="selector-tag">flex</span>: 1 30<span class="selector-tag">px</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Tow values: flex-grow| flex-shrink */</span></span><br><span class="line"><span class="selector-tag">flex</span>: 2 2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Three values: flex-grow| flex-shrink| flex-basis */</span></span><br><span class="line"><span class="selector-tag">flex</span>: 2 2 10%;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Global values */</span></span><br><span class="line"><span class="selector-tag">flex</span>: <span class="selector-tag">inherit</span>;</span><br><span class="line"><span class="selector-tag">flex</span>: <span class="selector-tag">initial</span>;</span><br><span class="line"><span class="selector-tag">flex</span>: <span class="selector-tag">unset</span>;</span><br></pre></td></tr></table></figure>
<p>flexå±æ€§å¯ä»¥æŒ‡å®š1ä¸ªï¼Œ2ä¸ªæˆ–3ä¸ªå€¼ã€‚<br><strong>å•å€¼è¯­æ³•</strong>:<br>å€¼å¿…é¡»ä¸ºä»¥ä¸‹å…¶ä¸­ä¹‹ä¸€ï¼š<br>1.ä¸€ä¸ªæ— å•ä½æ•°ï¼ˆ<number>):å®ƒä¼šè¢«å½“åš<flex-grow>çš„å€¼ã€‚<br>2.ä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦ï¼ˆwidthï¼‰å€¼ï¼šå®ƒä¼šè¢«å½“åš<flex-basis>çš„å€¼<br>3.å…³é”®å­—noneï¼Œautoæˆ–initial</p>
<p><strong>åŒå€¼è¯­æ³•</strong>:<br>ç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <flex-grow> çš„å€¼ã€‚ç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä»¥ä¸‹ä¹‹ä¸€ï¼š<br>1.ä¸€ä¸ªæ— å•ä½æ•°ï¼šå®ƒä¼šè¢«å½“ä½œ <flex-shrink> çš„å€¼ã€‚<br>2.ä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦å€¼: å®ƒä¼šè¢«å½“ä½œ <flex-basis> çš„å€¼ã€‚</p>
<p><strong>ä¸‰å€¼è¯­æ³•</strong>:<br>1.ç¬¬ä¸€ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <flex-grow> çš„å€¼ã€‚<br>2.ç¬¬äºŒä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæ— å•ä½æ•°ï¼Œå¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ  <flex-shrink> çš„å€¼ã€‚<br>3.ç¬¬ä¸‰ä¸ªå€¼å¿…é¡»ä¸ºä¸€ä¸ªæœ‰æ•ˆçš„å®½åº¦å€¼ï¼Œ å¹¶ä¸”å®ƒä¼šè¢«å½“ä½œ <flex-basis> çš„å€¼ã€‚</p>
<h4 id="align-selfå±æ€§"><a href="#align-selfå±æ€§" class="headerlink" title="align-selfå±æ€§"></a>align-selfå±æ€§</h4><p>align-selfå±æ€§å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸å…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–align-itemså±æ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºstretchã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">align-self</span>: auto | flex-start | flex-end | baseline | stretch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/" class="post-title-link" itemprop="url">è¿­ä»£å™¨å’Œç”Ÿæˆå™¨</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 10:04:36 / Modified: 11:14:14" itemprop="dateCreated datePublished" datetime="2020-04-26T10:04:36+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="å¾ªç¯çš„é—®é¢˜"><a href="#å¾ªç¯çš„é—®é¢˜" class="headerlink" title="å¾ªç¯çš„é—®é¢˜"></a>å¾ªç¯çš„é—®é¢˜</h4><p>è€ƒè™‘å¦‚ä¸‹ä»£ç åŒºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> colors = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = colors.length; i &lt;len; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(color[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è™½ç„¶è¿™ä¸ªå¾ªç¯éå¸¸ç›´è§‚ï¼Œç„¶è€Œå½“å®ƒè¢«åµŒå¥—ä½¿ç”¨å¹¶è¦è¿½è¸ªå¤šä¸ªå˜é‡æ—¶ï¼Œæƒ…å†µå°±ä¼šå˜å¾—éå¸¸å¤æ‚ã€‚é¢å¤–çš„å¤æ‚åº¦ä¼šå¼•å‘é”™è¯¯ï¼Œè€Œforå¾ªç¯çš„æ ·æ¿æ€§ä¹Ÿå¢åŠ äº†è‡ªèº«å‡ºé”™çš„å¯èƒ½æ€§ï¼Œå› ä¸ºç›¸ä¼¼çš„ä»£ç ä¼šè¢«å¸è½½å¤šä¸ªåœ°æ–¹ã€‚è¿­ä»£å™¨æ­£å¼ç”¨æ¥è§£å†³æ­¤é—®é¢˜çš„ã€‚</p>
<h4 id="ä½•ä¸ºè¿­ä»£å™¨"><a href="#ä½•ä¸ºè¿­ä»£å™¨" class="headerlink" title="ä½•ä¸ºè¿­ä»£å™¨"></a>ä½•ä¸ºè¿­ä»£å™¨</h4><p>è¿­ä»£å™¨æ˜¯è¢«è®¾è®¡ä¸“ç”¨äºè¿­ä»£çš„å¯¹è±¡ï¼Œå¸¦æœ‰ç‰¹å®šæ¥å£ã€‚æ‰€æœ‰è¿­ä»£å™¨å¯¹è±¡éƒ½æ‹¥æœ‰next()æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªç»“æœå¯¹è±¡ã€‚è¯¥ç»“æœå¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ï¼Œå¯¹åº”ä¸‹ä¸€ä¸ªå€¼çš„valueï¼Œä¸€é›†ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„doneï¼Œå…¶å€¼ä¸ºtrueæ—¶è¡¨ç¤ºæ²¡æœ‰æ›´å¤šå€¼å¯ä¾›ä½¿ç”¨ã€‚è¿­ä»£å™¨æŒæœ‰ä¸€ä¸ªæŒ‡å‘é›†åˆä½ç½®çš„å†…éƒ¨æŒ‡é’ˆï¼Œæ¯å½“è°ƒç”¨äº†next()æ–¹æ³•ï¼Œè¿­ä»£å™¨å°±ä¼šè¿”å›ç›¸åº”çš„ä¸‹ä¸€ä¸ªå€¼ã€‚<br>è‹¥åœ¨æœ€åä¸€ä¸ªå€¼è¿”å›åå†è°ƒç”¨next()ï¼Œæ‰€è¿”å›çš„doneå±æ€§å€¼å›äº‹trueï¼Œå¹¶ä¸”valueå±æ€§å€¼ä¼šæ˜¯è¿­ä»£å™¨è‡ªèº«çš„è¿”å›å€¼(return valueï¼ŒåŠæ—¶ä½¿ç”¨returnè¯­å¥æ˜ç¡®è¿”å›å€¼)ã€‚è¯¥â€œè¿”å›å€¼â€ä¸æ˜¯åŸæ•°æ®é›†çš„ä¸€éƒ¨åˆ†ï¼Œå»ä¼šæˆä¸ºç›¸å…³æ•°æ®çš„æœ€åä¸€ä¸ªç‰‡æ®µï¼Œæˆ–åœ¨è¿­ä»£å™¨æœªæä¾›è¿”å›å€¼æ—¶ä½¿ç”¨undefinedã€‚è¿­ä»£å™¨è‡ªèº«çš„è¿”å›å€¼ç±»ä¼¼äºå‡½æ•°çš„è¿”å›å€¼ï¼Œäº‹é¡¹è°ƒç”¨è€…è¿”å›ä¿¡æ¯çš„æœ€åæ‰‹æ®µã€‚<br>åœ¨ES5ä¸­åºŠåŠ ä¸€ä¸ªè¿­ä»£å™¨ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createIterator</span>(<span class="params">items</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        next: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> done = (i &gt;= items.length)</span><br><span class="line">            <span class="keyword">var</span> value = !done?items[i++] : <span class="literal">undefined</span></span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                done: done,</span><br><span class="line">                valued: value</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> iterator = createIterator([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br></pre></td></tr></table></figure>
<h4 id="ä½•ä¸ºç”Ÿæˆå™¨"><a href="#ä½•ä¸ºç”Ÿæˆå™¨" class="headerlink" title="ä½•ä¸ºç”Ÿæˆå™¨"></a>ä½•ä¸ºç”Ÿæˆå™¨</h4><p><strong>ç”Ÿæˆå™¨ï¼ˆgeneratorï¼‰æ˜¯èƒ½è¿”å›ä¸€ä¸ªè¿­ä»£å™¨çš„å‡½æ•°ã€‚</strong>ç”Ÿæˆå™¨å‡½æ•°ç”±æ”¾åœ¨functionå…³é”®å­—ä¹‹åçš„ä¸€ä¸ªæ˜Ÿå·ï¼ˆ*)æ¥è¡¨ç¤ºï¼Œå¹¶èƒ½ä½¿ç”¨å¿ƒå¾—yieldå…³é”®å­—ã€‚å°†æ˜Ÿå·ç´§è·Ÿåœ¨functionå…³é”®å­—ä¹‹åï¼Œæˆ–æ˜¯åœ¨ä¸­é—´ç•™å‡ºç©ºæ ¼ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç”Ÿæˆå™¨èƒ½æƒ³æ­£è§„å‡½æ•°é‚£æ ·è¢«è°ƒç”¨ï¼Œä½†ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">let</span> iterator = createIterator()</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br></pre></td></tr></table></figure>
<p>createIterator()å‰é¢çš„æ˜Ÿå·è®©æ­¤å‡½æ•°å˜æˆä¸€ä¸ªç”Ÿæˆå™¨ã€‚yieldå…³é”®å­—ä¹Ÿæ˜¯ES6æ–°å¢çš„ã€‚<br>ç”Ÿæˆå™¨å‡½æ•°æœ€æœ‰æ„æ€çš„æ–¹é¢æ˜¯åœ¨æ¯ä¸ªyieldè¯­å¥ååœæ­¢æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œæ­¤ä»£ç ä¸­yield 1æ‰§è¡Œåï¼Œè¯¥å‡½æ•°å°†ä¸ä¼šå†æ‰§è¡Œä»»ä½•æ“ä½œï¼Œç›´åˆ°è¿­ä»£å™¨çš„next()æ–¹æ³•è¢«è°ƒç”¨ï¼Œæ­¤æ—¶æ‰ç»§ç»­æ‰§è¡Œyield 2ã€‚<br>yieldå…³é”®å­—å¯ä»¥å’Œå€¼æˆ–æ˜¯è¡¨è¾¾å¼ä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç”Ÿæˆå™¨ç»™è¿­ä»£å™¨æ·»åŠ é¡¹ç›®ï¼Œè€Œä¸æ˜¯æœºæ¢°åŒ–åœ°è®²é¡¹ç›®ä¸€ä¸ªä¸ªåˆ—å‡ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params">items</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> items[i]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = createIterator([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆå™¨å‡½æ•°æ˜¯ES6çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå¹¶ä¸”å› ä¸ºå®ƒå°±æ˜¯å‡½æ•°ï¼Œå°±èƒ½è¢«ç”¨äºæ‰€æœ‰å¯ä»¥ä½¿ç”¨å‡½æ•°çš„ä½ç½®ã€‚<br>yieldå…³é”®å­—åªèƒ½ç”¨åœ¨ç”Ÿæˆå™¨å†…éƒ¨ï¼Œç”¨äºå…¶ä»–ä»»æ„ä½ç½®éƒ½æ˜¯è¯­æ³•é”™è¯¯ï¼Œå³ä½¿åœ¨ç”Ÿæˆå™¨å†…éƒ¨å‡½æ•°ä¸­ä¹Ÿä¸è¡Œï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params">items</span>) </span>&#123;</span><br><span class="line">    items.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è¯­æ³•é”™è¯¯</span></span><br><span class="line">        <span class="keyword">yield</span> item + i</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°½ç®¡yieldä¸¥æ ¼ä½äºcreateIterator()å†…éƒ¨ï¼Œæ­¤ä»£ç ä»ç„¶æœ‰è¯­æ³•é”™è¯¯ï¼Œå› ä¸ºyieldæ— æ³•ç©¿è¶Šå‡½æ•°è¾¹ç•Œã€‚<strong>ä»è¿™ä¸€ç‚¹æ¥è¯´ï¼Œyieldå’Œreturnéå¸¸ç›¸ä¼¼ï¼Œåœ¨ä¸€ä¸ªè¢«æµ…å¥—çš„å‡½æ•°ä¸­æ— æ³•å°†å€¼è¿”å›ç»™åŒ…å«å®ƒçš„å‡½æ•°ã€‚</strong></p>
<h4 id="ç”Ÿæˆå™¨è¡¨è¾¾å¼"><a href="#ç”Ÿæˆå™¨è¡¨è¾¾å¼" class="headerlink" title="ç”Ÿæˆå™¨è¡¨è¾¾å¼"></a>ç”Ÿæˆå™¨è¡¨è¾¾å¼</h4><p>å¯ä»¥ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼æ¥åˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨ï¼Œåªè¦åœ¨functionå®˜æ¶å­ä¸åœ†æ‹¬å·ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªæ˜Ÿå·ï¼ˆ*ï¼‰å³å¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> createIterator = <span class="function"><span class="keyword">function</span> *(<span class="params">items</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;items.length; i++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> items[i]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> itertor = createIterator([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br></pre></td></tr></table></figure>
<p>æ­¤ä¾‹å­ä¸­ï¼ŒcreateIterator()æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜ã€‚<br>**ä¸èƒ½è®²ç®­å¤´å‡½æ•°åˆ›å»ºä¸ºç”Ÿæˆå™¨ã€‚</p>
<h4 id="ç”Ÿæˆå™¨å¯¹è±¡æ–¹æ³•"><a href="#ç”Ÿæˆå™¨å¯¹è±¡æ–¹æ³•" class="headerlink" title="ç”Ÿæˆå™¨å¯¹è±¡æ–¹æ³•"></a>ç”Ÿæˆå™¨å¯¹è±¡æ–¹æ³•</h4><p>ç”±äºç”Ÿæˆå™¨å°±æ˜¯å‡½æ•°ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¢«æ·»åŠ åˆ°å¯¹è±¡ä¸­ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨ES5é£æ ¼çš„å¯¹è±¡å­—é¢é‡ä¸­ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼æ¥åˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">    createIterator: <span class="function"><span class="keyword">function</span> *(<span class="params">items</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">            <span class="keyword">yield</span> items[i]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> iterator = o.createIterator([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸‹ä¸ºES6ä¸­è¯­æ³•</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">    *createIterator(items) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">            <span class="keyword">yield</span> items[i]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> iterator = o.createIterator([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<h4 id="å¯è¿­ä»£å¯¹è±¡ä¸forå¾ªç¯"><a href="#å¯è¿­ä»£å¯¹è±¡ä¸forå¾ªç¯" class="headerlink" title="å¯è¿­ä»£å¯¹è±¡ä¸forå¾ªç¯"></a>å¯è¿­ä»£å¯¹è±¡ä¸forå¾ªç¯</h4><p>ä¸è¿­ä»£å™¨ç´§å¯†ç›¸å…³çš„æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼ˆiterableï¼‰æ˜¯åŒ…å«Symbol.iteratorå±æ€§çš„å¯¹è±¡ã€‚è¿™ä¸ªSymbol.iteratorçŸ¥åç¬¦å·å®šä¹‰äº†æœªæŒ‡å®šå¯¹è±¡è¿”å›è¿­ä»£å™¨çš„å‡½æ•°ã€‚åœ¨ES6ä¸­ï¼Œæ‰€æœ‰çš„é›†åˆå¯¹è±¡ï¼ˆæ•°ç»„ï¼ŒSetå’ŒMapï¼‰ä¸€å­—ç¬¦ä¸²éƒ½æ˜¯å¯è¿­ä»£å¯¹è±¡ã€‚å› æ­¤ä»–ä»¬éƒ½è¢«æŒ‡å®šäº†é»˜è®¤çš„è¿­ä»£å™¨<br>ä¹‹å‰æåˆ°è¿‡åœ¨forå¾ªç¯ä¸­è¿½è¸ªç´¢å¼•çš„é—®é¢˜ã€‚è¿­ä»£å™¨æ˜¯è§£å†³æ­¤é—®é¢˜çš„ç¬¬ä¸€éƒ¨åˆ†ï¼›for-ofå¾ªç¯åˆ™æ˜¯ç¬¬äºŒéƒ¨åˆ†ï¼šå®ƒå®Œå…¨åˆ é™¤äº†è¿½è¸ªé›†åˆç´¢å¼•çš„éœ€è¦ã€‚ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> num <span class="keyword">of</span> values) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸å¯è¿­ä»£å¯¹è±¡ã€nullã€æˆ–è€…undefinedä¸Šä½¿ç”¨for-ofè¯­å¥ä¼šæŠ›å‡ºé”™è¯¯TypeError: Cannot read property â€˜Symbol(Symbol.iterator)â€™ of nullã€‚</p>
<h4 id="è®¿é—®é»˜è®¤è¿­ä»£å™¨"><a href="#è®¿é—®é»˜è®¤è¿­ä»£å™¨" class="headerlink" title="è®¿é—®é»˜è®¤è¿­ä»£å™¨"></a>è®¿é—®é»˜è®¤è¿­ä»£å™¨</h4><p>å¯ä»¥ä½¿ç”¨Symbol.iteratoræ¥è®¿é—®å¯¹è±¡ä¸Šçš„é»˜è®¤è¿­ä»£å™¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> iterator = values[<span class="built_in">Symbol</span>.iterator]()</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶Symbol.iteratoræŒ‡å®šäº†é»˜è®¤çš„è¿­ä»£å™¨ï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒæ¥æ£€æµ‹ä¸€ä¸ªå¯¹è±¡æ˜¯å¦èƒ½è¿›è¡Œè¿­ä»£ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isIterable</span>(<span class="params">object</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> object[<span class="built_in">Symbol</span>.iterator] === <span class="string">'function'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(isIterable([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]))</span><br><span class="line"><span class="built_in">console</span>.log(isIterable(<span class="string">'hello'</span>))</span><br><span class="line"><span class="built_in">console</span>.log(isIterable(<span class="keyword">new</span> <span class="built_in">Map</span>()))</span><br><span class="line"><span class="built_in">console</span>.log(isIterable(<span class="keyword">new</span> <span class="built_in">Set</span>()))</span><br><span class="line"><span class="built_in">console</span>.log(isIterable(<span class="keyword">new</span> <span class="built_in">WeakMap</span>()))</span><br><span class="line"><span class="built_in">console</span>.log(isIterable(<span class="keyword">new</span> <span class="built_in">WeakSet</span>()))</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå¯è¿­ä»£å¯¹è±¡<br>åˆ©ç”¨Symbol.iteratorå±æ€§ï¼Œ è®©è‡ªå®šä¹‰çš„å¯¹è±¡æˆä¸ºå¯è¿­ä»£å¯¹è±¡ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> collection = &#123;</span><br><span class="line">    items: [],</span><br><span class="line">    *[<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> <span class="keyword">this</span>.items) &#123;</span><br><span class="line">            <span class="keyword">yield</span> item</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">collection.items.push(<span class="number">1</span>)</span><br><span class="line">collection.items.push(<span class="number">2</span>)</span><br><span class="line">collection.items.push(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> collection) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å†…ç½®è¿­ä»£å™¨"><a href="#å†…ç½®è¿­ä»£å™¨" class="headerlink" title="å†…ç½®è¿­ä»£å™¨"></a>å†…ç½®è¿­ä»£å™¨</h4><p>è¿­ä»£å™¨æ˜¯ES6çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œå› æ­¤ï¼Œæ— éœ€ä¸ºè®¸å¤šå†…ç½®ç±»å‹åˆ›å»ºè‡ªå·±çš„è¿­ä»£å™¨ã€‚</p>
<h5 id="é›†åˆçš„è¿­ä»£å™¨"><a href="#é›†åˆçš„è¿­ä»£å™¨" class="headerlink" title="é›†åˆçš„è¿­ä»£å™¨"></a>é›†åˆçš„è¿­ä»£å™¨</h5><p>ES6å…·æœ‰ä¸‰ç§é›†åˆå¯¹è±¡ç±»å‹ï¼šæ•°ç»„ï¼ŒMapä¸Setã€‚è¿™ä¸‰ç§ç±»å‹éƒ½æ‹¥æœ‰å¦‚ä¸‹è¿­ä»£å™¨ï¼Œæœ‰åŠ©äºæ¢ç´¢å®ƒä»¬çš„å†…å®¹ï¼š<br>entries(): è¿”å›ä¸€ä¸ªåŒ…å«é”®å€¼å¯¹çš„è¿­ä»£å™¨ï¼›<br>values(): è¿”å›ä¸€ä¸ªåŒ…å«é›†åˆä¸­çš„å€¼å¾—è¿­ä»£å™¨ï¼›<br>keys(): è¿”å›ä¸€ä¸ªåŒ…å«é›†åˆä¸­çš„é”®çš„è¿­ä»£å™¨</p>
<p>entries()è¿­ä»£å™¨<br>entries()è¿­ä»£å™¨ä¼šåœ¨æ¯æ¬¡next()è¢«è°ƒç”¨æ—¶è¿”å›ä¸€ä¸ªåŒé¡¹æ•°ç»„ï¼Œæ¬¡æ•°ç»„ä»£è¡¨äº†é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„é”®ä¸å€¼ï¼šå¯¹äºæ•°ç»„æ¥è¯´ï¼Œç¬¬ä¸€é¡¹æ˜¯æ•°å€¼ç´¢å¼•ï¼›å¯¹äºSetï¼Œç¬¬ä¸€é¡¹ä¹Ÿæ˜¯å€¼ï¼ˆå› ä¸ºå®ƒçš„å€¼ä¹Ÿä¼šè¢«è§†ä¸ºé”®ï¼‰ï¼›å¯¹äºMapï¼Œç¬¬ä¸€é¡¹å°±æ˜¯é”®ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">let</span> tracking = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">12</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">78</span>])</span><br><span class="line"><span class="keyword">let</span> data = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line"></span><br><span class="line">data.set(<span class="string">'title'</span>, <span class="string">'understanding es6'</span>)</span><br><span class="line">data.set(<span class="string">'format'</span>, <span class="string">'ebook'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> entry <span class="keyword">of</span> colors.entries()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(entry)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> entry <span class="keyword">of</span> tracking.entries()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(entry)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> entry <span class="keyword">of</span> data.entries()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(entry)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨console.log()è¾“å‡ºä¸€ä¸‹å†…å®¹ï¼š<br>[0, â€œredâ€]<br>[1, â€œgreenâ€]<br>[2, â€œblueâ€]<br>[1234, 1234]<br>[5678, 5678]<br>[9012, 9012]<br>[â€œtitleâ€, â€œUnderstanding ES6â€]<br>[â€œformatâ€, â€œebookâ€]<br>values()è¿­ä»£å™¨<br>values()è¿­ä»£å™¨ä»…ä»…èƒ½è¿”å›å­˜å‚¨åœ¨é›†åˆå†…çš„å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">let</span> tracking = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">12</span>, <span class="number">34</span>, <span class="number">56</span>])</span><br><span class="line"><span class="keyword">let</span> data = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line"></span><br><span class="line">data.set(<span class="string">'title'</span>, <span class="string">'understanding es6'</span>)</span><br><span class="line">data.set(<span class="string">'format'</span>, <span class="string">'ebook'</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> colors.values()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> tracking.values()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> data.values()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¸ºï¼š<br>â€œredâ€<br>â€œgreenâ€<br>â€œblueâ€<br>12<br>34<br>56<br>â€œUnderstanding ES6â€<br>â€œebookâ€</p>
<p>keys()è¿­ä»£å™¨<br>keys()è¿­ä»£å™¨èƒ½è¿”å›é›†åˆä¸­çš„æ¯ä¸ªé”®ã€‚å¯¹äºæ•°ç»„æ¥è¯´ï¼Œåªè¿”å›æ•°å€¼ç±»å‹çš„é”®ï¼Œä¸è¿”å›æ•°ç»„çš„å…¶ä»–è‡ªæœ‰å±æ€§ï¼›Setçš„é”®ä¸å€¼æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤å®ƒçš„keys()ä¸values()è¿”å›äº†ç›¸åŒçš„è¿­ä»£å™¨ï¼›å¯¹äºMapï¼Œkeys()è¿­ä»£å™¨è¿”å›äº†æ¯ä¸ªä¸é‡å¤çš„é”®ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">let</span> tracking = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">12</span>, <span class="number">34</span>, <span class="number">56</span>])</span><br><span class="line"><span class="keyword">let</span> data = <span class="keyword">new</span> Mpa()</span><br><span class="line"></span><br><span class="line">data.set(<span class="string">'title'</span>, <span class="string">'understanding es6'</span>)</span><br><span class="line">data.set(<span class="string">'format'</span>, <span class="string">'ebook'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> colors.keys()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> tracking.keys()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> data.keys()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¸ºï¼š<br>0<br>1<br>2<br>12<br>34<br>56<br>â€œtitleâ€<br>â€œformatâ€</p>
<p>é›†åˆç±»å‹çš„é»˜è®¤è¿­ä»£å™¨<br>å½“for-ofå¾ªç¯æ²¡æœ‰æ˜¾ç¤ºæŒ‡å®šè¿­ä»£å™¨æ—¶ï¼Œæ¯ç§é›†åˆç±»å‹éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„è¿­ä»£å™¨ä¾›å¾ªç¯ä½¿ç”¨ã€‚values()æ–¹æ³•æ˜¯æ•°ç»„ä¸Setçš„é»˜è®¤è¿­ä»£å™¨ï¼Œè€Œentries()æ–¹æ³•åˆ™æ˜¯Mapçš„é»˜è®¤è¿­ä»£å™¨ã€‚åœ¨for-ofå¾ªç¯ä¸­ä½¿ç”¨é›†åˆå¯¹è±¡æ—¶ï¼Œè¿™äº›é»˜è®¤è¿­ä»£å™¨ä¼šè®©å¤„ç†æ›´å®¹æ˜“ä¸€äº›ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="keyword">let</span> tracking = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">12</span>, <span class="number">34</span>, <span class="number">56</span>])</span><br><span class="line"><span class="keyword">let</span> data = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line"></span><br><span class="line">data.set(<span class="string">'title'</span>, <span class="string">'understanding es6'</span>)</span><br><span class="line">data.set(<span class="string">'format'</span>, <span class="string">'print'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> colors) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> num <span class="keyword">of</span> tracking) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> entry <span class="keyword">of</span> data) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(entry)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¸ºï¼š<br>â€œredâ€<br>â€œgreenâ€<br>â€œblueâ€<br>1234<br>5678<br>9012<br>[â€œtitleâ€, â€œUnderstanding ES6â€]<br>[â€œformatâ€, â€œprintâ€]</p>
<h4 id="å­—ç¬¦ä¸²çš„è¿­ä»£å™¨"><a href="#å­—ç¬¦ä¸²çš„è¿­ä»£å™¨" class="headerlink" title="å­—ç¬¦ä¸²çš„è¿­ä»£å™¨"></a>å­—ç¬¦ä¸²çš„è¿­ä»£å™¨</h4><p>ä»ES5å‘å¸ƒå¼€å§‹ï¼ŒJSçš„å­—ç¬¦ä¸²å°±æ…¢æ…¢å˜å¾—è¶Šæ¥è¶Šåƒæ•°ç»„ã€‚ä¾‹å¦‚ES5æ ‡å‡†åŒ–äº†å­—ç¬¦ä¸²çš„æ–¹æ‹¬å·è¡¨ç¤ºæ³•ï¼Œç”¨äºè®¿é—®å…¶ä¸­çš„å­—ç¬¦ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> message = <span class="string">'A B'</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;message.length; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(message[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¸ºï¼š<br>A</p>
<p>B</p>
<h4 id="NodeListçš„è¿­ä»£å™¨"><a href="#NodeListçš„è¿­ä»£å™¨" class="headerlink" title="NodeListçš„è¿­ä»£å™¨"></a>NodeListçš„è¿­ä»£å™¨</h4><p>æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰å…·æœ‰ä¸€ç§NodeListç±»å‹ï¼Œç”¨äºè¡¨ç¤ºé¡µé¢æ–‡æ¡£ä¸­å…ƒç´ çš„é›†åˆã€‚å¯¹äºéœ€è¦ä¹¦å†™åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„JSä»£ç çš„å¼€å‘è€…ï¼Œè¦ç†è§£NodeListå¯¹è±¡ä¸æ•°ç»„ä¹‹é—´çš„å·®å¼‚æ€»æ˜¯ç¨æœ‰å›°éš¾ã€‚NodeListå¯¹è±¡ä¸æ•°ç»„éƒ½ä½¿ç”¨äº†lengthå±æ€§æ¥è¡¨æ˜é¡¹çš„æ•°é‡ï¼Œå¹¶ä¸”éƒ½ä½¿ç”¨æ–¹æ‹¬å·è¡¨ç¤ºæ³•æ¥è®¿é—®å„ä¸ªé¡¹ã€‚ç„¶è€Œæœ¬è´¨ä¸Šæ¥è¯´ï¼ŒNodeListä¸æ•°ç»„çš„è¡Œä¸ºæ˜¯å®Œå…¨ä¸åŒçš„ï¼Œè¿™å›å¼•å‘è®¸å¤šæ··ä¹±ã€‚<br>éšç€é»˜è®¤è¿­ä»£å™¨è¢«é™„åŠ åˆ°ES6ï¼ŒDOMå…³äºNodeListçš„è§„å®šä¹ŸåŒ…å«äº†ä¸€ä¸ªé»˜è®¤è¿­ä»£å™¨ï¼ˆæ­¤è§„å®šåœ¨HTMLè§„èŒƒè€ŒéES6è§„èŒƒä¸­ï¼‰ï¼Œå…¶è¡¨ç°æ–¹å¼ä¸æ•°ç»„çš„é»˜è®¤è¿­ä»£å™¨ä¸€è‡´ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥è®²NodeListç”¨äºfor-ofå¾ªç¯ï¼Œæˆ–ç”¨äºå…¶ä»–ä½¿ç”¨å¯¹è±¡é»˜è®¤è¿­ä»£å™¨çš„åœºåˆã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> divs = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'div'</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> div <span class="keyword">of</span> divs) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(div.id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ‰©å±•è¿ç®—ç¬¦ä¸éæ•°ç»„çš„å¯è¿­ä»£å¯¹è±¡"><a href="#æ‰©å±•è¿ç®—ç¬¦ä¸éæ•°ç»„çš„å¯è¿­ä»£å¯¹è±¡" class="headerlink" title="æ‰©å±•è¿ç®—ç¬¦ä¸éæ•°ç»„çš„å¯è¿­ä»£å¯¹è±¡"></a>æ‰©å±•è¿ç®—ç¬¦ä¸éæ•°ç»„çš„å¯è¿­ä»£å¯¹è±¡</h4><p>æ‰©å±•è¿ç®—ç¬¦ï¼ˆâ€¦)èƒ½ä½œç”¨äºæ‰€æœ‰å¯è¿­ä»£å¯¹è±¡ï¼Œå¹¶ä¸”ä¼šä½¿ç”¨é»˜è®¤è¿­ä»£å™¨æ¥åˆ¤æ–­éœ€è¦å“ªäº›å€¼ã€‚<strong>æ‰€æœ‰çš„å€¼éƒ½ä»è¿­ä»£å™¨ä¸­è¢«è¯»å–å‡ºæ¥å¹¶æ’å…¥æ•°ç»„</strong>ï¼Œéµå¾ªè¿­ä»£å™¨è¿”å›å€¼çš„é¡ºåºã€‚(åˆ©ç”¨æ‰©å±•è¿ç®—ç¬¦è¿˜å¯ä»¥è¿›è¡Œæ·±åº¦å¤åˆ¶)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">set</span> = new Set([1, 2, 3, 4])</span><br><span class="line">let array = [...<span class="keyword">set</span>]</span><br><span class="line">console.log(array)</span><br><span class="line">let map = new Map([['name', 'daming'], ['age', 25]])</span><br><span class="line">let array2 = [...map]</span><br><span class="line">console.log(array2)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä¸é™æ¬¡æ•°çš„åœ¨æ•°ç»„å­—é¢é‡ä¸­ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œè€Œä¸”å¯ä»¥åœ¨ä»»æ„ä½ç½®ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å°†å¯è¿­ä»£å¯¹è±¡çš„å¤šä¸ªé¡¹æ’å…¥æ•°ç»„ï¼Œè¿™äº›é¡¹åœ¨æ–°æ•°ç»„ä¸­å°†ä¼šå‡ºç°åœ¨æ‰©å±•è¿ç®—ç¬¦å¯¹åº”çš„ä½ç½®ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> smallNumbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">bigNumbers = [<span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>],</span><br><span class="line">allNumbers = [<span class="number">0</span>, ...smallNumbers, ...bigNumbers]</span><br><span class="line"><span class="built_in">console</span>.log(allNumbers.length)</span><br><span class="line"><span class="built_in">console</span>.log(allNumbers)</span><br></pre></td></tr></table></figure>
<h4 id="è¿­ä»£å™¨çš„é«˜çº§åŠŸèƒ½"><a href="#è¿­ä»£å™¨çš„é«˜çº§åŠŸèƒ½" class="headerlink" title="è¿­ä»£å™¨çš„é«˜çº§åŠŸèƒ½"></a>è¿­ä»£å™¨çš„é«˜çº§åŠŸèƒ½</h4><p>ä½¿ç”¨è¿­ä»£å™¨çš„åŸºæœ¬åŠŸèƒ½ï¼Œå¹¶ä½¿ç”¨ç”Ÿæˆå™¨æ¥æ–¹ä¾¿åœ°åˆ›å»ºè¿­ä»£å™¨ï¼Œå°±å¯ä»¥å®Œæˆå¾ˆå¤šå·¥ä½œäº†ã€‚ç„¶è€Œï¼Œåœ¨å•çº¯è¿­ä»£é›†åˆçš„å€¼ä¹‹å¤–çš„ä»»åŠ¡ä¸­ï¼Œè¿­ä»£å™¨ä¼šæ˜¾å¾—æ›´åŠ å¼ºå¤§ã€‚åœ¨ES6çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè®¸å¤šç‹¬ç‰¹çš„æ€æƒ³ä¸æ¨¡å¼å‡ºç°äº†ï¼Œæ¿€åŠ±ç€è§„å®šè€…å»æ·»åŠ æ›´å¤šçš„åŠŸèƒ½ã€‚</p>
<h4 id="ä¼ é€’å‚æ•°ç»™è¿­ä»£å™¨"><a href="#ä¼ é€’å‚æ•°ç»™è¿­ä»£å™¨" class="headerlink" title="ä¼ é€’å‚æ•°ç»™è¿­ä»£å™¨"></a>ä¼ é€’å‚æ•°ç»™è¿­ä»£å™¨</h4><p>æœ¬ç« ä¸­çš„èŒƒä¾‹å·²ç»å±•ç¤ºäº†è¿­ä»£å™¨èƒ½å¤Ÿå°†å€¼ä¼ é€’å‡ºæ¥ï¼Œé€šè¿‡next()æ–¹æ³•æˆ–è€…åœ¨ç”Ÿæˆå™¨ä¸­ä½¿ç”¨yieldéƒ½å¯ä»¥ã€‚ä½†è¿˜å¯ä»¥é€šè¿‡next()æ–¹æ³•å‘è¿­ä»£å™¨ä¼ é€’å‚æ•°ã€‚å½“ä¸€ä¸ªå‚æ•°è¢«ä¼ é€’ç»™next()æ–¹æ³•æ—¶ï¼Œè¯¥å‚æ•°å°±ä¼šæˆä¸ºç”Ÿæˆå™¨å†…éƒ¨yieldè¯­å¥çš„å€¼ã€‚è¿™ç§èƒ½åŠ›å¯¹äºæ›´å¤šé«˜çº§åŠŸèƒ½ï¼ˆä¾‹å¦‚å¼‚æ­¥ç¼–ç¨‹ï¼‰æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> zero = <span class="number">6</span></span><br><span class="line">    <span class="keyword">let</span> first = <span class="keyword">yield</span> zero + <span class="number">1</span>     <span class="comment">//6 + 1</span></span><br><span class="line">    <span class="keyword">let</span> second = <span class="keyword">yield</span> first + <span class="number">2</span>   <span class="comment">//4 + 2</span></span><br><span class="line">    <span class="built_in">console</span>.log(second)            <span class="comment">//5</span></span><br><span class="line">    <span class="keyword">yield</span> second + <span class="number">3</span>               <span class="comment">//5 + 3</span></span><br><span class="line">    <span class="built_in">console</span>.log(second)            <span class="comment">//5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = createIterator()</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next(<span class="number">8</span>))   <span class="comment">// &#123;value: 1, done: false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next(<span class="number">4</span>))  <span class="comment">//&#123;value: 6, done: false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next(<span class="number">5</span>))  <span class="comment">//&#123;value: 8, done: false&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())   <span class="comment">//&#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure>
<p>å¯¹äºnext()çš„é¦–æ¬¡è°ƒç”¨æ˜¯ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼Œä¼ ç»™å®ƒçš„ä»»æ„å‚æ•°éƒ½ä¼šè¢«å¿½ç•¥ã€‚ç”±äºä¼ é€’ç»™next()çš„å‚æ•°ä¼šæˆä¸ºyieldè¯­å¥çš„å€¼ï¼Œè¯¥yieldè¯­å¥æŒ‡çš„æ˜¯ä¸Šæ¬¡ç”Ÿæˆå™¨ä¸­æ–­æ‰§è¡Œå¤„çš„è¯­å¥ï¼›è€Œnext()æ–¹æ³•ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ç”Ÿæˆå™¨å‡½æ•°æ‰åˆšåˆšå¼€å§‹æ‰§è¡Œï¼Œæ²¡æœ‰æ‰€è°“çš„ä¸Šä¸€æ¬¡ä¸­æ–­å¤„çš„yieldè¯­å¥â€å¯ä¾›èµ‹å€¼ã€‚å› æ­¤åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨next()æ—¶ï¼Œä¸å­˜åœ¨ä»»ä½•å‘å…¶ä¼ é€’å‚æ•°çš„ç†ç”±ã€‚</p>
<h4 id="åœ¨è¿­ä»£å™¨ä¸­æŠ›å‡ºé”™è¯¯"><a href="#åœ¨è¿­ä»£å™¨ä¸­æŠ›å‡ºé”™è¯¯" class="headerlink" title="åœ¨è¿­ä»£å™¨ä¸­æŠ›å‡ºé”™è¯¯"></a>åœ¨è¿­ä»£å™¨ä¸­æŠ›å‡ºé”™è¯¯</h4><p>èƒ½ä¼ é€’ç»™è¿­ä»£å™¨çš„ä¸ä»…æ˜¯æ•°æ®ï¼Œè¿˜å¯ä»¥æ˜¯é”™è¯¯æ¡ä»¶ã€‚è¿­ä»£å™¨å¯ä»¥é€‰æ‹©å®ç°ä¸€ä¸ªthrow()æ–¹æ³•ï¼Œç”¨äºæŒ‡ç¤ºè¿­ä»£å™¨åº”åœ¨æ¢å¤æ‰§è¡Œæ—¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚è¿™æ˜¯å¯¹å¼‚æ­¥å˜æˆæ¥è¯´å¾ˆé‡è¦çš„ä¸€ä¸ªèƒ½åŠ›ã€‚åŒäº‹ä¹Ÿä¼šå¢åŠ ç”Ÿæˆå™¨å†…éƒ¨çš„çµæ´»åº¦ï¼Œèƒ½å¤Ÿæ—¢æ¨¡ä»¿è¿”å›ä¸€ä¸ªå€¼ï¼Œåˆæ¨¡ä»¿æŠ›å‡ºé”™è¯¯ï¼ˆä¹Ÿå°±æ˜¯é€€å‡ºå‡½æ•°çš„ä¸¤ç§æ–¹å¼ï¼‰ã€‚å¯ä»¥ä¼ é€’ä¸€ä¸ªé”™è¯¯å¯¹è±¡ç»™throw()æ–¹æ³•ï¼Œå½“è¿­ä»£å™¨ç»§ç»­è¿›è¡Œå¤„ç†æ—¶åº”å½“æŠ›å‡ºæ­¤é”™è¯¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> first = <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> second = <span class="keyword">yield</span> first + <span class="number">2</span></span><br><span class="line">    <span class="keyword">yield</span> second + <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = createIterator()</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())</span><br><span class="line"><span class="built_in">console</span>.log(iterator.throw(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Boom'</span>)))</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š<br>{ value: 1, done: false }<br>{ value: 6, done: false }<br>C:\Users\Administrator\Desktop\atHome.js:116<br>    let second = yield first + 2<br>                 ^<br>Error: Boom<br>    at Object.<anonymous> (C:\Users\Administrator\Desktop\atHome.js:124:28)<br>    at Module._compile (module.js:569:30)<br>    at Object.Module._extensions..js (module.js:580:10)<br>    at Module.load (module.js:503:32)<br>    at tryModuleLoad (module.js:466:12)<br>    at Function.Module._load (module.js:458:3)<br>    at Function.Module.runMain (module.js:605:10)<br>    at startup (bootstrap_node.js:158:16)<br>    at bootstrap_node.js:575:3<br>[Finished in 0.4s]<br>åˆ©ç”¨è¿™äº›ï¼Œå¯ä»¥åœ¨ç”Ÿæˆå™¨å†…éƒ¨ä½¿ç”¨ä¸€ä¸ªtry-catchå—æ¥æ•æ‰è¿™ç§é”™è¯¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> first = <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> second</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        second = <span class="keyword">yield</span> first + <span class="number">2</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (ex) &#123;</span><br><span class="line">        second = <span class="number">6</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">yield</span> second + <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iterator = createIterator();</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()); <span class="comment">// "&#123; value: 1, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next(<span class="number">4</span>)); <span class="comment">// "&#123; value: 6, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.throw(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Boom"</span>))); <span class="comment">// "&#123; value: 9, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()); <span class="comment">// "&#123; value: undefined, done: true &#125;"</span></span><br></pre></td></tr></table></figure>

<h4 id="ç”Ÿæˆå™¨çš„returnè¯­å¥"><a href="#ç”Ÿæˆå™¨çš„returnè¯­å¥" class="headerlink" title="ç”Ÿæˆå™¨çš„returnè¯­å¥"></a>ç”Ÿæˆå™¨çš„returnè¯­å¥</h4><p>ç”±äºç”Ÿæˆå™¨æ˜¯å‡½æ•°ï¼Œå¯ä»¥åœ¨å†…éƒ¨ä½¿ç”¨returnè¯­å¥ï¼Œæ—¢å¯ä»¥è®©ç”Ÿæˆå™¨æ—©ä¸€ç‚¹é€€å‡ºæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æŒ‡å®šåœ¨next()çš„æœ€åä¸€æ¬¡è°ƒç”¨æ—¶çš„è¿”å›å€¼ã€‚ä¹‹å‰å¤§å¤šæ•°ä¾‹å­ä¸­ï¼Œå¯¹è¿­ä»£å™¨ä¸Šçš„nextçš„æœ€åä¸€æ¬¡è°ƒç”¨éƒ½è¿”å›äº†undefinedï¼Œä½†è¿˜å¯ä»¥åƒå…¶ä»–å‡½æ•°ä¸­é‚£æ ·ï¼Œä½¿ç”¨returnæ¥æŒ‡å®šå¦ä¸€ä¸ªè¿”å›å€¼ã€‚ç”Ÿæˆå™¨å†…ï¼Œreturnè¡¨æ˜æ‰€æœ‰çš„å¤„ç†å·²ç»å®Œæˆï¼Œå› æ­¤doneå±æ€§ä¼šè¢«è®¾å®šä¸ºtrueï¼Œè€Œå¦‚æœæä¾›äº†è¿”å›å€¼ï¼Œå°±ä¼šè¢«ç”¨äºvalueå­—æ®µã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> iterator = createIterator()</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())    <span class="comment">// "&#123; value: 1, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())    <span class="comment">// "&#123; value: undefined, done: true &#125;"</span></span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªè¿”å›å€¼ï¼Œä¼šè¢«ç”¨äºæœ€ç»ˆè¿”å›çš„ç»“æœå¯¹è±¡ä¸­çš„valueå­—æ®µã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">42</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> iterator = createIterator()</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())      <span class="comment">// "&#123; value: 1, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())      <span class="comment">// "&#123; value: 42, done: true &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())      <span class="comment">// "&#123; value: undefined, done: true &#125;"</span></span><br></pre></td></tr></table></figure>

<h4 id="ç”Ÿæˆå™¨å§”æ‰˜"><a href="#ç”Ÿæˆå™¨å§”æ‰˜" class="headerlink" title="ç”Ÿæˆå™¨å§”æ‰˜"></a>ç”Ÿæˆå™¨å§”æ‰˜</h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå°†ä¸¤ä¸ªè¿­ä»£å™¨çš„å€¼åˆå¹¶å™¨ä¸€èµ·ä¼šæ›´æœ‰ç”¨ã€‚<strong>ç”Ÿæˆå™¨å¯ä»¥ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰é…åˆyieldè¿™ä¸€ç‰¹æ®Šå½¢å¼æ¥å§”æ‰˜å…¶ä»–çš„è¿­ä»£å™¨ã€‚</strong>æ­£å¦‚ç”Ÿæˆå™¨çš„å®šä¹‰ï¼Œæ˜Ÿå·å‡ºç°åœ¨ä½•å¤„æ˜¯ä¸é‡è¦çš„ï¼Œåªè¦è½åœ¨yieldå…³é”®å­—ä¸ç”Ÿæˆå™¨å‡½æ•°åä¹‹é—´å³å¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createNuberIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createColorIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'red'</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'green'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createCombinedIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> *createNumberIterator()</span><br><span class="line">    <span class="keyword">yield</span> *createColorIterator()</span><br><span class="line">    <span class="keyword">yield</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iterator = createCombinedIterator()</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())   <span class="comment">// "&#123; value: 1, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())   <span class="comment">// "&#123; value: 2, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())   <span class="comment">// "&#123; value: "red", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())   <span class="comment">// "&#123; value: "green", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())   <span class="comment">// "&#123; value: true, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next())   <span class="comment">// "&#123; value: undefined, done: true &#125;"</span></span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆå™¨å§”æ‰˜ä¹Ÿèƒ½è®©ä½ è¿›ä¸€æ­¥ä½¿ç”¨ç”Ÿæˆå™¨çš„è¿”å›å€¼ã€‚è¿™æ˜¯è®¿é—®è¿™äº›è¿”å›å€¼çš„æœ€ç®€å•æ–¹å¼ï¼Œå¹¶ä¸”<br>åœ¨æ‰§è¡Œå¤æ‚ä»»åŠ¡æ—¶ä¼šéå¸¸æœ‰ç”¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createNumberIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createRepeatingIterator</span>(<span class="params">count</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"repeat"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createCombinedIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">yield</span> *createNumberIterator()</span><br><span class="line">    <span class="keyword">yield</span> *createRepeatingIterator(result)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> iterator = createCombinedIterator();</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: 1, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: 2, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: "repeat", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: "repeat", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: "repeat", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: undefined, done: true &#125;"</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„å€¼ 3 ä»æœªåœ¨å¯¹äº next() æ–¹æ³•çš„ä»»ä½•è°ƒç”¨ä¸­è¢«è¾“å‡ºã€‚å½“å‰å®ƒä»…ä»…å­˜åœ¨äº<br>createCombinedIterator() ç”Ÿæˆå™¨å†…éƒ¨ã€‚ä½†ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ å¦ä¸€ä¸ª yield è¯­å¥æ¥è¾“å‡ºè¿™ä¸ª<br>å€¼ï¼Œæ­£å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createNumberIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createRepeatingIterator</span>(<span class="params">count</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"repeat"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">createCombinedIterator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">yield</span> *createNumberIterator()</span><br><span class="line">    <span class="keyword">yield</span> result</span><br><span class="line">    <span class="keyword">yield</span> *createRepeatingIterator(result)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> iterator = createCombinedIterator()</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: 1, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: 2, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: 3, done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: "repeat", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: "repeat", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: "repeat", done: false &#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(iterator.next()) <span class="comment">// "&#123; value: undefined, done: true &#125;"</span></span><br></pre></td></tr></table></figure>

<h4 id="å¼‚æ­¥ä»»åŠ¡è¿è¡Œ"><a href="#å¼‚æ­¥ä»»åŠ¡è¿è¡Œ" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡è¿è¡Œ"></a>å¼‚æ­¥ä»»åŠ¡è¿è¡Œ</h4><p>JSçš„å¼‚æ­¥ç¼–ç¨‹æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼šç®€å•ä»»åŠ¡å¾ˆå®¹æ˜“ç”¨å¼‚æ­¥å®ç°ï¼Œä½†å¤æ‚ä»»åŠ¡å°±ä¼šå˜æˆä»£ç ç»„ç»‡æ–¹é¢çš„è‹¦å·®äº‹ã€‚ç”±äºç”Ÿæˆå™¨èƒ½è®©ä½ åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆçš„æš‚åœä»£ç æ“ä½œï¼Œå®ƒå°±å¼€å¯äº†ä¸å¼‚æ­¥ç¼–ç¨‹ç›¸å…³çš„è®¸å¤šå¯èƒ½æ€§ã€‚<br>æ‰§è¡Œä¸€æ­¥æ“ä½œçš„ä¼ ç»Ÿé“œæ–¹å¼æ˜¯è°ƒç”¨ä¸€ä¸ªåŒ…å«å›è°ƒçš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.readFile(<span class="string">'config.json'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">error, contents</span>)) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    doSomethingWith(contents)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Done'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>èƒ½ä½¿ç”¨æ–‡ä»¶åä¸ä¸€ä¸ªå›è°ƒå‡½æ•°å»è°ƒç”¨fs.readFile()æ–¹æ³•ï¼Œåœ¨è¯»å–æ“ä½œç»“æŸä¹‹åï¼Œå›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚æ­¤å›è°ƒå‡½æ•°æŸ¥çœ‹æ˜¯å¦å­˜åœ¨é”™è¯¯ï¼Œè‹¥å¦åˆ™å¤„ç†è¿”å›çš„contentsæ•°æ®ã€‚å½“æ‹¥æœ‰æ•°é‡å°‘è€Œæœ‰é™çš„ä»»åŠ¡éœ€è¦å®Œæˆæ—¶ï¼Œè¿™ä¹ˆåšå¾ˆæœ‰æ•ˆï¼›ç„¶è€Œå½“éœ€è¦åµŒå¥—å›è°ƒå‡½æ•°ï¼Œæˆ–è€…è¦æŒ‰é¡ºåºå¤„ç†ä¸€ç³»åˆ—å¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œæ­¤æ–¹å¼å°±ä¼šéå¸¸éº»çƒ¦äº†ã€‚è¿™ç§åœºåˆä¸‹ç”Ÿæˆå™¨ä¸yieldä¼šå¾ˆæœ‰ç”¨ã€‚</p>
<h4 id="ä¸€ä¸ªç®€å•çš„ä»»åŠ¡è¿è¡Œå™¨"><a href="#ä¸€ä¸ªç®€å•çš„ä»»åŠ¡è¿è¡Œå™¨" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä»»åŠ¡è¿è¡Œå™¨"></a>ä¸€ä¸ªç®€å•çš„ä»»åŠ¡è¿è¡Œå™¨</h4><p>ç”±äºyieldèƒ½åœæ­¢è¿è¡Œï¼Œå¹¶ä¸”åœ¨é‡æ–°å¼€å§‹è¿è¡Œå‰ç­‰å¾…next()æ–¹æ³•è¢«è°ƒç”¨ï¼Œå°±å¯ä»¥åœ¨æ²¡æœ‰å›è°ƒå‡½æ•°çš„æƒ…å†µä¸‹å®ç°å¼‚æ­¥è°ƒç”¨ã€‚é¦–å…ˆï¼Œéœ€è¦ä¸€ä¸ªèƒ½å¤Ÿè°ƒç”¨ç”Ÿæˆå™¨å¹¶ä¸”å¯ç”¨è¿­ä»£å™¨çš„å‡½æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">taskDef</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¿­ä»£å™¨ï¼Œè®©å®ƒåœ¨åˆ«å¤„å¯ç”¨</span></span><br><span class="line">    <span class="keyword">let</span> task = taskDef()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯åŠ¨ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">let</span> result = task.next()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€’å½’ä½¿ç”¨å‡½æ•°æ¥ä¿æŒå¯¹next()çš„è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!result.done) &#123;</span><br><span class="line">            result = task.next()</span><br><span class="line">            setp()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// step()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>run()å‡½æ•°æ¥å—ä¸€ä¸ªä»»åŠ¡å®šä¹‰ï¼ˆå³ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼‰ä½œä¸ºå‚æ•°ï¼Œå®ƒä¼šè°ƒç”¨ç”Ÿæˆå™¨æ¥åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¹¶å°†è¿­ä»£å™¨æ”¾åœ¨taskå˜é‡ä¸Šã€‚taskå˜é‡æ”¾åœ¨å‡½æ•°çš„å¤–å±‚ï¼Œå› æ­¤å®ƒå¯ä»¥è¢«å‡½æ•°å†…çš„å…¶ä»–å‡½æ•°è®¿é—®åˆ°ã€‚ç¬¬ä¸€æ¬¡å¯¹next()çš„è°ƒç”¨å¯åŠ¨äº†è¿­ä»£å™¨ï¼Œç»“æœå­˜å‚¨ä¸‹ä»¥ä¾¿ç¨åä½¿ç”¨ã€‚step()å‡½æ•°æŸ¥çœ‹result.doneæ˜¯å¦ä¸ºfalseï¼Œå¦‚æœæ˜¯å°±åœ¨é€’å½’è°ƒç”¨è‡ªèº«ä¹‹å‰è°ƒç”¨next()æ–¹æ³•ã€‚æ¯æ¬¡è°ƒç”¨next()éƒ½ä¼šæŠŠè¿”å›çš„ç»“æœä¿å­˜åœ¨resultå˜é‡ä¸Šï¼Œå®ƒæ€»æ˜¯ä¼šè¢«æœ€æ–°çš„ä¿¡æ¯æ‰€é‡å†™ã€‚å¯¹äºstep()çš„å‡ºäº‹è°ƒç”¨å¯åŠ¨äº†å¤„ç†è¿‡ç¨‹å°±ï¼Œè¯¥è¿‡ç¨‹ä¼šæŸ¥çœ‹result.doneæ¥åˆ¤æ–­æ˜¯å¦è¿˜æœ‰æ›´å¤šè¦åšçš„å·¥ä½œã€‚</p>
<p>é…åˆè¿™ä¸ªå·²å®ç°çš„ run() å‡½æ•°ï¼Œä½ å°±å¯ä»¥è¿è¡Œä¸€ä¸ªåŒ…å«å¤šæ¡ yield è¯­å¥çš„ç”Ÿæˆå™¨ï¼Œå°±åƒè¿™<br>æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">run(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤ä¾‹åªæ˜¯å°†ä¸‰ä¸ªæ•°å€¼è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œå•çº¯ç”¨äºè¡¨æ˜å¯¹ next() çš„æ‰€æœ‰è°ƒç”¨éƒ½å·²è¢«æ‰§è¡Œã€‚ç„¶<br>è€Œï¼Œä»…ä»…ä½¿ç”¨å‡ æ¬¡ yield å¹¶ä¸å¤ªæœ‰æ„ä¹‰ï¼Œä¸‹ä¸€æ­¥æ˜¯è¦æŠŠå€¼ä¼ è¿›è¿­ä»£å™¨å¹¶è·å–è¿”å›æ•°æ®ã€‚</p>
<h4 id="å¸¦æ•°æ®çš„ä»»åŠ¡è¿è¡Œ"><a href="#å¸¦æ•°æ®çš„ä»»åŠ¡è¿è¡Œ" class="headerlink" title="å¸¦æ•°æ®çš„ä»»åŠ¡è¿è¡Œ"></a>å¸¦æ•°æ®çš„ä»»åŠ¡è¿è¡Œ</h4><p>ä¼ é€’æ•°æ®ç»™ä»»åŠ¡è¿è¡Œå™¨æœ€ç®€å•çš„æ–¹å¼ï¼Œå°±æ˜¯æŠŠyieldè¿”å›çš„å€¼ä¼ å…¥ä¸‹ä¸€æ¬¡çš„next()è°ƒç”¨ã€‚ä¸ºæ­¤ï¼Œä»…éœ€ä¼ é€’result.value,æ­£å¦‚ä¸€ä¸‹ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">taskDef</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> task = taskDef()</span><br><span class="line">    <span class="keyword">let</span> result = task.next()</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!result.done) &#123;</span><br><span class="line">            result = task.next(result.value)</span><br><span class="line">            step()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    step()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ result.value ä½œä¸ºå‚æ•°è¢«ä¼ é€’ç»™äº† next() ï¼Œè¿™æ ·å°±èƒ½åœ¨ yield è°ƒç”¨ä¹‹é—´ä¼ é€’æ•°æ®<br>äº†ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">run(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(value); <span class="comment">// 1</span></span><br><span class="line">    value = <span class="keyword">yield</span> value + <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(value); <span class="comment">// 4</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="å¼‚æ­¥ä»»åŠ¡è¿è¡Œå™¨"><a href="#å¼‚æ­¥ä»»åŠ¡è¿è¡Œå™¨" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡è¿è¡Œå™¨"></a>å¼‚æ­¥ä»»åŠ¡è¿è¡Œå™¨</h4><p>ä¸Šä¸ªä¾‹å­åªæ˜¯åœ¨yieldä¹‹é—´æ¥å›ä¼ é€’é™æ€æ•°æ®ï¼Œä½†ç­‰å¾…ä¸€ä¸ªå¼‚æ­¥å¤„ç†ä¸æ­¤ç¨å¾®æœ‰ç‚¹å·®å¼‚ã€‚ä»»åŠ¡è¿è¡Œå™¨éœ€è¦äº†è§£å›è°ƒå‡½æ•°ï¼Œå¹¶äº†è§£å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚å¹¶ä¸”ç”±äºyieldè¡¨è¾¾å¼å°†å®ƒä»¬çš„å€¼ä¼ é€’ç»™äº†ä»»åŠ¡è¿è¡Œå™¨ï¼Œè¿™å°±æ„å‘³ç€å‡½æ•°è°ƒç”¨éƒ½å¿…é¡»è¿”å›ä¸€ä¸ªå€¼ï¼Œå¹¶ä»¥æŸç§æ–¹å¼æ ‡æ˜æ”¹è¿”å›å€¼æ˜¯ä¸ªå¼‚æ­¥æ“ä½œè°ƒç”¨ï¼ŒäºŒäººèˆè¿è¡Œå™¨åº”å½“ç­‰å¾…æ­¤æ“ä½œã€‚<br>æ­¤å¤„æ˜¯å°†è¿”å›å€¼æ ‡æ˜ä¸ºå¼‚æ­¥æ“ä½œçš„ä¸€ç§æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchData</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">        callback(<span class="literal">null</span>, <span class="string">'hi'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™éƒ¨åˆ†ä»£ç çš„ç›®çš„æ˜¯ï¼šä»»ä½•æ‰“ç®—è®©äººç‰©è¿è¡Œå™¨è°ƒç”¨çš„å‡½æ•°ï¼Œéƒ½åº”å½“è¿”å›ä¸€ä¸ªèƒ½å¤Ÿæ‰§è¡Œå›è°ƒå‡½æ•°çš„å‡½æ•°ã€‚fetchData()å‡½æ•°æ‰€è¿”å›çš„å‡½æ•°èƒ½æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå…¶å‚æ•°ï¼Œå½“è¿”å›çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œå›è°ƒå‡½æ•°å¹¶é™„åŠ ä¸€ç‚¹é¢å¤–æ•°æ®ï¼ˆå³â€œhiâ€å­—ç¬¦ä¸²ï¼‰ã€‚è¯¥å›è°ƒå‡½æ•°éœ€è¦ç”±ä»»åŠ¡è¿è¡Œå™¨æä¾›ï¼Œä»¥ç¡®ä¿å›è°ƒå‡½æ•°èƒ½ä¸å½“å‰çš„è¿­ä»£å…¶æ­£ç¡®äº¤äº’ã€‚è™½ç„¶fetchData()å‡½æ•°æ˜¯åŒæ­¥çš„ï¼Œä½†èƒ½å»¶è¿Ÿå¯¹å›è°ƒå‡½æ•°çš„è°ƒç”¨ï¼Œä»è€Œè½»æ˜“åœ°å°†å®ƒæ”¹é€ ä¸ºå¼‚æ­¥å‡½æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchData</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            callback(<span class="literal">null</span>, <span class="string">'hi'</span>)</span><br><span class="line">        &#125;, <span class="number">50</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤ç‰ˆæœ¬çš„fetchData()å†è°ƒç”¨å›è°ƒå‡½æ•°ä¹‹å‰å¼•å…¥äº†50æ¯«ç§’çš„å»¶è¿Ÿï¼Œè¯´æ˜æ­¤æ¨¡å¼åœ¨åŒæ­¥æˆ–ä¸€éƒ¨ä»£ç ä¸Šéƒ½èƒ½è‰¯å¥½è¿ä½œã€‚<strong>åªè¦ä¿è¯æ¯ä¸ªéœ€è¦è¢«yieldè°ƒç”¨çš„å‡½æ•°éƒ½éµå¾ªæ­¤æ¨¡å¼ã€‚</strong><br>æ­¤ç‰ˆæœ¬çš„ fetchData() åœ¨è°ƒç”¨å›è°ƒå‡½æ•°ä¹‹å‰å¼•å…¥äº† 50 æ¯«ç§’çš„å»¶è¿Ÿï¼Œè¯´æ˜æ­¤æ¨¡å¼åœ¨åŒæ­¥æˆ–å¼‚<br>æ­¥ä»£ç ä¸Šéƒ½èƒ½åŒæ ·è‰¯å¥½è¿ä½œã€‚ä½ åªè¦ä¿è¯æ¯ä¸ªéœ€è¦è¢« yield è°ƒç”¨çš„å‡½æ•°éƒ½éµå¾ªæ­¤æ¨¡å¼ã€‚<br>åœ¨æ·±å…¥ç†è§£å‡½æ•°å¦‚ä½•æ ‡æ³¨è‡ªå·±æ˜¯ä¸€ä¸ªå¼‚æ­¥å¤„ç†åï¼Œä½ å°±å¯ä»¥ç»“åˆè¿™ç§æ¨¡å¼æ¥æ”¹é€ ä»»åŠ¡è¿è¡Œ<br>å™¨ã€‚åªè¦ result.value æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»»åŠ¡è¿è¡Œå™¨å°±åº”å½“æ‰§è¡Œå®ƒï¼Œè€Œä¸æ˜¯ä»…ä»…å°†å®ƒä¼ é€’ç»™<br>next() æ–¹æ³•ã€‚æ­¤å¤„æœ‰æ›´æ–°åçš„ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">taskDef</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> task = taskDef()</span><br><span class="line">    <span class="keyword">let</span> result = task.next()</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!result.done) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> result.value === <span class="string">'function'</span>) &#123;</span><br><span class="line">                result.value(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                        result = task.throw(err)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    result = task.next(data)</span><br><span class="line">                    step()</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result = task.next(result.value)</span><br><span class="line">                step()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    step()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“ result.value æ˜¯ä¸ªå‡½æ•°æ—¶ï¼ˆä½¿ç”¨ === è¿ç®—ç¬¦æ¥åˆ¤æ–­ï¼‰ï¼Œå®ƒä¼šè¢«ä½¿ç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°è¿›è¡Œè°ƒ<br>ç”¨ã€‚è¯¥å›è°ƒå‡½æ•°éµå¾ªäº† Node.js çš„æƒ¯ä¾‹ï¼Œå°†ä»»ä½•æ½œåœ¨é”™è¯¯ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆ err ï¼‰ä¼ å…¥ï¼Œè€Œ<br>å¤„ç†ç»“æœåˆ™ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚è‹¥ err éç©ºï¼Œä¹Ÿå°±è¡¨ç¤ºæœ‰é”™è¯¯å‘ç”Ÿï¼Œéœ€è¦ä½¿ç”¨è¯¥é”™è¯¯å¯¹è±¡å»è°ƒ<br>ç”¨ task.throw() ï¼Œè€Œä¸æ˜¯è°ƒç”¨ task.next() ï¼Œè¿™æ ·é”™è¯¯å°±ä¼šåœ¨æ°å½“çš„ä½ç½®è¢«æŠ›å‡ºï¼›è‹¥ä¸å­˜<br>åœ¨é”™è¯¯ï¼Œ data å‚æ•°å°†ä¼šè¢«ä¼ å…¥ task.next() ï¼Œè€Œå…¶è°ƒç”¨ç»“æœä¹Ÿä¼šè¢«ä¿å­˜ä¸‹æ¥ã€‚æ¥ä¸‹æ¥ï¼Œè°ƒ<br>ç”¨ step() æ¥ç»§ç»­å¤„ç†è¿‡ç¨‹ã€‚è‹¥ result.value å¹¶éå‡½æ•°ï¼Œå®ƒå°±ä¼šè¢«ç›´æ¥ä¼ é€’ç»™ next() æ–¹<br>æ³•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">filename</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">        fs.readFile(filename, callback)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª readFile() æ–¹æ³•æ¥å—å•ä¸ªå‚æ•°ï¼Œå³æ–‡ä»¶åï¼Œå¹¶è¿”å›ä¸€ä¸ªèƒ½æ‰§è¡Œå›è°ƒå‡½æ•°çš„å‡½æ•°ã€‚æ­¤å›<br>è°ƒå‡½æ•°ä¼šè¢«ç›´æ¥ä¼ é€’ç»™ fs.readFile() æ–¹æ³•ï¼Œåè€…ä¼šåœ¨æ“ä½œå®Œæˆåæ‰§è¡Œå›è°ƒã€‚æ¥ä¸‹æ¥ä½ å°±å¯<br>ä»¥ä½¿ç”¨ yield æ¥è¿è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">run(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> contents = <span class="keyword">yield</span> readFile(<span class="string">"config.json"</span>)</span><br><span class="line">    doSomethingWith(contents)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Done"</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%B0%84%E6%8E%A5%E5%8F%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%B0%84%E6%8E%A5%E5%8F%A3/" class="post-title-link" itemprop="url">ä»£ç†å’Œåå°„æ¥å£</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 10:04:36 / Modified: 11:26:55" itemprop="dateCreated datePublished" datetime="2020-04-26T10:04:36+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ES5å’ŒES6éƒ½æ¨è¿›äº†JSåŠŸèƒ½çš„å…¬å¼€ã€‚ä¾‹å¦‚ï¼ŒJSè¿è¡Œç¯å¢ƒåŒ…å«ä¸€äº›ä¸å¯æšä¸¾ã€ä¸å¯å†™å…¥çš„å¯¹è±¡å±æ€§ã€‚ES5å¼•å…¥äº†Object.defineProperty()æ–¹æ³•ä»¥ä¾¿å¼€å‘è€…åœ¨è¿™æ–¹é¢èƒ½å¤ŸåƒJSå¼•æ“é‚£æ ·åšã€‚<br>SE6è®©å¼€å‘è€…èƒ½è¿›ä¸€æ­¥æ¥è¿‘JSå¼•æ“çš„èƒ½åŠ›ï¼Œè¿™äº›èƒ½åŠ›åŸå…ˆåªå­˜åœ¨äºå†…ç½®å¯¹è±¡ä¸Šã€‚è¯­è¨€é€šè¿‡ä»£ç†ï¼ˆproxyï¼‰æš´éœ²åœ¨å¯¹è±¡ä¸Šçš„å†…éƒ¨å·¥ä½œï¼Œä»£ç†æ˜¯ä¸€ç§å°è£…ï¼Œèƒ½å¤Ÿæ‹¦æˆªå¹¶æ”¹å˜JSå¼•æ“çš„åº•å±‚æ“ä½œã€‚</p>
<h2 id="æ•°ç»„é—®é¢˜"><a href="#æ•°ç»„é—®é¢˜" class="headerlink" title="æ•°ç»„é—®é¢˜"></a>æ•°ç»„é—®é¢˜</h2><p>åœ¨ES6ä¹‹å‰ï¼ŒJSçš„æ•°ç»„å¯¹è±¡æ‹¥æœ‰ç‰¹å®šçš„è¡Œä¸ºæ–¹å¼ï¼Œæ— æ³•è¢«å¼€å‘è€…åœ¨è‡ªå®šä¹‰å¯¹è±¡ä¸­è¿›è¡Œæ¨¡æ‹Ÿã€‚å½“ä½ ç»™æ•°ç»„å…ƒç´ èµ‹å€¼æ—¶ï¼Œæ•°ç»„çš„lengthå±æ€§ä¼šå—åˆ°å½±å“ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹lengthå±æ€§æ¥å˜æ›´æ•°ç»„çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]</span><br><span class="line"><span class="built_in">console</span>.log(colors.length)       <span class="comment">//3</span></span><br><span class="line">colors[<span class="number">3</span>] = <span class="string">'black'</span></span><br><span class="line"><span class="built_in">console</span>.log(colors.length)       <span class="comment">//4</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">3</span>])           <span class="comment">//black</span></span><br><span class="line">colors.length = <span class="number">2</span></span><br><span class="line"><span class="built_in">console</span>.log(colors.length)       <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">3</span>])           <span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">2</span>])           <span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">1</span>])           <span class="comment">//green</span></span><br></pre></td></tr></table></figure>
<h2 id="ä»£ç†ä¸åå°„æ˜¯ä»€ä¹ˆ"><a href="#ä»£ç†ä¸åå°„æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä»£ç†ä¸åå°„æ˜¯ä»€ä¹ˆ"></a>ä»£ç†ä¸åå°„æ˜¯ä»€ä¹ˆ</h2><p>é€šè¿‡è°ƒç”¨new Proxy()ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªä»£ç†ç”¨æ¥æ›¿ä»£å¦ä¸€ä¸ªå¯¹è±¡ï¼ˆè¢«ç§°ä¸ºç›®æ ‡ï¼‰ï¼Œè¿™ä¸ªä»£ç†å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œäº†è™šæ‹Ÿï¼Œå› æ­¤è¯¥ä»£ç†ä¸è¯¥ç›®æ ‡å¯¹è±¡è¡¨é¢ä¸Šå¯ä»¥è¢«å½“ä½œåŒä¸€ä¸ªå¯¹è±¡æ¥å¯¹å¾…ã€‚<br>ä»£ç†å…è®¸æ‹¦æˆªåœ¨ç›®æ ‡å¯¹è±¡ä¸Šçš„åº•å±‚æ“ä½œã€‚æ‹¦æˆªè¡Œä¸ºä½¿ç”¨äº†ä¸€ä¸ªèƒ½å¤Ÿå“åº”ç‰¹å®šæ“ä½œçš„å‡½æ•°ï¼ˆè¢«ç§°ä¸ºé™·é˜±ï¼‰ã€‚<br>è¢«Reflectå¯¹è±¡æ‰€ä»£è¡¨çš„åå°„æ¥å£ï¼Œæ˜¯ç»™åº•å±‚æ“ä½œæä¾›é»˜è®¤è¡Œä¸ºçš„æ–¹æ³•çš„é›†åˆï¼Œè¿™äº›æ“ä½œæ˜¯èƒ½å¤Ÿè¢«ä»£ç†é‡å†™çš„ã€‚æ¯ä¸ªä»£ç†é™·é˜±éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„åå°„æ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½ä¸å¯¹åº”çš„é™·é˜±å‡½æ•°é‡åï¼Œå¹¶ä¸”æ¥å—çš„å‚æ•°ä¹Ÿä¸ä¹‹ä¸€è‡´ã€‚ä¸‹è¡¨æ€»ç»“äº†è¿™äº›è¡Œä¸ºï¼š<br>æ¯ä¸ªé™·é˜±å‡½æ•°éƒ½å¯ä»¥é‡å†™ JS å¯¹è±¡çš„ä¸€ä¸ªç‰¹å®šå†…ç½®è¡Œä¸ºï¼Œå…è®¸ä½ æ‹¦æˆªå¹¶ä¿®æ”¹å®ƒã€‚å¦‚æœä½ ä»ç„¶éœ€è¦ä½¿ç”¨åŸå…ˆçš„å†…ç½®è¡Œä¸ºï¼Œåˆ™å¯ä½¿ç”¨å¯¹åº”çš„åå°„æ¥å£æ–¹æ³•ã€‚ä¸€æ—¦åˆ›å»ºäº†ä»£ç†ï¼Œä½ å°±èƒ½æ¸…æ™°äº†è§£ä»£ç†ä¸åå°„æ¥å£ä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤æˆ‘ä»¬æœ€å¥½é€šè¿‡ä¸€äº›ä¾‹å­æ¥è¿›è¡Œæ·±å…¥ç ”ç©¶ã€‚</p>
<h2 id="åˆ›å»ºä¸€ä¸ªç®€å•çš„ä»£ç†"><a href="#åˆ›å»ºä¸€ä¸ªç®€å•çš„ä»£ç†" class="headerlink" title="åˆ›å»ºä¸€ä¸ªç®€å•çš„ä»£ç†"></a>åˆ›å»ºä¸€ä¸ªç®€å•çš„ä»£ç†</h2><p>å½“ä½ ä½¿ç”¨ Proxy æ„é€ å™¨æ¥åˆ›å»ºä¸€ä¸ªä»£ç†æ—¶ï¼Œéœ€è¦ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼šç›®æ ‡å¯¹è±¡ä»¥åŠä¸€ä¸ªå¤„ç†å™¨ï¼ˆhandlerï¼‰ï¼Œåè€…æ˜¯å®šä¹‰äº†ä¸€ä¸ªæˆ–å¤šä¸ªé™·é˜±å‡½æ•°çš„å¯¹è±¡ã€‚å¦‚æœæœªæä¾›é™·é˜±å‡½æ•°ï¼Œä»£ç†ä¼šå¯¹æ‰€æœ‰æ“ä½œé‡‡å–é»˜è®¤è¡Œä¸ºã€‚ä¸ºäº†åˆ›å»ºä¸€ä¸ªä»…è¿›è¡Œä¼ é€’çš„ä»£ç†ï¼Œä½ éœ€è¦ä½¿ç”¨ä¸åŒ…å«ä»»ä½•é™·é˜±å‡½æ•°çš„å¤„ç†å™¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> target = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;&#125;);</span><br><span class="line">proxy.name = <span class="string">"proxy"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(proxy.name); <span class="comment">// "proxy"</span></span><br><span class="line"><span class="built_in">console</span>.log(target.name); <span class="comment">// "proxy"</span></span><br><span class="line">target.name = <span class="string">"target"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(proxy.name); <span class="comment">// "target"</span></span><br><span class="line"><span class="built_in">console</span>.log(target.name); <span class="comment">// "target"</span></span><br></pre></td></tr></table></figure>
<p>è¯¥ä¾‹ä¸­çš„ proxy å¯¹è±¡å°†æ‰€æœ‰æ“ä½œç›´æ¥ä¼ é€’ç»™ target å¯¹è±¡ã€‚å½“ proxy.name å±æ€§è¢«èµ‹å€¼ä¸ºå­—ç¬¦ä¸² â€œproxyâ€ çš„æ—¶å€™ï¼Œ target.name å±æ€§ä¹ŸåŒæ—¶è¢«åˆ›å»ºï¼Œä»£ç†å¯¹è±¡ proxy è‡ªèº«å…¶å®å¹¶æ²¡æœ‰å­˜å‚¨è¯¥å±æ€§ï¼Œå®ƒåªæ˜¯ç®€å•å°†å€¼ä¼ é€’ç»™ target å¯¹è±¡ã€‚åŒæ ·ï¼Œ proxy.name ä¸ target.name çš„å±æ€§å€¼æ€»æ˜¯ç›¸ç­‰ï¼Œå› ä¸ºå®ƒä»¬éƒ½æŒ‡å‘ target.name ï¼Œè¿™å°±æ„å‘³ç€ï¼šä¸º target.name è®¾ç½®ä¸€ä¸ªæ–°å€¼ä¼šåœ¨ proxy.name ä¸Šåæ˜ å‡ºç›¸åŒçš„æ”¹å˜ã€‚å½“ç„¶ï¼Œç¼ºå°‘é™·é˜±å‡½æ•°çš„ä»£ç†æ²¡ä»€ä¹ˆç”¨ï¼Œé‚£ä¹ˆè‹¥ä¸ºå…¶å®šä¹‰ä¸€ä¸ªé™·é˜±å‡½æ•°ï¼Œåˆä¼šå¦‚ä½•ï¼Ÿ</p>
<h2 id="ä½¿ç”¨seté™·é˜±å‡½æ•°éªŒè¯å±æ€§å€¼"><a href="#ä½¿ç”¨seté™·é˜±å‡½æ•°éªŒè¯å±æ€§å€¼" class="headerlink" title="ä½¿ç”¨seté™·é˜±å‡½æ•°éªŒè¯å±æ€§å€¼"></a>ä½¿ç”¨seté™·é˜±å‡½æ•°éªŒè¯å±æ€§å€¼</h2><p>å‡è®¾ä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶è¦æ±‚å…¶å±æ€§å€¼åªèƒ½æ˜¯æ•°å€¼ï¼Œè¿™å°±æ„å‘³ç€è¯¥å¯¹è±¡çš„æ¯ä¸ªæ–°å¢å±æ€§éƒ½è¦è¢«éªŒè¯ï¼Œå¹¶ä¸”åœ¨å±æ€§å€¼ä¸ä¸ºæ•°å€¼ç±»å‹æ—¶åº”å½“æŠ›å‡ºé”™è¯¯ã€‚ä¸ºæ­¤ä½ éœ€è¦å®šä¹‰ set é™·é˜±å‡½æ•°æ¥é‡å†™è®¾ç½®å±æ€§å€¼æ—¶çš„é»˜è®¤è¡Œä¸ºï¼Œè¯¥é™·é˜±å‡½æ•°èƒ½æ¥å—å››ä¸ªå‚æ•°ï¼š</p>
<ol>
<li>trapTarget ï¼šå°†æ¥æ”¶å±æ€§çš„å¯¹è±¡ï¼ˆå³ä»£ç†çš„ç›®æ ‡å¯¹è±¡ï¼‰ï¼›</li>
<li>key ï¼šéœ€è¦å†™å…¥çš„å±æ€§çš„é”®ï¼ˆå­—ç¬¦ä¸²ç±»å‹æˆ–ç¬¦å·ç±»å‹ï¼‰ï¼›</li>
<li>value ï¼šå°†è¢«å†™å…¥å±æ€§çš„å€¼ï¼›</li>
<li>receiver ï¼šæ“ä½œå‘ç”Ÿçš„å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯ä»£ç†å¯¹è±¡ï¼‰ã€‚<br>Reflect.set() æ˜¯ set é™·é˜±å‡½æ•°å¯¹åº”çš„åå°„æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ set æ“ä½œçš„é»˜è®¤è¡Œä¸ºã€‚<br>Reflect.set() æ–¹æ³•ä¸ set é™·é˜±å‡½æ•°ä¸€æ ·ï¼Œèƒ½æ¥å—è¿™å››ä¸ªå‚æ•°ï¼Œè®©è¯¥æ–¹æ³•èƒ½åœ¨é™·é˜±å‡½æ•°å†…éƒ¨è¢«æ–¹ä¾¿ä½¿ç”¨ã€‚è¯¥é™·é˜±å‡½æ•°éœ€è¦åœ¨å±æ€§è¢«è®¾ç½®å®Œæˆçš„æƒ…å†µä¸‹è¿”å› true ï¼Œå¦åˆ™å°±è¦è¿”å› falseï¼Œè€Œ Reflect.set() ä¹Ÿä¼šåŸºäºæ“ä½œæ˜¯å¦æˆåŠŸè€Œè¿”å›ç›¸åº”çš„ç»“æœã€‚ä½ éœ€è¦ä½¿ç”¨ set é™·é˜±å‡½æ•°æ¥æ‹¦æˆªä¼ å…¥çš„ value å€¼ï¼Œä»¥ä¾¿å¯¹å±æ€§å€¼è¿›è¡ŒéªŒè¯ã€‚è¿™é‡Œæœ‰ä¸ªä¾‹å­ï¼š<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> target = &#123;</span><br><span class="line">    name: <span class="string">"target"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span><br><span class="line">    <span class="keyword">set</span>(trapTarget, key, value, receiver) &#123;</span><br><span class="line">    <span class="comment">// å¿½ç•¥å·²æœ‰å±æ€§ï¼Œé¿å…å½±å“å®ƒä»¬</span></span><br><span class="line">        <span class="keyword">if</span> (!trapTarget.hasOwnProperty(key)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isNaN</span>(value)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Property must be a number."</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ·»åŠ å±æ€§</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(trapTarget, key, value, receiver)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// æ·»åŠ ä¸€ä¸ªæ–°å±æ€§</span></span><br><span class="line">proxy.count = <span class="number">1</span></span><br><span class="line"><span class="built_in">console</span>.log(proxy.count) <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(target.count) <span class="comment">// 1</span></span><br><span class="line"><span class="comment">// ä½ å¯ä»¥ä¸º name èµ‹ä¸€ä¸ªéæ•°å€¼ç±»å‹çš„å€¼ï¼Œå› ä¸ºè¯¥å±æ€§å·²ç»å­˜åœ¨</span></span><br><span class="line">proxy.name = <span class="string">"proxy"</span></span><br><span class="line"><span class="built_in">console</span>.log(proxy.name) <span class="comment">// "proxy"</span></span><br><span class="line"><span class="built_in">console</span>.log(target.name) <span class="comment">// "proxy"</span></span><br><span class="line"><span class="comment">// æŠ›å‡ºé”™è¯¯</span></span><br><span class="line">proxy.anotherName = <span class="string">"proxy"</span></span><br></pre></td></tr></table></figure>
è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªä»£ç†é™·é˜±ï¼Œç”¨äºå¯¹ target å¯¹è±¡æ–°å¢å±æ€§çš„å€¼è¿›è¡ŒéªŒè¯ã€‚å½“æ‰§è¡Œproxy.count = 1 æ—¶ï¼Œ set é™·é˜±å‡½æ•°è¢«è°ƒç”¨ï¼Œæ­¤æ—¶ trapTarget çš„å€¼ç­‰äº target å¯¹è±¡ï¼Œkey çš„å€¼æ˜¯å­—ç¬¦ä¸² â€œcountâ€ ï¼Œ value çš„å€¼æ˜¯ 1 ï¼Œè€Œ receiver çš„å€¼æ˜¯ proxy ï¼ˆè¯¥å‚æ•°åœ¨æœ¬ä¾‹ä¸­å¹¶æ²¡æœ‰è¢«ä½¿ç”¨ï¼‰ã€‚ target å¯¹è±¡ä¸Šå°šä¸å­˜åœ¨åä¸º count çš„å±æ€§ï¼Œå› æ­¤ä»£ç†å°†value å‚æ•°ä¼ é€’ç»™ isNaN() æ–¹æ³•è¿›è¡ŒéªŒè¯ï¼›å¦‚æœéªŒè¯ç»“æœæ˜¯ NaN ï¼Œè¡¨ç¤ºä¼ å…¥çš„å±æ€§å€¼ä¸æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œéœ€è¦æŠ›å‡ºé”™è¯¯ï¼›ä½†ç”±äºè¿™æ®µä»£ç å°† count å‚æ•°è®¾ç½®ä¸º 1 ï¼ŒéªŒè¯é€šè¿‡ï¼Œä»£ç†ä½¿ç”¨ä¸€è‡´çš„å››ä¸ªå‚æ•°å»è°ƒç”¨ Reflect.set() æ–¹æ³•ï¼Œä»è€Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å±æ€§ã€‚<br>å½“ proxy.name è¢«èµ‹å€¼ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ“ä½œæˆåŠŸå®Œæˆã€‚è¿™æ˜¯å› ä¸º target å¯¹è±¡å·²ç»æ‹¥æœ‰ä¸€ä¸ªname å±æ€§ï¼Œå› æ­¤éªŒè¯æ—¶é€šè¿‡è°ƒç”¨ trapTarget.hasOwnProperty() ä¼šå¿½ç•¥è¯¥å±æ€§ï¼Œè¿™å°±ç¡®ä¿å…è®¸åœ¨è¯¥å¯¹è±¡çš„å·²æœ‰å±æ€§ä¸Šä½¿ç”¨éæ•°å€¼çš„å±æ€§å€¼ã€‚<br>å½“ proxy.anotherName è¢«èµ‹å€¼ä¸ºå­—ç¬¦ä¸²æ—¶ï¼ŒæŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºè¯¥å¯¹è±¡ä¸Šå¹¶ä¸å­˜åœ¨anotherName å±æ€§ï¼Œå› æ­¤è¯¥å±æ€§çš„å€¼å¿…é¡»è¢«éªŒè¯ï¼Œè€Œå› ä¸ºæä¾›çš„å€¼ä¸æ˜¯ä¸€ä¸ªæ•°å€¼ï¼ŒéªŒè¯è¿‡ç¨‹å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚<br>set ä»£ç†é™·é˜±å…è®¸ä½ åœ¨å†™å…¥å±æ€§å€¼çš„æ—¶å€™è¿›è¡Œæ‹¦æˆªï¼Œè€Œ get ä»£ç†é™·é˜±åˆ™å…è®¸ä½ åœ¨è¯»å–å±æ€§<br>å€¼çš„æ—¶å€™è¿›è¡Œæ‹¦æˆªã€‚<h2 id="ä½¿ç”¨geté™·é˜±å‡½æ•°è¿›è¡Œå¯¹è±¡å¤–å½¢éªŒè¯"><a href="#ä½¿ç”¨geté™·é˜±å‡½æ•°è¿›è¡Œå¯¹è±¡å¤–å½¢éªŒè¯" class="headerlink" title="ä½¿ç”¨geté™·é˜±å‡½æ•°è¿›è¡Œå¯¹è±¡å¤–å½¢éªŒè¯"></a>ä½¿ç”¨geté™·é˜±å‡½æ•°è¿›è¡Œå¯¹è±¡å¤–å½¢éªŒè¯</h2></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://gitee.com/iversoncurry/Blog.git/2020/04/26/Promise%E4%B8%8E%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/Blog/images/avatar.gif">
      <meta itemprop="name" content="èš‚èš">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èš‚èšçš„åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Blog/2020/04/26/Promise%E4%B8%8E%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">Promiseä¸å¼‚æ­¥ç¼–ç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-26 10:04:36 / Modified: 11:24:50" itemprop="dateCreated datePublished" datetime="2020-04-26T10:04:36+08:00">2020-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>JSæœ€å¼ºå¤§çš„ä¸€æ–¹é¢å°±æ˜¯å®ƒèƒ½æå…¶è½»æ˜“åœ°å¤„ç†å¼‚æ­¥ç¼–ç¨‹ã€‚ä½œä¸ºå› ä¸ºäº’è”ç½‘è€Œç”Ÿçš„è¯­è¨€ï¼ŒJSä»ä¸€å¼€å§‹å°±å¿…é¡»èƒ½å¤Ÿå“åº”ç‚¹å‡»æˆ–æŒ‰é”®ä¹‹ç±»çš„ç”¨æˆ·äº¤äº’è¡Œä¸ºã€‚Node.jsé€šè¿‡ä½¿ç”¨å›è°ƒå‡½æ•°æ¥ä»£æ›¿äº‹ä»¶ï¼Œè¿›ä¸€æ­¥æ¨åŠ¨äº†JSä¸­çš„å¼‚æ­¥ç¼–ç¨‹ã€‚éšç€è¶Šæ¥è¶Šå¤šçš„ç¨‹åºå¼€å§‹ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹ï¼Œäº‹ä»¶ä¸å›è°ƒå‡½æ•°å·²ä¸è¶³ä»¥æ”¯æŒå¼€å‘è€…çš„æ‰€æœ‰éœ€æ±‚ã€‚Promiseæ­£æ˜¯ä¸ºäº†è§£å†³è¿™æ–¹é¢çš„é—®é¢˜ã€‚<br>Promiseæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„å¦ä¸€ç§é€‰æ‹©ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºåœ¨å…¶ä»–è¯­è¨€ä¸­å»¶è¿Ÿå¹¶åœ¨å°†æ¥æ‰§è¡Œä½œä¸šã€‚ä¸€ä¸ªPromiseæŒ‡å®šä¸€äº›è¦ç¨åæ‰§è¡Œçš„ä»£ç ï¼ˆå°±åƒäº‹ä»¶ä¸å›è°ƒå‡½æ•°ä¸€æ ·ï¼‰ï¼Œå¹¶ä¸”ä¹Ÿæ˜ç¡®æ ‡ç¤ºäº†ä½œä¸šçš„ä»£ç æ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚èƒ½ä»¥æˆåŠŸå¤„ç†æˆ–å¤±è´¥å¤„ç†ä¸ºåŸºå‡†ï¼Œå°†Promiseä¸²è”åœ¨ä¸€èµ·ï¼Œè®©ä»£ç æ›´å®¹æ˜“ç†è§£ï¼Œæ›´æ˜“è°ƒè¯•ã€‚</p>
<h2 id="å¼‚æ­¥ç¼–ç¨‹çš„èƒŒæ™¯"><a href="#å¼‚æ­¥ç¼–ç¨‹çš„èƒŒæ™¯" class="headerlink" title="å¼‚æ­¥ç¼–ç¨‹çš„èƒŒæ™¯"></a>å¼‚æ­¥ç¼–ç¨‹çš„èƒŒæ™¯</h2><p>JSå¼•æ“å»ºç«‹åœ¨å•çº¿ç¨‹äº‹ä»¶å¾ªç¯çš„æ¦‚å¿µä¸Šã€‚å•çº¿ç¨‹ï¼ˆSingle-threadedï¼‰æ„å‘³ç€åŒä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€æ®µä»£ç ï¼Œä¸Javaæˆ–C++è¿™ç§å…è®¸åŒæ—¶æ‰§è¡Œå¤šæ®µä¸åŒä»£ç çš„å¤šçº¿ç¨‹è¯­è¨€å½¢æˆäº†åå·®ã€‚å¤šæ®µä»£ç å¯ä»¥åŒæ—¶è®¿é—®æˆ–ä¿®æ”¹çŠ¶æ€ï¼Œå§”ä¼šå¹¶ä¿æŠ¤è¿™äº›çŠ¶æ€å°±å˜æˆäº†éš¾é¢˜ï¼Œè¿™ä¹Ÿæ˜¯åŸºäºå¤šçº¿ç¨‹çš„è½¯ä»¶ä¸­å‡ºç°bugçš„å¸¸è§æ ¹æºä¹‹ä¸€ã€‚<br>JSå¼•æ“åœ¨åŒä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€æ®µä»£ç ï¼Œæ‰€ä»¥å¼•æ“æ— éœ€ç•™æ„é‚£äº›â€œå¯èƒ½â€è¿è¡Œçš„ä»£ç ã€‚ä»£ç ä¼šè¢«æ”¾ç½®åœ¨ä½œä¸šé˜Ÿåˆ—ï¼ˆjob queueï¼‰ä¸­ï¼Œæ¯å½“ä¸€æ®µä»£ç å‡†å¤‡æ‰§è¡Œï¼Œå®ƒå°±ä¼šè¢«æ·»åŠ åˆ°ä½œä¸šé˜Ÿåˆ—ã€‚å½“JSå¼•æ“ç»“æŸå½“å‰ä»£ç çš„æ‰§è¡Œåï¼Œäº‹ä»¶å¾ªç¯å°±ä¼šæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„å†™ä¸€ä¸ªä½œä¸šã€‚äº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰æ˜¯JSå¼•æ“çš„ä¸€ä¸ªå†…éƒ¨å¤„ç†çº¿ç¨‹ï¼Œèƒ½ç›‘è§†ä»£ç çš„æ‰§è¡Œå¹¶ç®¡ç†ä½œä¸šé˜Ÿåˆ—ã€‚è¦è®°ä½ï¼Œæ—¢ç„¶æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä½œä¸šå°±ä¼šä»é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå¼€å§‹ï¼Œä¸€æ¬¡è¿è¡Œåˆ°æœ€åä¸€ä¸ªã€‚</p>
<h3 id="äº‹ä»¶æ¨¡å‹"><a href="#äº‹ä»¶æ¨¡å‹" class="headerlink" title="äº‹ä»¶æ¨¡å‹"></a>äº‹ä»¶æ¨¡å‹</h3><p>å½“ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æˆ–æŒ‰ä¸‹é”®ç›˜ä¸Šçš„ä¸€ä¸ªé”®æ—¶ï¼Œä¸€ä¸ªäº‹ä»¶ï¼ˆeventï¼‰â€“ä¾‹å¦‚ onclick â€“å°±è¢«è§¦å‘äº†ã€‚è¯¥äº‹ä»¶å¯èƒ½ä¼šå¯¹æ­¤äº¤äº’è¿›è¡Œå“åº”ï¼Œä»è€Œå°†ä¸€ä¸ªæ–°çš„ä½œä¸šæ·»åŠ åˆ°ä½œä¸šé˜Ÿåˆ—çš„å°¾éƒ¨ã€‚è¿™å°±æ˜¯JSå…³äºå¼‚æ­¥ç¼–ç¨‹çš„æœ€åŸºæœ¬å½¢å¼ã€‚æ—¶é—´å¤„ç†ç¨‹åºä»£ç ç›´åˆ°äº‹ä»¶å‘ç”Ÿåæ‰ä¼šè¢«æ‰§è¡Œï¼Œæ­¤æ—¶å®ƒä¼šæ‹¥æœ‰åˆé€‚çš„ä¸Šä¸‹æ–‡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> button = documet.getElementById(<span class="string">'my-btn'</span>)</span><br><span class="line">button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Clicked'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤ä»£ç ä¸­ï¼Œconsole.log(â€˜Clickedâ€™)ç›´åˆ°buttonè¢«ç‚¹å‡»åæ‰ä¼šè¢«æ‰§è¡Œã€‚å½“buttonè¢«ç‚¹å‡»ï¼Œèµ‹å€¼ç»™onclickçš„å‡½æ•°å°±è¢«æ·»åŠ åˆ°ä½œä¸šé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå¹¶åœ¨é˜Ÿåˆ—å‰éƒ¨æ‰€æœ‰ä»»åŠ¡ç»“æŸä¹‹åå†æ‰§è¡Œã€‚<br>äº‹ä»¶å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œäºç®€å•çš„äº¤äº’ï¼Œä½†å°†å¤šä¸ªåˆ†ç¦»çš„å¼‚æ­¥è°ƒç”¨ä¸²è”åœ¨ä¸€èµ·å´ä¼šå¾ˆéº»çƒ¦ï¼Œå› ä¸ºå¿…é¡»è¿½è¸ªæ¯ä¸ªäº‹ä»¶çš„äº‹ä»¶å¯¹è±¡ï¼ˆä¾‹å¦‚ä¸Šä¾‹ä¸­çš„buttonï¼‰ã€‚æ­¤å¤–ï¼Œè¿˜é¡»ç¡®ä¿æ‰€æœ‰çš„äº‹ä»¶å¤„ç†ç¨‹åºéƒ½èƒ½åœ¨äº‹ä»¶ç¬¬ä¸€æ¬¡è§¦å‘ä¹‹å‰è¢«ç»‘å®šå®Œæ¯•ã€‚ä¾‹å¦‚ï¼Œè‹¥buttonåœ¨onclickè¢«ç»‘å®šä¹‹å‰å°±è¢«ç‚¹å‡»ï¼Œé‚£å°±ä¸ä¼šæœ‰ä»»ä½•äº‹å‘ç”Ÿã€‚å› æ­¤è™½ç„¶åœ¨å“åº”ç”¨æˆ·äº¤äº’æˆ–ç±»ä¼¼çš„ä½é¢‘åŠŸèƒ½æ—¶ã€‚äº‹ä»¶å¾ˆæœ‰ç”¨ï¼Œä½†å®ƒåœ¨é¢å¯¹æ›´å¤æ‚çš„éœ€æ±‚æ—¶ä»ç„¶ä¸å¤Ÿçµæ´»ã€‚</p>
<h3 id="å›è°ƒæ¨¡å¼"><a href="#å›è°ƒæ¨¡å¼" class="headerlink" title="å›è°ƒæ¨¡å¼"></a>å›è°ƒæ¨¡å¼</h3><p>å½“Node.jsè¢«åˆ›å»ºæ—¶ï¼Œå®ƒé€šè¿‡æ™®åŠå›è°ƒå‡½æ•°ç¼–ç¨‹æ¨¡å¼æå‡äº†å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ã€‚å›è°ƒå‡½æ•°æ¨¡å¼ç±»ä¼¼äºäº‹ä»¶æ¨¡å‹ï¼Œå› ä¸ºè¡£ä¸å¸¦å—ä¹Ÿä¼šåœ¨ä¼šé¢çš„ä¸€ä¸ªæ—¶é—´ç‚¹æ‰æ‰§è¡Œã€‚ä¸åŒä¹‹å¤„åœ¨äºéœ€è¦è°ƒç”¨çš„å‡½æ•°ï¼ˆå³å›è°ƒå‡½æ•°ï¼‰æ—¶ä½œä¸ºå‚æ•°ä¼ å…¥çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">readFile(<span class="string">'example.txt'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, contents</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(contents)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hi'</span>)</span><br></pre></td></tr></table></figure>
<p>æ­¤ä¾‹ä¸­ä½¿ç”¨äº†Node.jsæƒ¯ä¾‹ï¼Œå³é”™è¯¯ä¼˜å…ˆï¼ˆerror-firstï¼‰çš„å›è°ƒå‡½æ•°é£æ ¼ã€‚readFile()å‡½æ•°ç”¨äºè¯»å–ç£ç›˜ä¸­çš„æ–‡ä»¶ï¼ˆç”±ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šï¼‰ï¼Œå¹¶åœ¨è¯»å–å®Œæˆåæ‰§è¡Œå›è°ƒå‡½æ•°ï¼ˆå³ç¬¬äºŒä¸ªå‚æ•°ï¼‰ã€‚å¦‚æœå­˜åœ¨é”™è¯¯ï¼Œå›è°ƒå‡½æ•°çš„errå‚æ•°å›äº‹ä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼›å¦åˆ™contentsæ“¦ä¹¦å°±ä¼šä»¥å­—ç¬¦ä¸²å½¢å¼åŒ…å«æ–‡ä»¶å†…å®¹ã€‚<br>ä½¿ç”¨å›è°ƒå‡½æ•°æ¨¡å¼ï¼ŒreadFile()ä¼šç«‹å³å¼€å§‹æ‰§è¡Œï¼Œå¹¶åœ¨å¼€å§‹è¯»å–ç£ç›˜æ—¶æš‚åœã€‚è¿™æ„å‘³ç€console.log(â€˜hiâ€™)ä¼šåœ¨readFile()è¢«è°ƒç”¨åç«‹å³è¿›è¡Œè¾“å‡ºï¼Œè¦æ—©äºconsole.log(contents)çš„æ‰“å°æ“ä½œã€‚å½“readFile()ç»“æŸæ“ä½œåï¼Œå®ƒä¼šå°†å›è°ƒå‡½æ•°ä»¥åŠç›¸å…³å‚æ•°ä½œä¸ºä¸€ä¸ªæ–°çš„ä½œä¸šæ·»åŠ åˆ°ä½œä¸šé˜Ÿåˆ—çš„å°¾éƒ¨ã€‚åœ¨ä¹‹å‰çš„ä½œä¸šå…¨éƒ¨ç»“æŸåï¼Œæ”¹ä½œä¸šæ‰ä¼šæ‰§è¡Œã€‚<br>å›è°ƒå‡½æ•°æ¨¡å¼è¦æ¯”äº‹ä»¶æ¨¡å‹çµæ´»å¾—å¤šï¼Œå› ä¸ºä½¿ç”¨å›è°ƒå‡½æ•°ä¸²è”å¤šä¸ªè°ƒç”¨ä¼šç›¸å¯¹å®¹æ˜“ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">readFile(<span class="string">'example.txt'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, contents</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    writeFile(<span class="string">'example.txt'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">throw</span> err</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'File was written'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä»£ç ä¸­ï¼Œå¯¹äºreadFile()çš„ç¬¬ä¸€æ¬¡æˆåŠŸè°ƒç”¨å¼•å‡ºäº†å¦ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨ï¼Œå³è°ƒç”¨writeFile()å‡½æ•°ã€‚æ³¨æ„è¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä½¿ç”¨äº†æ£€æŸ¥errçš„ç»Ÿä¸€åŸºæœ¬æ¨¡å¼ã€‚å½“readFile()æ‰§è¡Œç»“æŸåï¼Œå®ƒæ·»åŠ ä¸€ä¸ªä½œä¸šåˆ°ä½œä¸šé˜Ÿåˆ—ï¼Œä»è€Œå¯¼è‡´writeFIle()åœ¨ä¹‹åè¢«è°ƒç”¨ï¼ˆå‡è®¾æ²¡æœ‰å‡ºç°é”™è¯¯ï¼‰ã€‚æ¥ä¸‹æ¥ï¼ŒwriteFile()ä¹Ÿä¼šåœ¨æ‰§è¡Œç»“æŸåé¡¹é˜Ÿåˆ—æ·»åŠ ä¸€ä¸ªä½œä¸šã€‚<br>è¿™ç§æ¨¡å¼è¿ä½œå¾—ç›¸å½“å¥½ï¼Œä½†ä½ å¯èƒ½ä¼šè¿…é€Ÿå¯Ÿè§‰é™·å…¥äº†å›è°ƒåœ°ç‹±ï¼ˆ callback hell ï¼‰ï¼Œè¿™ä¼šåœ¨åµŒ<br>å¥—è¿‡å¤šå›è°ƒå‡½æ•°æ—¶å‘ç”Ÿï¼Œå°±åƒè¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">method1(<span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    method2(<span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">throw</span> err</span><br><span class="line">        &#125;</span><br><span class="line">        method3(<span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                <span class="keyword">throw</span> err</span><br><span class="line">            &#125;</span><br><span class="line">            method4(<span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> err</span><br><span class="line">                &#125;</span><br><span class="line">                method5(result)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="PromiseåŸºç¡€"><a href="#PromiseåŸºç¡€" class="headerlink" title="PromiseåŸºç¡€"></a>PromiseåŸºç¡€</h2><p><strong>Promiseæ˜¯ä¸ºå¼‚æ­¥æ“ä½œçš„ç»“æœæ‰€å‡†å¤‡çš„å ä½ç¬¦ã€‚</strong>å‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªPromiseï¼Œè€Œä¸å¿…è®¢é˜…ä¸€ä¸ªäº‹ä»¶æˆ–å‘å‡½æ•°ä¼ é€’ä¸€ä¸ªå›è°ƒå‚æ•°ï¼Œå½¢å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = readFile(<span class="string">'example.txt'</span>)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä»£ç ä¸­ï¼ŒreadFile()å®é™…ä¸Šå¹¶æœªç«‹å³å¼€å§‹è¯»å–æ–‡ä»¶ï¼Œè¿™å°†ä¼šåœ¨ç¨åå‘ç”Ÿã€‚æ­¤å‡½æ•°åè€Œä¼šè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ä»ªè¡¨å®¤å¼‚æ­¥è¯»å–æ“ä½œï¼Œå› æ­¤å¯ä»¥åœ¨å¥–åŠ±å•Šå†æ“ä½œå®ƒã€‚èƒ½å¯¹ç»“æœè¿›è¡Œæ“ä½œçš„ç¡®åˆ‡æ—¶åˆ»ï¼Œå®Œå…¨å–å†³äºPromiseçš„å£°æ˜å‘¨æœŸæ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚</p>
<h3 id="Promiseçš„å£°æ˜å‘¨æœŸ"><a href="#Promiseçš„å£°æ˜å‘¨æœŸ" class="headerlink" title="Promiseçš„å£°æ˜å‘¨æœŸ"></a>Promiseçš„å£°æ˜å‘¨æœŸ</h3><p>æ¯ä¸ªPromiseéƒ½ä¼šç»å†ä¸€ä¸ªçŸ­æš‚çš„å£°æ˜å‘¨æœŸï¼Œå‡ºäº‹ä¸ºæŒ‚èµ·æ€ï¼ˆpending state)ï¼Œè¿™è¡¨ç¤ºå¼‚æ­¥æ“ä½œå°šæœªç»“æŸã€‚ä¸€ä¸ªæŒ‚èµ·çš„Promiseä¹Ÿè¢«è®¤ä¸ºæ˜¯æœªå†³çš„ï¼ˆunsettledï¼‰ã€‚ä¸Šä¸ªä¾‹å­ä¸­çš„Promiseåœ¨readFile()å‡½æ•°è¿”å›å®ƒçš„æ—¶å€™å°±æ˜¯å‡ºäºæŒ‚èµ·æ€ã€‚ä¸€æ—¦å¼‚æ­¥æ“ä½œç»“æŸï¼ŒPromiseå°±ä¼šè¢«è®¤ä¸ºæ˜¯å·²å†³çš„ï¼ˆsettledï¼‰ï¼Œå¹¶è¿›å…¥ä¸¤ç§å¯èƒ½çŠ¶æ€ä¹‹ä¸€ã€‚<br>1.å·²å®Œæˆï¼ˆfulfilledï¼‰ï¼šPromiseçš„å¼‚æ­¥æ“ä½œå·²æˆåŠŸç»“æŸï¼›<br>2.å·²æ‹’ç»ï¼ˆrejectedï¼‰ï¼šPromiseçš„å¼‚æ­¥æ“ä½œæœªæˆåŠŸç»“æŸï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œæˆ–æœ‰å…¶ä»–åŸå› å¯¼è‡´ã€‚<br>å†…éƒ¨çš„[[PromiseState]]å±æ€§ä¼šè¢«è®¾ç½®ä¸ºâ€pendingâ€,â€fulfilledâ€æˆ–â€rejectedâ€ï¼Œä»¥åæ˜ Promiseçš„çŠ¶æ€ã€‚è¯¥å±æ€§å¹¶æœªåœ¨Promiseå¯¹è±¡ä¸Šè¢«æš´éœ²å‡ºæ¥ï¼Œå› æ­¤æ— æ³•å·²å˜æˆæ–¹å¼åˆ¤æ–­Promiseåˆ°åº•å¤„äºå“ªç§çŠ¶æ€ã€‚ä¸è¿‡å¯ä»¥ä½¿ç”¨thenæ–¹æ³•åœ¨Promiseçš„çŠ¶æ€æ”¹å˜æ—¶æ‰§è¡Œä¸€äº›ç‰¹å®šæ“ä½œã€‚<br>ä»¥ä¸‹ä¸ºPromiseç›¸å…³è¯æ±‡çš„ç¿»è¯‘ï¼š</p>
<ol>
<li>pending ï¼šæŒ‚èµ·ï¼Œè¡¨ç¤ºæœªç»“æŸçš„ Promise çŠ¶æ€ã€‚ç›¸å…³è¯æ±‡â€œæŒ‚èµ·æ€â€ã€‚</li>
<li>fulfilled ï¼šå·²å®Œæˆï¼Œè¡¨ç¤ºå·²æˆåŠŸç»“æŸçš„ Promise çŠ¶æ€ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œæˆåŠŸå®Œæˆâ€ã€‚ç›¸å…³<br>è¯æ±‡â€œå®Œæˆâ€ã€â€œè¢«å®Œæˆâ€ã€â€œå®Œæˆæ€â€ã€‚</li>
<li>rejected ï¼šå·²æ‹’ç»ï¼Œè¡¨ç¤ºå·²ç»“æŸä½†å¤±è´¥çš„ Promise çŠ¶æ€ã€‚ç›¸å…³è¯æ±‡â€œæ‹’ç»â€ã€â€œè¢«æ‹’<br>ç»â€ã€â€œæ‹’ç»æ€â€ã€‚</li>
<li>resolve ï¼šå†³è®®ï¼Œè¡¨ç¤ºå°† Promise æ¨å‘æˆåŠŸæ€ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œå†³è®®é€šè¿‡â€ï¼Œåœ¨ Promise<br>æ¦‚å¿µä¸­ä¸â€œå®Œæˆâ€æ˜¯è¿‘ä¹‰è¯ã€‚ç›¸å…³è¯æ±‡â€œå†³è®®æ€â€ã€â€œå·²å†³è®®â€ã€â€œè¢«å†³è®®â€ã€‚</li>
<li>unsettled ï¼šæœªå†³ï¼Œæˆ–è€…ç§°ä¸ºâ€œæœªè§£å†³â€ï¼Œè¡¨ç¤º Promise å°šæœªè¢«å®Œæˆæˆ–æ‹’ç»ï¼Œä¸â€œæŒ‚<br>èµ·â€æ˜¯è¿‘ä¹‰è¯ã€‚</li>
<li>settled ï¼šå·²å†³ï¼Œæˆ–è€…ç§°ä¸ºâ€œå·²è§£å†³â€ï¼Œè¡¨ç¤º Promise å·²è¢«å®Œæˆæˆ–æ‹’ç»ã€‚æ³¨æ„è¿™ä¸â€œå·²å®Œ<br>æˆâ€æˆ–â€œå·²å†³è®®â€ä¸åŒï¼Œâ€œå·²å†³â€çš„çŠ¶æ€ä¹Ÿå¯èƒ½æ˜¯â€œæ‹’ç»æ€â€ï¼ˆå·²å¤±è´¥ï¼‰ã€‚</li>
<li>fulfillment handler ï¼šå®Œæˆå¤„ç†å‡½æ•°ï¼Œè¡¨ç¤º Promise ä¸ºå®Œæˆæ€æ—¶ä¼šè¢«è°ƒç”¨çš„å‡½æ•°ã€‚</li>
<li>rejection handler ï¼šæ‹’ç»å¤„ç†å‡½æ•°ï¼Œè¡¨ç¤º Promise ä¸ºæ‹’ç»æ€æ—¶ä¼šè¢«è°ƒç”¨çš„å‡½æ•°ã€‚</li>
</ol>
<p>then()æ–¹æ³•åœ¨æ‰€æœ‰çš„Promiseä¸Šéƒ½å­˜åœ¨ï¼Œå¹¶ä¸”æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Promiseè¢«å®Œæˆæ—¶è¦è°ƒç”¨çš„å‡½æ•°ï¼Œä¸å¼‚æ­¥æ“ä½œå…³è”çš„ä»»ä½•é™„åŠ æ•°æ®éƒ½ä¼šè¢«ä¼ å…¥è¿™ä¸ªå®Œæˆå‡½æ•°ã€‚ç¬¬äºŒä¸ªå‚æ•°åˆ™æ˜¯Promiseè¢«æ‹’ç»æ—¶è¦è°ƒç”¨çš„å‡½æ•°ï¼Œä¸å®Œæˆå‡½æ•°ç›¸ä¼¼ï¼Œæ‹’ç»å‡½æ•°ä¼šè¢«ä¼ å…¥ä¸æ‹’ç»ç›¸å…³è”çš„ä»»ä½•é™„åŠ æ•°æ®ã€‚<br>è¿™ç§æ–¹å¼å®ç°then()é˜²èŒƒçš„ä»»ä½•å¯¹è±¡éƒ½è¢«ç§°ä¸ºä¸€ä¸ªthenableã€‚æ‰€æœ‰çš„Promiseéƒ½æ˜¯thenableï¼Œç¹æ®–åˆ™æœªå¿…æˆç«‹ã€‚<br>ä¼ é€’ä¸ªthen()çš„ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå› æ­¤ä½ å¯ä»¥ç›‘å¬å®Œæˆä¸æ‹’ç»çš„ä»»æ„ç»„åˆå½¢å¼ã€‚ä¾‹å¦‚ç ”ç©¶è¿™ç»„then()è°ƒç”¨ï¼š </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = readFile(<span class="string">'exapmle.txt'</span>)</span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å®Œæˆ</span></span><br><span class="line">    <span class="built_in">console</span>.log(contents)</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æ‹’ç»</span></span><br><span class="line">    <span class="built_in">console</span>.error(err.message)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å®Œæˆ</span></span><br><span class="line">    <span class="built_in">console</span>.log(contents)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æ‹’ç»</span></span><br><span class="line">    <span class="built_in">console</span>.error(err.message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸‰ä¸ªthen()è°ƒç”¨éƒ½æ“ä½œåœ¨åŒä¸€ä¸ªPromiseä¸Šã€‚ç¬¬ä¸€ä¸ªè°ƒç”¨åŒæ—¶ç›‘å¬äº†å®Œæˆä¸å¤±è´¥ï¼›ç¬¬äºŒä¸ªè°ƒç”¨åªç›‘å¬äº†å®Œæˆï¼Œé”™è¯¯ä¸ä¼šè¢«æŠ¥å‘Šï¼›ç¬¬ä¸‰ä¸ªåˆ™åªç›‘å¬äº†æ‹’ç»ï¼Œå¹¶ä¸æŠ¥å‘ŠæˆåŠŸä¿¡æ¯ã€‚<br>Promiseä¹Ÿå…·æœ‰ä¸€ä¸ªcatch()æ–¹æ³•ï¼Œå…¶è¡Œä¸ºç­‰åŒäºå€¼ä¼ é€’æ‹’ç»å‡½æ•°ç»™then()ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹çš„catch()ä¸then()è°ƒç”¨æ—¶åŠŸèƒ½ç­‰æ•ˆçš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err.message)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err.message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>then()ä¸catch()èƒŒåçš„æ„å›¾æ˜¯èƒ½ç»„åˆä½¿ç”¨æ¥æ­£ç¡®å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœã€‚æ­¤ç³»ç»Ÿè¦ä¼˜äºäº‹ä»¶ä¸å›è°ƒå‡½æ•°ï¼Œå› ä¸ºå®ƒè®©æ“ä½œæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥å˜å¾—å®Œå…¨æ¸…æ™°ï¼ˆäº‹ä»¶æ¨¡å¼å€¾å‘äºåœ¨å‡ºé”™æ—¶ä¸è¢«è§¦å‘ï¼Œè€Œåœ¨å›è°ƒå‡½æ•°æ¨¡å¼ä¸­ä½ å¿…é¡»å§‹ç»ˆè®°å¾—æ£€æŸ¥é”™è¯¯å‚æ•°ï¼‰ã€‚åªéœ€çŸ¥é“è‹¥æœªç»™å‡ºPromiseé™„åŠ æ‹’ç»å¤„ç†å‡½æ•°ï¼Œæ‰€æœ‰çš„é”™è¯¯å°±ä¼šé™é»˜å‘ç”Ÿã€‚å»ºè®®å§‹ç»ˆé™„åŠ ä¸€ä¸ªæ‹’ç»å¤„ç†å‡½æ•°ï¼ŒåŠæ—¶è¯¥ç¨‹åºåªæ˜¯ç”¨äºæ‰“å°é”™è¯¯æ—¥å¿—ã€‚<br>åŠæ—¶å®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°åœ¨Promiseå·²ç»è¢«è§£å†³ä¹‹åæ‰æ·»åŠ åˆ°ä½œä¸šé˜Ÿåˆ—ï¼Œå®ƒä»¬ä»ç„¶ä¼šè¢«æ‰§è¡Œã€‚è¿™å…è®¸ä½ éšæ—¶æ·»åŠ æ–°çš„å®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°ï¼Œå¹¶ä¿è¯å®ƒä»¬ä¼šè¢«è°ƒç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = readFile(<span class="string">'example,txt'</span>)</span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(contents)</span><br><span class="line">    promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(contents)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤ä»£ç ä¸­ï¼Œå®Œæˆå¤„ç†å‡½æ•°åˆä¸ºåŒä¸€ä¸ªPromiseæ·»åŠ äº†å¦ä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°ã€‚è¿™ä¸ªPromiseæ­¤åˆ»å·²ç»å®Œæˆäº†ï¼Œå› æ­¤æ–°çš„å¤„ç†ç¨‹åºå°±è¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¹¶åœ¨å°±ç»ªæ—¶ï¼ˆå‰é¢çš„ä½œä¸šæ‰§è¡Œå®Œæ¯•åï¼‰è¢«è°ƒç”¨ã€‚æ‹’ç»å¤„ç†å‡½æ•°ä½¿ç”¨åŒæ ·æ–¹å¼å·¥ä½œã€‚</p>
<p>æ¯æ¬¡è°ƒç”¨then()æˆ–catch()éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä½œä¸šï¼Œå®ƒä¼šåœ¨Promiseå·²å†³è®®æ—¶è¢«æ‰§è¡Œã€‚ä½†è¿™äº›ä½œä¸šæœ€ç»ˆä¼šè¿›å…¥ä¸€ä¸ªå®Œå…¨ä¸ºPromiseä¿ç•™çš„ä½œä¸šé˜Ÿåˆ—ã€‚</p>
<h3 id="åˆ›å»ºæœªå†³çš„Promise"><a href="#åˆ›å»ºæœªå†³çš„Promise" class="headerlink" title="åˆ›å»ºæœªå†³çš„Promise"></a>åˆ›å»ºæœªå†³çš„Promise</h3><p>æ–°çš„Promiseä½¿ç”¨Promiseæ„é€ å™¨æ¥åˆ›å»ºã€‚æ­¤æ„é€ å™¨æ¥å—å•ä¸ªå‚æ•°ï¼šä¸€ä¸ªè¢«ç§°ä¸ºæ‰§è¡Œå™¨ï¼ˆexecutorï¼‰çš„å‡½æ•°ï¼ŒåŒ…å«åˆå§‹åŒ–Promiseçš„ä»£ç ã€‚è¯¥æ‰§è¡Œå™¨æŒ¥åˆ«ä¼ é€’ä¸¤ä¸ªåä¸ºresolveä¸reject()çš„å‡½æ•°ä½œä¸ºå‚æ•°ã€‚resolve()å‡½æ•°åœ¨æ‰§è¡Œå™¨æˆåŠŸç»“æŸæ—¶è¢«è°ƒç”¨ï¼Œç”±äºç¤ºæ„è¯¥Promiseå·²ç»å‡†å¤‡å¥½è¢«å†³è®®ï¼ˆresolvedï¼‰ï¼Œè€Œreject()å‡½æ•°åˆ™è¡¨æ˜æ‰§è¡Œå™¨çš„æ“ä½œå·²å¤±è´¥ã€‚ä¸‹ä¸ºèŒƒä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">fileName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        fs.readFile(fileName, &#123;<span class="attr">encoding</span>: <span class="string">'utf8'</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, contents</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(err) &#123;</span><br><span class="line">                reject(err)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            resolve(contents)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> promise = readFile(<span class="string">"example.txt"</span>);</span><br><span class="line"><span class="comment">// åŒæ—¶ç›‘å¬å®Œæˆä¸æ‹’ç»</span></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line"><span class="comment">// å®Œæˆ</span></span><br><span class="line"><span class="built_in">console</span>.log(contents)</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line"><span class="comment">// æ‹’ç»</span></span><br><span class="line"><span class="built_in">console</span>.error(err.message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä¾‹ä¸­ï¼ŒNode.jsåŸç”Ÿçš„fs.readFile()å¼‚æ­¥è°ƒç”¨è¢«åŒ…è£…åœ¨ä¸€ä¸ªPromiseä¸­ã€‚æ‰§è¡Œå™¨è¦ä¹ˆä¼ é€’é”™è¯¯å¯¹è±¡ç»™reject()å‡½æ•°ï¼Œè¦ä¹ˆä¼ é€’æ–‡ä»¶å†…å®¹ç»™resoleve()å‡½æ•°ã€‚<br>è¦è®°ä½æ‰§è¡Œå™¨ä¼šåœ¨readFile()è¢«è°ƒç”¨æ—¶ç«‹å³è¿è¡Œã€‚å½“resolve()æˆ–reject()åœ¨æ‰§è¡Œå™¨å†…éƒ¨è¢«è°ƒç”¨æ—¶ï¼Œä¸€ä¸ªä½œä¸šè¢«æ·»åŠ åˆ°ä½œä¸šé˜Ÿåˆ—ä¸­ï¼Œä»¥ä¾¿å†³è®®ï¼ˆresolveï¼‰è¿™ä¸ªPromeiseã€‚è¿™è¢«ç§°ä¸ºä½œä¸šè°ƒåº¦ï¼ˆjob schedulingï¼‰ã€‚ä½œä¸šè°ƒåº¦ä¸­ï¼Œæ·»åŠ æ–°ä½œä¸šåˆ°é˜Ÿåˆ—ä¸­æ—¶è¡¨ç¤ºï¼šâ€œä¸è¦ç«‹åˆ»æ‰§è¡Œè¿™ä¸ªä½œä¸šï¼Œä½†è¦åœ¨ç¨åæ‰§è¡Œå®ƒâ€ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡ä»¥ä¸‹ä»£ç ç†è§£promiseçš„æ‰§è¡Œé¡ºåº</span></span><br><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">fileName</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hhh'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'lll'</span>)</span><br><span class="line">        <span class="comment">// fs.readFile(fileName, &#123;encoding: 'utf8'&#125;, function(err, contents) &#123;</span></span><br><span class="line">        <span class="comment">//     console.log('%%%%%%%%%%%%%%%%%')</span></span><br><span class="line">        <span class="comment">//     if(err) &#123;</span></span><br><span class="line">        <span class="comment">//         reject(err)</span></span><br><span class="line">        <span class="comment">//         return</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">        <span class="comment">//     resolve(contents)</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        resolve(<span class="number">123</span>)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="number">456</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> promise = readFile(<span class="string">"example.txt"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'mimashiduoshao'</span>)</span><br><span class="line"><span class="comment">// åŒæ—¶ç›‘å¬å®Œæˆä¸æ‹’ç»</span></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line"><span class="comment">// å®Œæˆ</span></span><br><span class="line"><span class="built_in">console</span>.log(contents)</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line"><span class="comment">// æ‹’ç»</span></span><br><span class="line"><span class="built_in">console</span>.error(err.message)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'woshimima'</span>)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¸ºï¼š<br>hhh<br>lll<br>456<br>mimashiduoshao<br>woshimima<br>123</p>
<h3 id="åˆ›å»ºå·²å†³çš„Promise"><a href="#åˆ›å»ºå·²å†³çš„Promise" class="headerlink" title="åˆ›å»ºå·²å†³çš„Promise"></a>åˆ›å»ºå·²å†³çš„Promise</h3><p>åŸºäºPromiseæ‰§è¡Œå™¨è¡Œä¸ºçš„åŠ¨æ€æœ¬è´¨ï¼ŒPromiseæ„é€ å™¨å°±æ˜¯åˆ›å»ºæœªå†³çš„Promiseçš„æœ€å¥½æ–¹æ³•ã€‚ä½†è‹¥æƒ³è®©ä¸€ä¸ªPromiseä»£è¡¨ä¸€ä¸ªä¸€ç›´çš„å€¼ï¼Œé‚£é¢å®‰æ’ä¸€ä¸ªæ·¡å‡ºä¼ å€¼ç»™resolve()å‡½æ•°çš„ä½œä¸šå¹¶æ²¡æœ‰æ„ä¹‰ã€‚ç›¸åï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨æŒ‡å®šå€¼æ¥åˆ›å»ºå·²å†³çš„Promise</p>
<h4 id="ä½¿ç”¨Promise-resolve"><a href="#ä½¿ç”¨Promise-resolve" class="headerlink" title="ä½¿ç”¨Promise.resolve()"></a>ä½¿ç”¨Promise.resolve()</h4><p>Promise.resolve()æ–¹æ³•æ¥å—å•ä¸ªå‚æ•°å¹¶ä¼šè¿”å›ä¸€ä¸ªå¤„äºå®Œæˆæ€çš„Promiseã€‚è¿™æ„å‘³ç€æ²¡æœ‰ä»»ä½•ä½œä¸šè°ƒåº¦ä¼šå‘ç”Ÿï¼Œå¹¶ä¸”éœ€è¦å‘PRomiseæ·»åŠ ä¸€ä¸ªæˆ–æ›´å¤šçš„å®Œæˆå¤„ç†å‡½æ•°æ¥æå–è¿™ä¸ªå‚æ•°å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="built_in">Promise</span>.resolve(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤ä»£ç åˆ›å»ºäº†ä¸€ä¸ªå·²å®Œæˆçš„Promiseï¼Œå› æ­¤å®Œæˆå¤„ç†å‡½æ•°å°±æ¥æ”¶åˆ°42ä½œä¸ºvalueå‚æ•°ã€‚è‹¥ä¸€ä¸ªæ‹’ç»å¤„ç†å‡½æ•°è¢«æ·»åŠ åˆ°æ­¤Promiseï¼Œè¯¥æ‹’ç»å¤„ç†å‡½æ•°å°†æ°¸ä¸ä¼šè¢«è°ƒç”¨ï¼Œå› ä¸ºæ­¤Promiseç»ä¸å¯èƒ½æ—¶æ‹’ç»æ€</p>
<h4 id="ä½¿ç”¨Promise-reject"><a href="#ä½¿ç”¨Promise-reject" class="headerlink" title="ä½¿ç”¨Promise.reject()"></a>ä½¿ç”¨Promise.reject()</h4><p>å¯ä»¥ä½¿ç”¨Promise.reject()æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå·²æ‹’ç»çš„Promiseã€‚æ­¤æ–¹æ³•å‘Promise.resolve()ä¸€æ ·å·¥ä½œï¼ŒåŒºåˆ«æ˜¯è¢«åˆ›å»ºçš„Promiseå¤„äºæ‹’ç»æ€</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> promise = <span class="built_in">Promise</span>.reject(<span class="number">420</span>)</span><br><span class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä»»ä½•é™„åŠ åˆ°è¿™ä¸ªPromiseçš„æ‹’ç»å¤„ç†å‡½æ•°éƒ½å°†ä¼šè¢«è°ƒç”¨ï¼Œè€Œå®Œæˆå¤„ç†å‡½æ•°åˆ™ä¸ä¼šæ‰§è¡Œã€‚</p>
<p>è‹¥ä½ ä¼ é€’ä¸€ä¸ª Promise ç»™ Promise.resolve() æˆ– Promise.reject() æ–¹æ³•ï¼Œè¯¥ Promise<br>ä¼šä¸ä½œä¿®æ”¹åŸæ ·è¿”å›ã€‚<br>è¯‘æ³¨ï¼š ç»è¿‡æµ‹è¯•ï¼Œåœ¨å‡ å¤§æµè§ˆå™¨ä¸­éƒ½å­˜åœ¨ä¸ä¸Šä¸€å¥è¯ä¸ç¬¦çš„æƒ…å†µã€‚</p>
<ol>
<li>è‹¥ä¼ å…¥çš„ Promise ä¸ºæŒ‚èµ·æ€ï¼Œåˆ™ Promise.resolve() è°ƒç”¨ä¼šå°†è¯¥ Promise åŸæ ·è¿”<br>å›ã€‚æ­¤åï¼Œè‹¥å†³è®®åŸ Promise ï¼Œåœ¨ then() ä¸­å¯ä»¥æ¥æ”¶åˆ°åŸä¾‹ä¸­çš„å‚æ•° 42 ï¼›è€Œè‹¥<br>æ‹’ç»åŸ Promise ï¼Œåˆ™åœ¨ catch() ä¸­å¯ä»¥æ¥æ”¶åˆ°å‚æ•° 42 ã€‚ ä½† Promise.reject()<br>è°ƒç”¨åˆ™ä¼šå¯¹åŸå…ˆçš„ Promise é‡æ–°è¿›è¡ŒåŒ…è£…ï¼Œå¯¹å…¶ä½¿ç”¨ catch() å¯ä»¥æ•æ‰åˆ°é”™è¯¯ï¼Œ<br>å¤„ç†å‡½æ•°ä¸­çš„ value å‚æ•°ä¸ä¼šæ˜¯æ•°å€¼ 42 ï¼Œè€Œæ˜¯åŸå…ˆå¤„äºæŒ‚èµ·æ€çš„ Promise ã€‚</li>
<li>è‹¥ä¼ å…¥çš„ Promise ä¸ºå®Œæˆæ€ï¼Œåˆ™ Promise.resolve() è°ƒç”¨ä¼šå°†è¯¥ Promise åŸæ ·è¿”<br>å›ï¼Œåœ¨ then() ä¸­å¯ä»¥æ¥æ”¶åˆ°åŸä¾‹ä¸­çš„å‚æ•° 42 ã€‚ ä½† Promise.reject() è°ƒç”¨åˆ™ä¼š<br>å¯¹åŸå…ˆçš„ Promise é‡æ–°è¿›è¡ŒåŒ…è£…ï¼Œå¯¹å…¶ä½¿ç”¨ catch() å¯ä»¥æ•æ‰åˆ°é”™è¯¯ï¼Œå¤„ç†å‡½æ•°<br>ä¸­çš„ value å‚æ•°ä¸ä¼šæ˜¯æ•°å€¼ 42 ï¼Œè€Œæ˜¯åŸå…ˆå¤„äºå®Œæˆæ€çš„ Promise ã€‚</li>
<li>è‹¥ä¼ å…¥çš„ Promise ä¸ºæ‹’ç»æ€ï¼Œåˆ™ Promise.reject() è°ƒç”¨ä¼šå°†è¯¥ Promise åŸæ ·è¿”<br>å›ï¼Œåœ¨ catch() ä¸­å¯ä»¥æ¥æ”¶åˆ°å‚æ•° 42 ã€‚ ä½† Promise.resolve() è°ƒç”¨åˆ™ä¼šå¯¹åŸå…ˆ<br>çš„ Promise é‡æ–°è¿›è¡ŒåŒ…è£…ï¼Œå¯¹å…¶ä½¿ç”¨ then() å¯ä»¥è¿›è¡Œå®Œæˆå¤„ç†ï¼Œå¤„ç†å‡½æ•°ä¸­çš„<br>value å‚æ•°ä¸æ˜¯ 42 ï¼Œè€Œæ˜¯åŸå…ˆå¤„äºæ‹’ç»æ€çš„ Promise ã€‚ä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶çš„æƒ…å†µä¸<br>ä¸Šä¸€ç§æƒ…å†µç›¸åã€‚<br>æ€»ç»“ï¼šå¯¹æŒ‚èµ·æ€æˆ–å®Œæˆæ€çš„ Promise ä½¿ç”¨ Promise.resolve() æ²¡é—®é¢˜ï¼Œä¼šè¿”å›åŸ<br>Promise ï¼›å¯¹æ‹’ç»æ€çš„ Promise ä½¿ç”¨ Promise.reject() ä¹Ÿæ²¡é—®é¢˜ã€‚è€Œé™¤æ­¤ä¹‹å¤–çš„æƒ…å†µå…¨<br>éƒ½ä¼šåœ¨åŸ Promise ä¸ŠåŒ…è£…å‡ºä¸€ä¸ªæ–°çš„ Promise ã€‚</li>
</ol>
<p>éPromiseçš„Thenable<br>Promise.resolve()ä¸Promise.reject()éƒ½èƒ½æ¥å—éPromiseçš„thenableä½œä¸ºå‚æ•°ã€‚å½“ä¼ å…¥äº†éPromiseçš„thenableæ—¶ï¼Œè¿™äº›æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Promiseï¼Œæ­¤Promiseä¼šåœ¨thenå‡½æ•°ä¹‹åè¢«è°ƒç”¨ã€‚<br>å½“ä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªèƒ½æ¥å—resolveä¸rejectå‚æ•°çš„then()æ–¹æ³•ï¼Œè¯¥å¯¹è±¡å°±ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªéPromiseçš„thenableï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> thenable = &#123;</span><br><span class="line">    then: <span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        resolve(<span class="number">42</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">Promise</span>.resolve(thenable);</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value); <span class="comment">// 42</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="æ‰§è¡Œå™¨é”™è¯¯"><a href="#æ‰§è¡Œå™¨é”™è¯¯" class="headerlink" title="æ‰§è¡Œå™¨é”™è¯¯"></a>æ‰§è¡Œå™¨é”™è¯¯</h4><p>å¦‚æœåœ¨æ‰§è¡Œå™¨å†…éƒ¨æŠ›å‡ºäº†é”™è¯¯ï¼Œé‚£ä¹ˆPromiseçš„æ‹’ç»å¤„ç†å‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'explosion!'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error.message)       <span class="comment">//'explosion'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰ä»·äº</span></span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Explosion!"</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ex) &#123;</span><br><span class="line">        reject(ex)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error.message); <span class="comment">// "Explosion!"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œå™¨å¤„ç†ç¨‹åºæ•æ‰äº†æŠ›å‡ºçš„ä»»ä½•é”™è¯¯ï¼Œä»¥ç®€åŒ–è¿™ç§å¸¸è§å¤„ç†ã€‚ä½†åœ¨æ‰§è¡Œå™¨å†…æŠ›å‡ºçš„é”™è¯¯ä»…<br>å½“å­˜åœ¨æ‹’ç»å¤„ç†å‡½æ•°æ—¶æ‰ä¼šè¢«æŠ¥å‘Šï¼Œå¦åˆ™è¿™ä¸ªé”™è¯¯å°±ä¼šè¢«éšç’ã€‚è¿™åœ¨å¼€å‘è€…æ—©æœŸä½¿ç”¨<br>Promise çš„æ—¶å€™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä½† JS ç¯å¢ƒé€šè¿‡æä¾›é’©å­ï¼ˆ hook ï¼‰æ¥æ•æ‰è¢«æ‹’ç»çš„ Promise ï¼Œ<br>ä»è€Œè§£å†³äº†æ­¤é—®é¢˜ã€‚</p>
<h3 id="å…¨å±€çš„Promiseæ‹’ç»å¤„ç†"><a href="#å…¨å±€çš„Promiseæ‹’ç»å¤„ç†" class="headerlink" title="å…¨å±€çš„Promiseæ‹’ç»å¤„ç†"></a>å…¨å±€çš„Promiseæ‹’ç»å¤„ç†</h3><p>Promiseæœ€æœ‰äº‰è®®çš„æ–¹é¢ä¹‹ä¸€å°±æ˜¯ï¼šå½“ä¸€ä¸ªPromiseè¢«æ‹’ç»æ—¶è‹¥ç¼ºå°‘æ‹’ç»å¤„ç†å‡½æ•°ï¼Œå°±ä¼šé™é»˜å¤±è´¥ã€‚æœ‰äººè®¤ä¸ºè¿™æ˜¯è§„èŒƒä¸­æœ€å¤§çš„ç¼ºé™·ï¼Œå› ä¸ºè¿™æ˜¯JSè¯­è¨€å·¦å³ç»„æˆéƒ¨åˆ†ä¸­å”¯ä¸€ä¸è®©é”™è¯¯æ¸…æ™°å¯è§çš„ã€‚<br>ç”±äºPromiseçš„æœ¬è´¨ï¼Œåˆ¤æ–­ä¸€ä¸ªPromiseçš„æ‹’ç»æ˜¯å¦å·²è¢«å¤„ç†å¹¶ä¸ç›´è§‚ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> reject = <span class="built_in">Promise</span>.reject(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æ­¤åˆ»rejectedä¸ä¼šè¢«å¤„ç†</span></span><br><span class="line"><span class="comment">// ä¸€æ®µæ—¶é—´å</span></span><br><span class="line">reject.catch(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ— è®ºPromiseæ˜¯å¦å·²è¢«è§£å†³ï¼Œéƒ½å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è°ƒç”¨then()æˆ–catch()å¹¶ä½¿å®ƒä»¬æ­£ç¡®å·¥ä½œï¼Œè¿™å¯¼è‡´å¾ˆéš¾å‡†ç¡®çŸ¥é“ä¸€ä¸ªPromiseåˆé€‚ä¼šè¢«å¤„ç†ã€‚æ­¤ä¾‹ä¸­çš„Promiseè¢«ç«‹åˆ»æ‹’ç»ï¼Œä½†å®ƒåæ¥æ‰è¢«å¤„ç†ã€‚<br>è™½ç„¶ä¸‹ä¸ªç‰ˆæœ¬çš„ ES å¯èƒ½ä¼šå¤„ç†æ­¤é—®é¢˜ï¼Œä¸è¿‡æµè§ˆå™¨ä¸ Node.js å·²ç»å®æ–½äº†å˜æ›´æ¥è§£å†³å¼€å‘è€…<br>çš„è¿™ä¸ªç—›ç‚¹ã€‚è¿™äº›å˜æ›´ä¸æ˜¯ ES6 è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œä½†å´æ˜¯ä½¿ç”¨ Promise æ—¶çš„å®è´µå·¥å…·ã€‚</p>
<h3 id="Node-jsçš„æ‹’ç»å¤„ç†"><a href="#Node-jsçš„æ‹’ç»å¤„ç†" class="headerlink" title="Node.jsçš„æ‹’ç»å¤„ç†"></a>Node.jsçš„æ‹’ç»å¤„ç†</h3><p>åœ¨Node.jsä¸­ï¼Œprocesså¯¹è±¡ä¸Šå­˜åœ¨ä¸¤ä¸ªå…³è”åˆ°Promiseçš„æ‹’ç»å¤„ç†äº‹ä»¶ï¼š<br>unhandledRejectionï¼šå½“ä¸€ä¸ªPromiseè¢«æ‹’ç»ï¼Œè€Œåœ¨äº‹ä»¶å¾ªç¯çš„ä¸€ä¸ªè½®æ¬¡ä¸­æ²¡æœ‰ä»»ä½•æ‹’ç»å¤„ç†å‡½æ•°è¢«è°ƒç”¨ï¼Œæ”¹æ—¶é—´å°±ä¼šè¢«è§¦å‘ï¼›<br>rejectionHandledï¼šè‹¥ä¸€ä¸ªPromiseè¢«æ‹’ç»ã€å¹¶åœ¨æ—¶é—´å¾ªç¯çš„ä¸€ä¸ªè½®æ¬¡ä¹‹åå†æœ‰æ‹’ç»å¤„ç†å‡½æ•°è¢«è°ƒç”¨ï¼Œè¯¥äº‹ä»¶å°±ä¼šè¢«è§¦å‘ã€‚<br>è¿™ä¸¤ä¸ªäº‹ä»¶æ—¨åœ¨å…±åŒå¸®åŠ©è¯†åˆ«å·²è¢«æ‹’ç»ä½†æœªæ›¾å¤„ç†promiseã€‚<br>unhandledRejection äº‹ä»¶å¤„ç†å‡½æ•°æ¥å—çš„å‚æ•°æ˜¯æ‹’ç»åŸå› ï¼ˆå¸¸å¸¸æ˜¯ä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼‰ä»¥åŠå·²è¢«<br>æ‹’ç»çš„ Promise ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºäº† unhandledRejection çš„åº”ç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> rejected</span><br><span class="line">process.on(<span class="string">"unhandledRejection"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">reason, promise</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(reason.message); <span class="comment">// "Explosion!"</span></span><br><span class="line">    <span class="built_in">console</span>.log(rejected === promise); <span class="comment">// true</span></span><br><span class="line">&#125;)</span><br><span class="line">rejected = <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Explosion!"</span>))</span><br></pre></td></tr></table></figure>

<p>æ­¤ä¾‹åˆ›å»ºäº†ä¸€ä¸ªå¸¦æœ‰é”™è¯¯å¯¹è±¡çš„å·²è¢«æ‹’ç»çš„ Promise ï¼Œå¹¶ç›‘å¬äº† unhandledRejection äº‹ä»¶ã€‚äº‹ä»¶å¤„ç†å‡½æ•°æ¥æ”¶äº†è¯¥é”™è¯¯å¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ŒåŸ Promise åˆ™æ˜¯ç¬¬äºŒä¸ªå‚æ•°ã€‚rejectionHandled äº‹ä»¶å¤„ç†å‡½æ•°åˆ™åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå³å·²è¢«æ‹’ç»çš„ Promise ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> rejected</span><br><span class="line">process.on(<span class="string">"rejectionHandled"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">promise</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(rejected === promise) <span class="comment">// true</span></span><br><span class="line">&#125;)</span><br><span class="line">rejected = <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Explosion!"</span>))</span><br><span class="line"><span class="comment">// å»¶è¿Ÿæ·»åŠ æ‹’ç»å¤„ç†å‡½æ•°</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    rejected.catch(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value.message); <span class="comment">// "Explosion!"</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„çš„ rejectionHandled äº‹ä»¶åœ¨æ‹’ç»å¤„ç†å‡½æ•°æœ€ç»ˆè¢«è°ƒç”¨æ—¶è§¦å‘ã€‚è‹¥åœ¨ rejected è¢«åˆ›å»ºåç›´æ¥å°†æ‹’ç»å¤„ç†å‡½æ•°é™„åŠ åˆ°å®ƒä¸Šé¢ï¼Œé‚£ä¹ˆæ­¤äº‹ä»¶å°±ä¸ä¼šè¢«è§¦å‘ã€‚å› ä¸ºç«‹å³é™„åŠ çš„æ‹’ç»å¤„ç†å‡½æ•°åœ¨ rejected è¢«åˆ›å»ºçš„äº‹ä»¶å¾ªç¯çš„åŒä¸€ä¸ªè½®æ¬¡å†…å°±ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ · rejectionHandled å°±ä¸ä¼šèµ·ä½œç”¨ã€‚ä¸ºäº†æ­£ç¡®è¿½è¸ªæ½œåœ¨çš„æœªè¢«å¤„ç†çš„æ‹’ç»ï¼Œä½¿ç”¨ rejectionHandled ä¸ unhandledRejection äº‹ä»¶å°±èƒ½ä¿æŒåŒ…å«è¿™äº› Promise çš„ä¸€ä¸ªåˆ—è¡¨ï¼Œä¹‹åç­‰å¾…ä¸€æ®µæ—¶é—´å†æ£€æŸ¥æ­¤åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> possiblyUnhandledRejections = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="comment">// å½“ä¸€ä¸ªæ‹’ç»æœªè¢«å¤„ç†ï¼Œå°†å…¶æ·»åŠ åˆ° map</span></span><br><span class="line">process.on(<span class="string">"unhandledRejection"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">reason, promise</span>) </span>&#123;</span><br><span class="line">    possiblyUnhandledRejections.set(promise, reason)</span><br><span class="line">&#125;)</span><br><span class="line">process.on(<span class="string">"rejectionHandled"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">promise</span>) </span>&#123;</span><br><span class="line">    possiblyUnhandledRejections.delete(promise)</span><br><span class="line">&#125;)</span><br><span class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    possiblyUnhandledRejections.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">reason, promise</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reason.message ? reason.message : reason)</span><br><span class="line">        <span class="comment">// åšç‚¹äº‹æ¥å¤„ç†è¿™äº›æ‹’ç»</span></span><br><span class="line">        handleRejection(promise, reason)</span><br><span class="line">    &#125;)</span><br><span class="line">    possiblyUnhandledRejections.clear()</span><br><span class="line">&#125;, <span class="number">60000</span>)</span><br></pre></td></tr></table></figure>
<p>å¯¹äºæœªå¤„ç†çš„æ‹’ç»ï¼Œè¿™åªæ˜¯ä¸ªç®€å•è¿½è¸ªå™¨ã€‚å®ƒä½¿ç”¨äº†ä¸€ä¸ª Map æ¥å‚¨å­˜ Promise åŠå…¶æ‹’ç»åŸå› ï¼Œæ¯ä¸ª Promise éƒ½æ˜¯é”®ï¼Œè€Œå®ƒçš„æ‹’ç»åŸå› å°±æ˜¯ç›¸å…³çš„å€¼ã€‚æ¯å½“ unhandledRejection è¢«è§¦å‘ï¼Œ Promise åŠå…¶æ‹’ç»åŸå› å°±ä¼šè¢«æ·»åŠ åˆ°æ­¤ Map ä¸­ã€‚è€Œæ¯å½“ rejectionHandled è¢«è§¦å‘ï¼Œå·²è¢«å¤„ç†çš„ Promise å°±ä¼šä»è¿™ä¸ª Map ä¸­è¢«ç§»é™¤ã€‚è¿™æ ·ä¸€æ¥ï¼Œ possiblyUnhandledRejections å°±ä¼šéšç€äº‹ä»¶çš„è°ƒç”¨è€Œæ‰©å±•æˆ–æ”¶ç¼©ã€‚ setInterval() çš„è°ƒç”¨ä¼šå®šæœŸæ£€æŸ¥è¿™ä¸ªåˆ—è¡¨ï¼ŒæŸ¥çœ‹å¯èƒ½æœªè¢«å¤„ç†çš„æ‹’ç»ï¼Œå¹¶å°†å…¶ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆåœ¨ç°å®æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šæƒ³åšç‚¹åˆ«çš„äº‹æƒ…ï¼Œä»¥ä¾¿è®°å½•æˆ–å¤„ç†è¯¥æ‹’ç»ï¼‰ã€‚æ­¤ä¾‹ä½¿ç”¨äº†ä¸€ä¸ª Map è€Œä¸æ˜¯ Weak Map ï¼Œè¿™æ˜¯å› ä¸ºä½ éœ€è¦å®šæœŸæ£€æŸ¥æ­¤Map æ¥æŸ¥çœ‹å“ªäº› Promise å­˜åœ¨ï¼Œè€Œè¿™æ˜¯ä½¿ç”¨ Weak Map æ‰€æ— æ³•åšåˆ°çš„ã€‚å°½ç®¡æ­¤ä¾‹ä»…é’ˆå¯¹ Node.js ï¼Œä½†æµè§ˆå™¨ä¹Ÿå®ç°äº†ç±»ä¼¼çš„æœºåˆ¶æ¥å°†æœªå¤„ç†çš„æ‹’ç»é€šçŸ¥ç»™å¼€å‘è€…ã€‚</p>
<h3 id="æµè§ˆå™¨çš„æ‹’ç»å¤„ç†"><a href="#æµè§ˆå™¨çš„æ‹’ç»å¤„ç†" class="headerlink" title="æµè§ˆå™¨çš„æ‹’ç»å¤„ç†"></a>æµè§ˆå™¨çš„æ‹’ç»å¤„ç†</h3><p>æµè§ˆå™¨åŒæ ·èƒ½è§¦å‘ä¸¤ä¸ªäº‹ä»¶ï¼Œæ¥å¸®åŠ©è¯†åˆ«æœªå¤„ç†çš„æ‹’ç»ã€‚è¿™ä¸¤ä¸ªäº‹ä»¶ä¼šè¢« window å¯¹è±¡è§¦å‘ï¼Œå¹¶å®Œå…¨ç­‰æ•ˆäº Node.js çš„ç›¸å…³äº‹ä»¶ï¼š<br>unhandledrejection ï¼šå½“ä¸€ä¸ª Promise è¢«æ‹’ç»ã€è€Œåœ¨äº‹ä»¶å¾ªç¯çš„ä¸€ä¸ªè½®æ¬¡ä¸­æ²¡æœ‰ä»»ä½•æ‹’ç»å¤„ç†å‡½æ•°è¢«è°ƒç”¨ï¼Œè¯¥äº‹ä»¶å°±ä¼šè¢«è§¦å‘ï¼›<br>rejectionHandled ï¼šè‹¥ä¸€ä¸ª Promise è¢«æ‹’ç»ã€å¹¶åœ¨äº‹ä»¶å¾ªç¯çš„ä¸€ä¸ªè½®æ¬¡ä¹‹åå†æœ‰æ‹’ç»å¤„ç†å‡½æ•°è¢«è°ƒç”¨ï¼Œè¯¥äº‹ä»¶å°±ä¼šè¢«è§¦å‘ã€‚<br>Node.js çš„å®ç°ä¼šä¼ é€’åˆ†ç¦»çš„å‚æ•°ç»™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè€Œæµè§ˆå™¨äº‹ä»¶çš„å¤„ç†å‡½æ•°åˆ™åªä¼šæ¥æ”¶åˆ°åŒ…å«ä¸‹åˆ—å±æ€§çš„ä¸€ä¸ªå¯¹è±¡ï¼š<br>type ï¼š äº‹ä»¶çš„åç§°ï¼ˆ â€œunhandledrejectionâ€ æˆ– â€œrejectionhandledâ€ ï¼‰ï¼›<br>promise ï¼šè¢«æ‹’ç»çš„ Promise å¯¹è±¡ï¼›<br>reason ï¼š Promise ä¸­çš„æ‹’ç»å€¼ï¼ˆæ‹’ç»åŸå› ï¼‰ã€‚<br>æµè§ˆå™¨çš„å®ç°ä¸­å­˜åœ¨çš„å¦ä¸€ä¸ªå·®å¼‚å°±æ˜¯ï¼šæ‹’ç»å€¼ï¼ˆ reason ï¼‰åœ¨ä¸¤ç§äº‹ä»¶ä¸­éƒ½å¯ç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> rejected</span><br><span class="line"><span class="built_in">window</span>.onunhandledrejection = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.type) <span class="comment">// "unhandledrejection"</span></span><br><span class="line">    <span class="built_in">console</span>.log(event.reason.message) <span class="comment">// "Explosion!"</span></span><br><span class="line">    <span class="built_in">console</span>.log(rejected === event.promise) <span class="comment">// true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onrejectionhandled = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.type) <span class="comment">// "rejectionhandled"</span></span><br><span class="line">    <span class="built_in">console</span>.log(event.reason.message) <span class="comment">// "Explosion!"</span></span><br><span class="line">    <span class="built_in">console</span>.log(rejected === event.promise) <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>rejected = Promise.reject(new Error(â€œExplosion!â€));<br>æ­¤ä»£ç ä½¿ç”¨äº† DOM 0 çº§å†™æ³•çš„ onunhandledrejection ä¸ onrejectionhandled ï¼Œå¯¹ä¸¤ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°éƒ½è¿›è¡Œäº†èµ‹å€¼ï¼ˆè‹¥ä½ å–œæ¬¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ addEventListener(â€œunhandledrejectionâ€) ä¸addEventListener(â€œrejectionhandledâ€) ï¼‰ã€‚æ¯ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°éƒ½æ¥æ”¶ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸è¢«æ‹’ç»çš„ Promise æœ‰å…³çš„ä¿¡æ¯ï¼Œ type ã€ promise ä¸ reason å±æ€§éƒ½å¯ç”¨ã€‚ä»¥ä¸‹ä»£ç åœ¨æµè§ˆå™¨ä¸­è¿½è¸ªæœªè¢«å¤„ç†çš„æ‹’ç»ï¼Œä¸ Node.js çš„ä»£ç éå¸¸ç›¸ä¼¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> possiblyUnhandledRejections = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line"><span class="comment">// å½“ä¸€ä¸ªæ‹’ç»æœªè¢«å¤„ç†ï¼Œå°†å…¶æ·»åŠ åˆ° map</span></span><br><span class="line"><span class="built_in">window</span>.onunhandledrejection = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    possiblyUnhandledRejections.set(event.promise, event.reason);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onrejectionhandled = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    possiblyUnhandledRejections.delete(event.promise)</span><br><span class="line">&#125;</span><br><span class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    possiblyUnhandledRejections.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">reason, promise</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reason.message ? reason.message : reason)</span><br><span class="line">        <span class="comment">// åšç‚¹äº‹æ¥å¤„ç†è¿™äº›æ‹’ç»</span></span><br><span class="line">        handleRejection(promise, reason)</span><br><span class="line">    &#125;)</span><br><span class="line">    possiblyUnhandledRejections.clear()</span><br><span class="line">&#125;, <span class="number">60000</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå®ç°ä¸ Node.js çš„å®ç°å‡ ä¹ä¸€æ¨¡ä¸€æ ·ã€‚ä½¿ç”¨äº†ç›¸åŒæ–¹æ³•åœ¨ Map ä¸­å­˜å‚¨ Promise åŠå…¶æ‹’ç»å€¼ï¼Œå¹¶åœ¨æ­¤åè¿›è¡Œæ£€æŸ¥ã€‚å”¯ä¸€çœŸæ­£çš„åŒºåˆ«å°±æ˜¯åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ä¿¡æ¯æ˜¯ä»ä½•å¤„è¢«æå–å‡ºæ¥<br>çš„ã€‚<br>å¤„ç† Promise çš„æ‹’ç»å¯èƒ½å¾ˆéº»çƒ¦ï¼Œä½†ä½ æ‰åˆšå¼€å§‹è§è¯† Promise å®é™…ä¸Šåˆ°åº•æœ‰å¤šå¼ºå¤§ã€‚ç°åœ¨æ˜¯æ—¶å€™æ›´è¿›ä¸€æ­¥äº†â€”â€”æŠŠå‡ ä¸ª promises ä¸²è”åœ¨ä¸€èµ·ä½¿ç”¨ã€‚</p>
<h3 id="ä¸²è”Promise"><a href="#ä¸²è”Promise" class="headerlink" title="ä¸²è”Promise"></a>ä¸²è”Promise</h3><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œ Promise è²Œä¼¼ä¸è¿‡æ˜¯ä¸ªå¯¹ç»„åˆä½¿ç”¨å›è°ƒå‡½æ•°ä¸ setTimeout() å‡½æ•°çš„å¢é‡æ”¹è¿›ï¼Œ<br>ç„¶è€Œ Promise çš„å†…å®¹è¿œæ¯”è¡¨é¢ä¸Šæ‰€çœ‹åˆ°çš„æ›´å¤šã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå­˜åœ¨å¤šç§æ–¹å¼æ¥å°† Promise ä¸²<br>è”åœ¨ä¸€èµ·ï¼Œä»¥å®Œæˆæ›´å¤æ‚çš„å¼‚æ­¥è¡Œä¸ºã€‚<br><strong>æ¯æ¬¡å¯¹ then() æˆ– catch() çš„è°ƒç”¨å®é™…ä¸Šåˆ›å»ºå¹¶è¿”å›äº†å¦ä¸€ä¸ª Promise ï¼Œä»…å½“å‰ä¸€ä¸ªPromise è¢«å®Œæˆæˆ–æ‹’ç»æ—¶ï¼Œåä¸€ä¸ª Promise æ‰ä¼šè¢«å†³è®®ã€‚ç ”ç©¶ä»¥ä¸‹ä¾‹å­ï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'finished'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤ä»£ç è¾“å‡ºï¼š<br>42<br>finished<br>å¯¹ p1.then() çš„è°ƒç”¨è¿”å›äº†ç¬¬äºŒä¸ª Promise ï¼Œåˆåœ¨è¿™ä¹‹ä¸Šè°ƒç”¨äº† then() ã€‚ä»…å½“ç¬¬ä¸€ä¸ªPromise å·²è¢«å†³è®®åï¼Œç¬¬äºŒä¸ª then() çš„å®Œæˆå¤„ç†å‡½æ•°æ‰ä¼šè¢«è°ƒç”¨ã€‚å‡è‹¥ä½ åœ¨æ­¤ä¾‹ä¸­ä¸ä½¿ç”¨<br>ä¸²è”ï¼Œå®ƒçœ‹èµ·æ¥å°±ä¼šæ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p2 = p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;)</span><br><span class="line">p2.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Finished"</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªæ— ä¸²è”ç‰ˆæœ¬çš„ä»£ç ä¸­ï¼Œ p1.then() çš„ç»“æœè¢«å­˜å‚¨åœ¨ p2 ä¸­ï¼Œå¹¶ä¸”éšå p2.then() è¢«è°ƒç”¨ï¼Œä»¥æ·»åŠ æœ€ç»ˆçš„å®Œæˆå¤„ç†å‡½æ•°ã€‚æ­£å¦‚ä½ å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œå¯¹äº p2.then() çš„è°ƒç”¨ä¹Ÿè¿”å›äº†ä¸€ä¸ª Promise ï¼Œæœ¬ä¾‹åªæ˜¯æœªä½¿ç”¨æ­¤ Promise ã€‚</p>
<h4 id="æ•è·é”™è¯¯"><a href="#æ•è·é”™è¯¯" class="headerlink" title="æ•è·é”™è¯¯"></a>æ•è·é”™è¯¯</h4><p>Promiseé“¾å…è®¸æ•è·å‰ä¸€ä¸ªPromiseçš„å®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°ä¸­å‘ç”Ÿçš„é”™è¯¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'boom'</span> + value)</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error.message)  <span class="comment">//boom42</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤ä»£ç ä¸­ï¼Œp1çš„å®Œæˆå¤„ç†å‡½æ•°æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼Œé“¾å¼è°ƒç”¨æŒ‡å‘äº†ç¬¬äºŒä¸ªPromiseä¸Šçš„catch()æ–¹æ³•ï¼Œèƒ½é€šè¿‡æ­¤æ‹’ç»å¤„ç†å‡½æ•°æ¥å—å‰é¢çš„é”™è¯¯ã€‚è‹¥æ˜¯ä¸€ä¸ªæ‹’ç»å¤„ç†å‡½æ•°æŠ›å‡ºäº†é”™è¯¯ï¼Œæƒ…å†µä¹Ÿä¸€æ ·</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> newError(<span class="string">'Explosion'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">p1.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error.message)  <span class="comment">//Explosion</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'boom'</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    console.log(error.message</span>)   //<span class="title">boom</span></span></span><br><span class="line"><span class="function">))</span></span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„çš„æ‰§è¡Œå™¨æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼Œå°±è§¦å‘äº† p1 è¿™ä¸ª Promise çš„æ‹’ç»å¤„ç†å‡½æ•°ï¼Œè¯¥å¤„ç†å‡½æ•°éšåæŠ›å‡ºäº†å¦ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶è¢«ç¬¬äºŒä¸ª Promise çš„æ‹’ç»å¤„ç†å‡½æ•°æ‰€æ•è·ã€‚é“¾å¼ Promise è°ƒç”¨èƒ½å¯Ÿè§‰åˆ°é“¾ä¸­å…¶ä»– Promise ä¸­çš„é”™è¯¯ã€‚<br>ä¸ºäº†ç¡®ä¿èƒ½æ­£ç¡®å¤„ç†ä»»æ„å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ï¼Œåº”å½“å§‹ç»ˆåœ¨ Promise é“¾å°¾éƒ¨æ·»åŠ æ‹’ç»å¤„ç†å‡½æ•°ã€‚</p>
<h4 id="åœ¨Promiseé“¾ä¸­è¿”å›å€¼"><a href="#åœ¨Promiseé“¾ä¸­è¿”å›å€¼" class="headerlink" title="åœ¨Promiseé“¾ä¸­è¿”å›å€¼"></a>åœ¨Promiseé“¾ä¸­è¿”å›å€¼</h4><p>Promiseé“¾çš„å¦ä¸€ç§è¯æ–¹é¢æ˜¯èƒ½ä»ä¸€ä¸ªPromiseä¼ é€’æ•°æ®ç»™ä¸‹ä¸€ä¸ªPromiseçš„èƒ½åŠ›ã€‚ä¼ é€’ç»™æ‰§è¡Œå™¨ä¸­çš„resolve()å¤„ç†å‡½æ•°çš„å‚æ•°ï¼Œä¼šè¢«ä¼ é€’ç»™å¯¹åº”Promiseçš„å®Œæˆå¤„ç†å‡½æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)      <span class="comment">//42</span></span><br><span class="line">    <span class="keyword">return</span> value + <span class="number">1</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)      <span class="comment">//43</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>p1 çš„å®Œæˆå¤„ç†å‡½æ•°åœ¨è¢«æ‰§è¡Œæ—¶è¿”å›äº† value + 1 ã€‚ç”±äº value çš„å€¼ä¸º 42 ï¼ˆæ¥è‡ªæ‰§è¡Œå™¨ï¼‰ï¼Œæ­¤å®Œæˆå¤„ç†å‡½æ•°å°±è¿”å›äº† 43 ã€‚è¿™ä¸ªå€¼éšåè¢«ä¼ é€’ç»™ç¬¬äºŒä¸ª Promise çš„å®Œæˆå¤„ç†å‡½æ•°ï¼Œå¹¶è¢«å…¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚<br>å¯ä»¥å¯¹æ‹’ç»å¤„ç†å‡½æ•°åšç›¸åŒçš„äº‹ã€‚å½“ä¸€ä¸ªæ‹’ç»å¤„ç†å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¹Ÿèƒ½è¿”å›ä¸€ä¸ªå€¼ã€‚å¦‚æœè¿™ä¹ˆåšï¼Œè¯¥å€¼ä¼šè¢«ç”¨äºå®Œæˆä¸‹ä¸€ä¸ª Promiseï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    reject(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line">p1.catch(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value) <span class="comment">// "42"</span></span><br><span class="line">    <span class="keyword">return</span> value + <span class="number">1</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value) <span class="comment">// "43"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„çš„æ‰§è¡Œå™¨ä½¿ç”¨ 42 è°ƒç”¨äº† reject() ï¼Œè¯¥å€¼è¢«ä¼ é€’åˆ°è¿™ä¸ª Promise çš„æ‹’ç»å¤„ç†å‡½æ•°ä¸­ï¼Œä»ä¸­åˆè¿”å›äº† value + 1 ã€‚å°½ç®¡åä¸€ä¸ªè¿”å›å€¼æ˜¯æ¥è‡ªæ‹’ç»å¤„ç†å‡½æ•°ï¼Œå®ƒä»ç„¶è¢«ç”¨äºé“¾ä¸­ä¸‹ä¸€ä¸ªPromise çš„å®Œæˆå¤„ç†å‡½æ•°ã€‚è‹¥æœ‰å¿…è¦ï¼Œä¸€ä¸ª Promise çš„å¤±è´¥å¯ä»¥é€šè¿‡ä¼ é€’è¿”å›å€¼æ¥æ¢å¤æ•´ä¸ªPromise é“¾ã€‚</p>
<h3 id="åœ¨Promiseé“¾ä¸­è¿”å›Promise"><a href="#åœ¨Promiseé“¾ä¸­è¿”å›Promise" class="headerlink" title="åœ¨Promiseé“¾ä¸­è¿”å›Promise"></a>åœ¨Promiseé“¾ä¸­è¿”å›Promise</h3><p>ä»å®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªåŸºæœ¬ç±»å‹å€¼ï¼Œèƒ½å¤Ÿåœ¨Promiseä¹‹é—´ä¼ é€’æ•°æ®ï¼Œä½†è‹¥è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡å‘¢ï¼Ÿè‹¥è¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªPromiseï¼Œé‚£ä¹ˆéœ€è¦é‡‡å–ä¸€ä¸ªé¢å¤–æ­¥éª¤æ¥å†³å®šå¦‚ä½•å¤„ç†ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> Promsise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">43</span>)</span><br><span class="line">&#125;)</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value)   <span class="comment">//42</span></span><br><span class="line">    <span class="keyword">return</span> p2</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value)   <span class="comment">//43</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä»£ç ä¸­ï¼Œ p1 å®‰æ’äº†ä¸€ä¸ªå†³è®® 42 çš„ä½œä¸šï¼Œ p1 çš„å®Œæˆå¤„ç†å‡½æ•°è¿”å›äº†ä¸€ä¸ªå·²å¤„äºå†³è®®æ€çš„ Promise ï¼š p2 ã€‚ç”±äº p2 å·²è¢«å®Œæˆï¼Œç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°å°±è¢«è°ƒç”¨äº†ã€‚è€Œè‹¥ p2 è¢«æ‹’ç»ï¼Œä¼šè°ƒç”¨æ‹’ç»å¤„ç†å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼Œè€Œä¸è°ƒç”¨ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°ã€‚<br>å…³äºæ­¤æ¨¡å¼éœ€è®¤è¯†çš„é¦–è¦é‡ç‚¹æ˜¯ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°å¹¶æœªè¢«æ·»åŠ åˆ° p2 ä¸Šï¼Œè€Œæ˜¯è¢«æ·»åŠ åˆ°ç¬¬ä¸‰ä¸ª Promise ã€‚æ­£å› ä¸ºæ­¤ï¼Œä¸Šä¸ªä¾‹å­å°±ç­‰ä»·äºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">43</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p3 = p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value)   <span class="comment">//42</span></span><br><span class="line">    <span class="keyword">return</span> p2</span><br><span class="line">&#125;)</span><br><span class="line">p3.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value)   <span class="comment">//43</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„æ¸…æ¥šè¯´æ˜äº†ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°è¢«é™„åŠ ç»™ p3 è€Œä¸æ˜¯ p2 ã€‚è¿™æ˜¯ä¸€ä¸ªç»†å¾®ä½†é‡è¦çš„åŒº<br>åˆ«ï¼Œå› ä¸ºè‹¥ p2 è¢«æ‹’ç»ï¼Œåˆ™ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°å°±ä¸ä¼šè¢«è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    reject(<span class="number">43</span>)</span><br><span class="line">&#125;)</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">console</span>.log(value) <span class="comment">// 42</span></span><br><span class="line">    <span class="keyword">return</span> p2</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line"><span class="comment">// ç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value) <span class="comment">// æ°¸ä¸è¢«è°ƒç”¨</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä¾‹ä¸­ï¼Œç”±äº p2 è¢«æ‹’ç»äº†ï¼Œç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°å°±æ°¸ä¸è¢«è°ƒç”¨ã€‚ä¸è¿‡ä½ å¯ä»¥æ”¹ä¸ºå¯¹å…¶é™„åŠ ä¸€ä¸ªæ‹’ç»å¤„ç†å‡½æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    reject(<span class="number">43</span>)</span><br><span class="line">&#125;);</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value) <span class="comment">// 42</span></span><br><span class="line">    <span class="keyword">return</span> p2</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æ‹’ç»å¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="built_in">console</span>.log(value) <span class="comment">// 43</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„ p2 è¢«æ‹’ç»ï¼Œå¯¼è‡´æ‹’ç»å¤„ç†å‡½æ•°è¢«è°ƒç”¨ï¼Œæ¥è‡ª p2 çš„æ‹’ç»å€¼ 43 ä¼šè¢«ä¼ é€’ç»™æ‹’ç»å¤„ç†å‡½æ•°ã€‚ä»å®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°ä¸­è¿”å› thenable ï¼Œä¸ä¼šå¯¹ Promise æ‰§è¡Œå™¨ä½•æ—¶è¢«æ‰§è¡Œæœ‰æ‰€æ”¹å˜ã€‚ç¬¬ä¸€ä¸ªè¢«å®šä¹‰çš„ Promise å°†ä¼šé¦–å…ˆè¿è¡Œå®ƒçš„æ‰§è¡Œå™¨ï¼Œæ¥ä¸‹æ¥æ‰è½®åˆ°ç¬¬äºŒä¸ª Promise çš„æ‰§è¡Œå™¨æ‰§è¡Œï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿”å› thenable åªæ˜¯è®©ä½ èƒ½åœ¨ Promise ç»“æœä¹‹å¤–å®šä¹‰é™„åŠ å“åº”ã€‚ä½ èƒ½é€šè¿‡åœ¨å®Œæˆå¤„ç†å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Promise ï¼Œæ¥æ¨è¿Ÿå®Œæˆå¤„ç†å‡½æ•°çš„æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(value) <span class="comment">// 42</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ promise</span></span><br><span class="line">    <span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        resolve(<span class="number">43</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> p2</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value) <span class="comment">// 43</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä¾‹ä¸­ï¼Œä¸€ä¸ªæ–°çš„ Promise åœ¨ p1 çš„å®Œæˆå¤„ç†å‡½æ•°ä¸­è¢«åˆ›å»ºã€‚è¿™æ„å‘³ç€ç›´åˆ° p2 è¢«å®Œæˆä¹‹åï¼Œç¬¬äºŒä¸ªå®Œæˆå¤„ç†å‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚è‹¥ä½ æƒ³ç­‰å¾…å‰é¢çš„ Promise è¢«è§£å†³ï¼Œä¹‹åæ‰å»è§¦å‘å¦ä¸€ä¸ª Promise ï¼Œé‚£ä¹ˆè¿™ç§æ¨¡å¼å°±éå¸¸æœ‰ç”¨ã€‚</p>
<h3 id="å“åº”å¤šä¸ªPromise"><a href="#å“åº”å¤šä¸ªPromise" class="headerlink" title="å“åº”å¤šä¸ªPromise"></a>å“åº”å¤šä¸ªPromise</h3><p>è‡³ä»Šçš„æ¯ä¸ªä¾‹å­åœ¨åŒä¸€æ—¶åˆ»éƒ½åªå“åº”ä¸€ä¸ª Promise ã€‚ç„¶è€Œæœ‰æ—¶ä¼šæƒ³ç›‘è§†å¤šä¸ª Promiseçš„è¿›ç¨‹ï¼Œä»¥ä¾¿å†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚ ES6 æä¾›äº†èƒ½ç›‘è§†å¤šä¸ª Promise çš„ä¸¤ä¸ªæ–¹æ³•ï¼šPromise.all() ä¸ Promise.race()ã€‚</p>
<h4 id="Promise-all-æ–¹æ³•"><a href="#Promise-all-æ–¹æ³•" class="headerlink" title="Promise.all()æ–¹æ³•"></a>Promise.all()æ–¹æ³•</h4><p>Promise.all()æ–¹æ³•æ¥æ”¶å•ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚æ•°ç»„ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªPromiseã€‚è¿™ä¸ªå¯è¿­ä»£å¯¹è±¡çš„å…ƒç´ éƒ½æ˜¯Promiseï¼Œåªæœ‰åœ¨å®ƒä»¬éƒ½å®Œæˆåï¼Œæ‰€è¿”å›çš„Promiseæ‰ä¼šè¢«å®Œæˆã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">43</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">44</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.all([p1, p2, p3])</span><br><span class="line">p4.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(value))  <span class="comment">//true</span></span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„å‰é¢çš„æ¯ä¸ªPromiseéƒ½ç”¨ä¸€ä¸ªæ•°å€¼è¿›è¡Œäº†å†³è®®ï¼Œå¯¹Promise.all()çš„è°ƒç”¨åˆ›å»ºäº†æ–°çš„Promise p4ï¼Œåœ¨p1ï¼Œp2å’Œp3éƒ½è¢«å®Œæˆåï¼Œp4æœ€ç»ˆä¹Ÿä¼šè¢«å®Œæˆã€‚ä¼ é€’ç»™p4çš„å®Œæˆå¤„ç†å‡½æ•°çš„ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æ¯ä¸ªå†³è®®å€¼ï¼ˆ42ï¼Œ42ï¼Œ43ï¼‰çš„æ•°ç»„ï¼Œè¿™äº›å€¼å¾—å­˜å‚¨é¡ºåºä¿æŒäº†å¾…å†³è®®çš„Promiseçš„é¡ºåºï¼ˆ**ä¸å®Œæˆçš„å…ˆåé¡ºåºæ— å…³ï¼‰ï¼Œå› æ­¤å¯ä»¥å°†ç»“æœåŒ¹é…åˆ°æ¯ä¸ªPromiseã€‚<br>è‹¥ä¼ é€’ç»™Promise.all()çš„ä»»æ„Promiseè¢«æ‹’ç»äº†ï¼Œé‚£ä¹ˆæ–¹æ³•æ‰€è¿”å›çš„Promiseå°±ä¼šç«‹å³è¢«æ‹’ç»ï¼Œè€Œä¸å¿…ç­‰å¾…å…¶ä»–çš„Promiseç»“æŸï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    reject(<span class="number">43</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">44</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.all([p1, p2, p3])</span><br><span class="line">p4.catch(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(value))   <span class="comment">//false</span></span><br><span class="line">    <span class="built_in">console</span>.log(value)                  <span class="comment">//43</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä¾‹ä¸­ï¼Œp2è¢«ä½¿ç”¨æ•°å€¼43è¿›è¡Œäº†æ‹’ç»ï¼Œåˆ™p4çš„æ‹’ç»å¤„ç†å‡½æ•°å°±ç«‹åˆ»è¢«è°ƒç”¨ï¼Œè€Œä¸ä¼šç­‰å¾…p1æˆ–p3ç»“æŸæ‰§è¡Œï¼ˆå®ƒä»¬ä»»ç„¶ä¼šå„è‡ªç»“æŸæ‰§è¡Œï¼Œåªæ˜¯p4ä¸ç­‰å®ƒä»¬ï¼‰ã€‚<br>æ‹’ç»å¤„ç†å‡½æ•°æ€»ä¼šæ¥æ”¶åˆ°å•ä¸ªå€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥å€¼å°±æ˜¯è¢«æ‹’ç»çš„Promiseæ‰€è¿”å›çš„æ‹’ç»å€¼ã€‚æœ¬ä¾‹ä¸­çš„å†³ç»å¤„ç†å‡½æ•°è¢«ä¼ å…¥äº†43ï¼Œåæ˜ äº†æ¥è‡ªp2çš„æ‹’ç»ã€‚</p>
<h4 id="Promise-race-æ–¹æ³•"><a href="#Promise-race-æ–¹æ³•" class="headerlink" title="Promise.race()æ–¹æ³•"></a>Promise.race()æ–¹æ³•</h4><p>Promise.race()æä¾›äº†ç›‘è§†å¤šä¸ªPromiseçš„ä¸€ä¸ªç¨å¾®ä¸åŒçš„æ–¹æ³•ã€‚æ­¤æ–¹æ³•ä¹Ÿæ¥å—ä¸€ä¸ªåŒ…å«éœ€è¦ç›‘è§†çš„Promiseçš„å¯è¿­ä»£å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseï¼Œä½†ä¸€æ—¦æ¥æºPromiseä¸­æœ‰ä¸€ä¸ªè¢«è§£å†³ï¼Œæ‰€è¿”å›çš„Promiseå°±ä¼šç«‹åˆ»è¢«è§£å†³ã€‚ç­‰å¾…æ‰€æœ‰Promiseå®Œæˆçš„Promise.all()æ–¹æ³•ä¸åŒï¼Œæ¥è‡ªæºPromiseä¸­ä»»æ„ä¸€ä¸ªè¢«å®Œæˆæ—¶ï¼ŒPromise.race()æ–¹æ³•æ‰€è¿”å›çš„Promiseå°±èƒ½ä½œå‡ºå“åº”ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="built_in">Promise</span>.resolve(<span class="number">42</span>)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">43</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">44</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.race([p1, p2, p3])</span><br><span class="line">p4.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log()     <span class="comment">//42</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä»£ç ä¸­ï¼Œ p1 è¢«åˆ›å»ºä¸ºä¸€ä¸ªå·²å®Œæˆçš„ Promise ï¼Œè€Œå…¶ä»–çš„ Promise åˆ™éœ€è¦è°ƒåº¦ä½œä¸šã€‚p4 çš„å®Œæˆå¤„ç†å‡½æ•°è¢«ä½¿ç”¨æ•°å€¼ 42 è¿›è¡Œäº†è°ƒç”¨ï¼Œå¹¶å¿½ç•¥äº†å…¶ä»–çš„ Promise ã€‚ä¼ é€’ç»™Promise.race() çš„ Promise ç¡®å®åœ¨è¿›è¡Œèµ›è·‘ï¼Œçœ‹å“ªä¸€ä¸ªé¦–å…ˆè¢«è§£å†³ã€‚è‹¥èƒœå‡ºçš„ Promise æ˜¯è¢«å®Œæˆï¼Œåˆ™è¿”å›çš„æ–° Promise ä¹Ÿä¼šè¢«å®Œæˆï¼›è€Œèƒœå‡ºçš„ Promise è‹¥æ˜¯è¢«æ‹’ç»ï¼Œåˆ™æ–° Promise ä¹Ÿä¼šè¢«æ‹’ç»ã€‚æ­¤å¤„æœ‰ä¸ªä½¿ç”¨æ‹’ç»çš„èŒƒä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="built_in">Promise</span>.reject(<span class="number">43</span>)</span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">44</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> p4 = <span class="built_in">Promise</span>.race([p1, p2, p3])</span><br><span class="line">p4.catch(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value); <span class="comment">// 43</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„çš„ p4 è¢«æ‹’ç»äº†ï¼Œå› ä¸º p2 åœ¨ Promise.race() è¢«è°ƒç”¨æ—¶å·²ç»å¤„äºæ‹’ç»æ€ã€‚å°½ç®¡ p1 ä¸p3 éƒ½è¢«å®Œæˆï¼Œå…¶ç»“æœä»ç„¶è¢«å¿½ç•¥ï¼Œå› ä¸ºè¿™å‘ç”Ÿåœ¨ p2 è¢«æ‹’ç»ä¹‹åã€‚</p>
<h3 id="ç»§æ‰¿Promise"><a href="#ç»§æ‰¿Promise" class="headerlink" title="ç»§æ‰¿Promise"></a>ç»§æ‰¿Promise</h3><p>æ­£åƒå…¶ä»–å†…ç½®ç±»å‹ï¼Œå¯å°†ä¸€ä¸ªPromiseç”¨ä½œæ´¾ç”Ÿç±»çš„åŸºç±»ã€‚è¿™å…è®¸ä½ è‡ªå®šä¹‰å˜å¼‚çš„Promiseï¼Œåœ¨å†…ç½®Promiseçš„åŸºç¡€ä¸Šæ‰©å±•åŠŸèƒ½ï¼Œä¾‹å¦‚å‡è®¾æƒ³åˆ›å»ºä¸€ä¸ªå¯ä»¥ä½¿ç”¨succss()å’Œfailure()æ–¹æ³•çš„Promiseï¼Œå¯¹å¸¸è§„çš„then()å’Œcatch()æ–¹æ³•è¿›è¡Œæ‰©å±•ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·åˆ›å»ºè¯¥Promiseç±»å‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPromise</span> <span class="keyword">extends</span> <span class="title">Promise</span> </span>&#123;</span><br><span class="line">    success(resolve, reject) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.then(resolve, reject)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    failure(reject) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.catch(reject)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.success(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;).failure(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä¾‹ä¸­ï¼Œ MyPromise ä» Promise ä¸Šæ´¾ç”Ÿå‡ºæ¥ï¼Œå¹¶æ‹¥æœ‰ä¸¤ä¸ªé™„åŠ æ–¹æ³•ã€‚ success() æ–¹æ³•æ¨¡æ‹Ÿäº† resolve() ï¼Œ failure() æ–¹æ³•åˆ™æ¨¡æ‹Ÿäº† reject() ã€‚<br>æ¯ä¸ªé™„åŠ æ–¹æ³•éƒ½ä½¿ç”¨äº† this æ¥è°ƒç”¨å®ƒæ‰€æ¨¡æ‹Ÿçš„æ–¹æ³•ã€‚æ´¾ç”Ÿçš„ Promise å‡½æ•°ä¸å†…ç½®çš„Promise å‡ ä¹ä¸€æ ·ï¼Œé™¤äº†å¯ä»¥éšä½ éœ€è¦è°ƒç”¨ success() ä¸ failure() ã€‚<br>ç”±äºé™æ€æ–¹æ³•è¢«ç»§æ‰¿äº†ï¼Œ MyPromise.resolve() æ–¹æ³•ã€ MyPromise.reject() æ–¹æ³•ã€MyPromise.race() æ–¹æ³•ä¸ MyPromise.all() æ–¹æ³•åœ¨æ´¾ç”Ÿçš„ Promise ä¸Šéƒ½å¯ç”¨ã€‚åä¸¤ä¸ªæ–¹æ³•çš„è¡Œä¸ºç­‰åŒäºå†…ç½®çš„æ–¹æ³•ï¼Œä½†å‰ä¸¤ä¸ªæ–¹æ³•åˆ™æœ‰è½»å¾®çš„ä¸åŒã€‚<br>MyPromise.resolve() ä¸ MyPromise.reject() éƒ½ä¼šè¿”å› MyPromise çš„ä¸€ä¸ªå®ä¾‹ï¼Œæ— è§†ä¼ é€’è¿›æ¥çš„å€¼çš„ç±»å‹ï¼Œè¿™æ˜¯ç”±äºè¿™ä¸¤ä¸ªæ–¹æ³•ä½¿ç”¨äº† Symbol.species å±æ€§ï¼ˆè¯¦è§ç¬¬ä¹ç« ï¼‰æ¥å†³å®šéœ€è¦è¿”å›çš„ Promise çš„ç±»å‹ã€‚è‹¥ä¼ é€’å†…ç½® Promise ç»™è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå°†ä¼šè¢«å†³è®®æˆ–è¢«æ‹’ç»ï¼Œå¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ MyPromise ï¼Œä»¥ä¾¿ç»‘å®šå®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = MyPromise.resolve(p1)</span><br><span class="line">p2.MyPromise.resolve(p1)</span><br><span class="line">p2.success(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)  <span class="comment">//42</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(p2 <span class="keyword">instanceof</span> MyPromise)  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„çš„p1æ˜¯ä¸€ä¸ªå†…ç½®çš„Promiseï¼Œè¢«ä¼ é€’ç»™äº†MyPromise.resolve()æ–¹æ³•ã€‚ä½œä¸ºç»“æœçš„p2æ˜¯MyPromiseçš„ä¸€ä¸ªå®ä¾‹ï¼Œæ¥è‡ªp1çš„å†³è®®å€¼è¢«ä¼ é€’ç»™äº†p2çš„å®Œæˆå¤„ç†å‡½æ•°ã€‚<br>è‹¥MyPromiseçš„ä¸€ä¸ªå®ä¾‹è¢«ä¼ é€’ç»™äº†MyPromise.resolve()æˆ–MyPromise.reject()æ–¹æ³•ï¼Œå®ƒä¼šåœ¨æœªè¢«å†³è®®çš„æƒ…å†µä¸‹å°±è¢«ç›´æ¥è¿”å›ã€‚å…¶ä»–æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•çš„è¡Œä¸ºéƒ½ä¼šç­‰åŒäºPromise.resolve()ä¸Promise.reject()</p>
<h3 id="å¼‚æ­¥ä»»åŠ¡è¿è¡Œ"><a href="#å¼‚æ­¥ä»»åŠ¡è¿è¡Œ" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡è¿è¡Œ"></a>å¼‚æ­¥ä»»åŠ¡è¿è¡Œ</h3><p>å¯ä»¥åƒå¦‚ä¸‹æ–¹æ¡ˆè¿›è¡Œå¼‚æ­¥ä»»åŠ¡è¿è¡Œï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">taskDef</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¿­ä»£å™¨ï¼Œè®©å®ƒåœ¨åˆ«å¤„å¯ç”¨</span></span><br><span class="line">    <span class="keyword">let</span> task = taskDef()</span><br><span class="line">    <span class="comment">// å¼€å§‹ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">let</span> result = task.next()</span><br><span class="line">    <span class="comment">// é€’å½’ä½¿ç”¨å‡½æ•°æ¥ä¿æŒå¯¹next()çš„è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!result.done) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">typeof</span> result.value === <span class="string">'function'</span>) &#123;</span><br><span class="line">                result.value(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                        result = task.throw(err)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    result = task.next(data)</span><br><span class="line">                    step()</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result = task.next(result.value)</span><br><span class="line">                step()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(result)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¼€å§‹å¤„ç†è¿‡ç¨‹</span></span><br><span class="line">    step()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥é…åˆä»»åŠ¡è¿è¡Œå™¨ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">filename</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">        fs.readFile(filename, callback)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">run(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> contents = <span class="keyword">yield</span> readFile(<span class="string">'config.json'</span>)</span><br><span class="line">    doSomethingWith(contents)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'done'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æ­¤å®ç°å­˜åœ¨ä¸€äº›ç—›ç‚¹ã€‚é¦–å…ˆï¼Œå°†æ¯ä¸ªå‡½æ•°åŒ…è£¹åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…ï¼Œå†è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œè¿™æ˜¯æœ‰ç‚¹ä»¤äººå›°æƒ‘çš„ã€‚å…¶æ¬¡ï¼Œè¿”å›å€¼ä¸ºå‡½æ•°çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰ä»»ä½•æ–¹æ³•å¯ä»¥åŒºåˆ†å®ƒæ˜¯å¦åº”å½“è¢«ä½œä¸ºä»»åŠ¡è¿è¡Œå™¨çš„å›è°ƒå‡½æ•°ã€‚<br>å€ŸåŠ©Promiseï¼Œå¯ä»¥ç¡®ä¿æ¯ä¸ªå¼‚æ­¥æ“ä½œéƒ½è¿”å›ä¸€ä¸ªPromiseï¼Œä»è€Œå¤§å¹…åº¦ç®€åŒ–å¹¶ä¸€èˆ¬åŒ–å¼‚æ­¥å¤„ç†ï¼Œé€šè¿‡æ¥å£ä¹Ÿæ„å‘³ç€å¯ä»¥å¤§å¤§å‡å°‘å¼‚æ­¥ä»£ç ã€‚æ­¤å¤„æœ‰ä¸€ä¸ªç®€åŒ–å¼‚æ­¥ä»»åŠ¡è¿è¡Œå™¨çš„æ–¹å¼:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">taskDef</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¿­ä»£å™¨</span></span><br><span class="line">    <span class="keyword">let</span> task = taskDef()</span><br><span class="line">    <span class="comment">// å¯åŠ¨ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">let</span> result = task.next()</span><br><span class="line">    <span class="comment">// é€’å½’ä½¿ç”¨å‡½æ•°æ¥è¿›è¡Œè¿­ä»£</span></span><br><span class="line">    (<span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!result.done) &#123;</span><br><span class="line">            <span class="comment">// å†³è®®ä¸€ä¸ªPromiseï¼Œè®©ä»»åŠ¡å¤„ç†å˜ç®€å•</span></span><br><span class="line">            <span class="keyword">let</span> promise = <span class="built_in">Promise</span>.resolve(result.value)</span><br><span class="line">            promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">                result = task.next(value)</span><br><span class="line">                step()</span><br><span class="line">            &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">                result = task.throw(error)</span><br><span class="line">                step()</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥é…åˆä»»åŠ¡è¿è¡Œå™¨ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">filename</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        fs.readFile(filename, <span class="function"><span class="keyword">function</span>(<span class="params">err, contents</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                resolve(contents)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œä¸€ä¸ªä»»åŠ¡</span></span><br><span class="line">run(<span class="function"><span class="keyword">function</span> *(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> contents = <span class="keyword">yield</span> readFile(<span class="string">'config.json'</span>)</span><br><span class="line">    doSomethingWith(contents)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'done'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ç‰ˆæœ¬çš„ä»£ç ä¸­ï¼Œä¸€ä¸ªé€šç”¨çš„ run() å‡½æ•°æ‰§è¡Œäº†ç”Ÿæˆå™¨æ¥åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ã€‚å®ƒè°ƒç”¨äº†task.next() æ¥å¯åŠ¨ä»»åŠ¡ï¼Œå¹¶é€’å½’è°ƒç”¨ step() ç›´åˆ°è¿­ä»£å®Œæˆã€‚<br>åœ¨ step() å‡½æ•°å†…éƒ¨ï¼Œå¦‚æœè¿˜æœ‰æ›´å¤šå·¥ä½œè¦åšï¼Œé‚£ä¹ˆ result.done çš„å€¼ä¼šæ˜¯ false ï¼Œæ­¤æ—¶result.value åº”å½“æ˜¯ä¸€ä¸ª Promise ï¼Œä¸è¿‡è°ƒç”¨ Promise.resolve() åªä¸ºé¢„é˜²æœªæ­£ç¡®è¿”å›Promise çš„å‡½æ•°ï¼ˆè®°ä½ï¼š Promise.resolve() åœ¨è¢«ä¼ å…¥ä»»æ„ Promise æ—¶åªä¼šç›´æ¥å°†å…¶ä¼ é€’å›æ¥ï¼Œè€Œä¸æ˜¯ Promise çš„å‚æ•°åˆ™ä¼šè¢«åŒ…è£…ä¸º Promise ï¼‰ã€‚æ¥ä¸‹æ¥ï¼Œä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°è¢«æ·»åŠ ä»¥ä¾¿æå–è¯¥ Promise å€¼ï¼Œå¹¶å°†è¯¥å€¼ä¼ å›è¿­ä»£å™¨ã€‚æ­¤åï¼Œåœ¨ step() å‡½æ•°è°ƒç”¨è‡ªèº«ä¹‹å‰ï¼Œresult è¢«èµ‹å€¼ä¸ºä¸‹ä¸€ä¸ª yield çš„ç»“æœã€‚<br>ä¸€ä¸ªæ‹’ç»å¤„ç†å‡½æ•°å°†ä»»æ„æ‹’ç»ç»“æœå­˜å‚¨åœ¨ä¸€ä¸ªé”™è¯¯å¯¹è±¡ä¸­ã€‚ task.throw() æ–¹æ³•å°†è¿™ä¸ªé”™è¯¯å¯¹è±¡ä¼ å›ç»™è¿­ä»£å™¨ï¼Œè€Œè‹¥ä¸€ä¸ªé”™è¯¯åœ¨ä»»åŠ¡ä¸­è¢«æ•è·ï¼Œ result ä¹Ÿä¼šè¢«èµ‹å€¼ä¸ºä¸‹ä¸€ä¸ª yield çš„ç»“æœï¼Œè¿™æ · step() æœ€ç»ˆåœ¨ catch() å†…éƒ¨å°±ä¼šè¢«è°ƒç”¨ï¼Œä»¥ä¾¿ç»§ç»­ä»»åŠ¡æ‰§è¡Œã€‚run() å‡½æ•°èƒ½è¿è¡Œä»»æ„ä½¿ç”¨ yield æ¥å®ç°å¼‚æ­¥ä»£ç çš„ç”Ÿæˆå™¨ï¼Œè€Œä¸ä¼šå°† Promise ï¼ˆæˆ–å›è°ƒå‡½æ•°ï¼‰æš´éœ²ç»™å¼€å‘è€…ã€‚äº‹å®ä¸Šï¼Œç”±äºå‡½æ•°è°ƒç”¨åçš„è¿”å›å€¼æ€»æ˜¯ä¼šè¢«è½¬æ¢ä¸ºä¸€ä¸ª Promise ï¼Œè¯¥å‡½æ•°ç”šè‡³å…è®¸è¿”å› Promise ä¹‹å¤–çš„ç±»å‹ã€‚è¿™æ„å‘³ç€åŒæ­¥ä¸å¼‚æ­¥æ–¹æ³•åœ¨ä½¿ç”¨ yield æ—¶éƒ½ä¼šæ­£å¸¸å·¥ä½œï¼Œå¹¶ä¸”ä½ æ°¸ä¸éœ€è¦æ£€æŸ¥è¿”å›å€¼æ˜¯å¦ä¸ºä¸€ä¸ª Promise ã€‚å”¯ä¸€éœ€è¦æ‹…å¿ƒçš„æ˜¯ï¼Œè¦ç¡®ä¿è¯¸å¦‚ readFile() çš„å¼‚æ­¥æ–¹æ³•èƒ½è¿”å›ä¸€ä¸ªæ­£ç¡®æ ‡è®°å…¶çŠ¶æ€çš„Promise ã€‚å¯¹äº Node.js å†…ç½®çš„æ–¹æ³•æ¥è¯´ï¼Œè¿™æ„å‘³ç€ä½ å¿…é¡»è½¬æ¢è¿™äº›æ–¹æ³•ï¼Œè®©å®ƒä»¬è¿”å›Promise è€Œä¸æ˜¯ä½¿ç”¨å›è°ƒå‡½æ•°ã€‚<br>æœªæ¥çš„å¼‚æ­¥ä»»åŠ¡è¿è¡Œ<br>åœ¨æˆ‘å†™è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œé’ˆå¯¹ JS ä¸­çš„å¼‚æ­¥ä»»åŠ¡è¿è¡Œï¼Œä¸ºä¹‹å¼•å…¥ç®€å•è¯­æ³•çš„ä¸€é¡¹å·¥ä½œæ­£åœ¨è¿›è¡Œã€‚æ­¤å·¥ä½œå¼€å±•åœ¨ await è¯­æ³•ä¸Šï¼Œæåº¦å€Ÿé‰´äº†ä¸Šè¿°ä»¥ Promise ä¸ºåŸºç¡€çš„ä¾‹å­ã€‚å…¶åŸºæœ¬ç†å¿µæ˜¯ä½¿ç”¨ä¸€ä¸ªè¢« async æ ‡è®°çš„å‡½æ•°ï¼ˆè€Œéç”Ÿæˆå™¨ï¼‰ï¼Œå¹¶åœ¨è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°æ—¶ä½¿ç”¨await è€Œé yield ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">let</span> contents = <span class="keyword">await</span> readFile(<span class="string">"config.json"</span>);</span><br><span class="line">doSomethingWith(contents)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Done"</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨ function ä¹‹å‰çš„ async å…³é”®å­—æ ‡æ˜äº†æ­¤å‡½æ•°ä½¿ç”¨å¼‚æ­¥æ–¹å¼è¿è¡Œã€‚ await å…³é”®å­—åˆ™è¡¨ç¤ºå¯¹äº readFile(â€œconfig.jsonâ€) çš„å‡½æ•°è°ƒç”¨åº”è¿”å›ä¸€ä¸ª Promise ï¼Œè‹¥è¿”å›ç±»å‹ä¸å¯¹ï¼Œåˆ™ä¼šå°†å…¶åŒ…è£…ä¸º Promise ã€‚ä¸ä¸Šè¿° run() çš„å®ç°ä¸€è‡´ï¼Œ await ä¼šåœ¨ Promise è¢«æ‹’ç»çš„æƒ…å†µä¸‹æŠ›å‡ºé”™è¯¯ï¼Œå¦åˆ™å®ƒå°†è¿”å›è¯¥ Promise è¢«å†³è®®çš„å€¼ã€‚æœ€ç»ˆç»“æœæ˜¯ä½ å¯ä»¥å°†å¼‚æ­¥ä»£ç å½“ä½œåŒæ­¥ä»£ç æ¥ä¹¦å†™ï¼Œè€Œæ— é¡»ä¸ºç®¡ç†åŸºäºè¿­ä»£å™¨çš„çŠ¶æ€æœºè€Œä»˜å‡ºé¢å¤–å¼€é”€ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/Blog/page/2/">2</a><a class="page-number" href="/Blog/page/3/">3</a><a class="extend next" rel="next" href="/Blog/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">èš‚èš</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/Blog/archives/">
        
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">èš‚èš</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/Blog/lib/anime.min.js"></script>
  <script src="/Blog/lib/velocity/velocity.min.js"></script>
  <script src="/Blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/Blog/js/utils.js"></script>

<script src="/Blog/js/motion.js"></script>


<script src="/Blog/js/schemes/pisces.js"></script>


<script src="/Blog/js/next-boot.js"></script>




  















  

  

</body>
</html>
