---
title: 正则表达式
date: 2020-05-02 20:28:47
tags: 前端
---


## RegExp类型
ECMAScript通过RegExp类型来支持正则表达式。
使用如下语法，就可以创建一个正则表达式。
```js
var expression = /pattern/flags
```
其中的pattern(模式)部分可以是任何简单或复杂的正则表达式，可以包含字符类，限定符，分组，向前查找以及反向引用。每个正则表达式都可以带有一个或多个标签（flags），用以标明正则表达式的行为。正则表达式的匹配模式支持下列三个标志。
g：表示全局模式，即模式将被应用于所有字符串，而非在发现第一个匹配项时立即停止
i：表示不区分大小写模式，即在确定匹配项时忽略模式与字符串的大小写
m：表示多行模式，即在到达一行文本末尾时还会继续查找下一行中是否存在与模式匹配的项。
与其他语言中的正则表达式类似，模式中使用的所有元字符都必须转义。正则表达式中的元字符包括：
( [{\^$|?*+.}])
这些元字符在正则表达式中都有一或多种特殊用途，因此如果想要匹配字符串中包含的这些字符，就必须对他们进行转义

前面举的例子是以字面量形式来定义的正则表达式。另一种创建正则表达式的方式是使用RegExp构造函数，它接收两个参数：一个是要匹配的字符串模式，另一个是可选的标志字符串。
```js
// 字面量表达形式
var pattern = /[bc]at/i
// 使用构造函数形式
var pattern2 = new RegExp('[bc]at', 'i')
```
*由于RegExp构造函数的模式参数是字符串，所以在某些情况下要对字符串进行双重转义。所有元字符都必须双重转义，那些已经转义过的字符也是如此。例如，\n要写成\\n,\\要写成\\\\。*

### RegExp实例属性
RegExp的每个实例都具有如下属性，通过这些属性可以取得有关模式的各种信息。
global：布尔值，表示是否设置了g标志
ignorecase：布尔值，表示是否设置了i标志
lastIndex：整数，表示开始搜索下一个匹配项的字符位置，从0算起
multiline：布尔值，表示是否设置了m标志
source：正则表达式的字符串表示，按照字面量形式而非传入构造函数中的字符串模式返回。

### RegExp实例方法
RegExp对象的主要方法是exec()，该方法是专门为捕获组而设计的。exec()接收一个参数，即要应用模式的字符串，然后返回包含第一个匹配项信息的数组；或者在没有匹配项的情况下返回null。返回的数组虽然是Array的实例，但包含两个额外的属性：index和input。其中，index表示匹配项在字符串中的位置，而input表示应用正则表达式的字符串。在数组中，第一项是与整个模式匹配的字符串，其他项时与模式中的补货组匹配的字符串，其他项时与模式中的捕获组匹配的字符串（如果模式中没有捕获组，则该数组只包含一项。

```js
var text = 'mom and dad and baby'
var pattern = /mom( and dad( and baby)?)?/gi

var matches = pattern.exec(text)
alert(matches.index)      //0
alert(matches.input)     //'mom and dad and baby'
alert(matches[0])        //'mom and dad and baby'
alert(matches[1])        //' and dad and baby
alert(matches[2])        //' and baby'
```
对于exec()方法而言，**即使在模式中设定了全局标志(g)**，它每次也只会返回一个匹配项。在不设置全局标志的情况下，在同一个字符串上多次调用exec()将始终返回第一个匹配项的信息。而在设置全局标志的情况下，每次调用exec()则都会在字符串中继续查找新匹配项。
```js
var text = 'cat, bat, sat, fat'
var pattern1 = /.at/

var matches = pattern1.exec(text)
alert(matches.index)   //0
alert(matches[0])      //cat
alert(pattern1.lastIndex)  //0

matches = pattern1.exec(text)
alert(matches.index)   //0
alert(matches[0])      //cat
alert(pattern1.lastIndex)  //0

var pattern1 = /.at/g
var matches = pattern2.exec(text)
alert(matches.index)   //0
alert(matches[0])      //cat
alert(pattern1.lastIndex)  //0

matches = pattern2.exec(text)
alert(matches.index)   //5
alert(matches[0])      //bat
alert(pattern1.lastIndex)  //8
```

正则表达式的第二个方法是test()，它接受一个字符串参数。在末世与改参数匹配的情况下返回true；否则返回false。